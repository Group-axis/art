{"version":3,"sources":["webpack:///1.c2d024fea936b7873685.chunk.js","webpack:///./~/rxjs/add/operator/reduce.js","webpack:///./~/rxjs/operator/reduce.js","webpack:///./src/app/models/referential/index.ts","webpack:///./src/app/models/referential/option/index.ts","webpack:///./src/app/models/referential/option/option.model.ts","webpack:///./src/app/models/referential/ui.model.ts","webpack:///./src/app/models/routing-amh/assignment-config.model.ts","webpack:///./src/app/models/routing-amh/assignment-list.model.ts","webpack:///./src/app/models/routing-amh/assignment-rule.model.ts","webpack:///./src/app/models/routing-amh/assignment-type.model.ts","webpack:///./src/app/models/routing-amh/assignment-unique-backend.model.ts","webpack:///./src/app/models/routing-amh/assignment-unique-rule.model.ts","webpack:///./src/app/models/routing-amh/assignment-unique.model.ts","webpack:///./src/app/models/routing-amh/assignment.model.ts","webpack:///./src/app/models/routing-amh/backend-pk.model.ts","webpack:///./src/app/models/routing-amh/backend.model.ts","webpack:///./src/app/models/routing-amh/index.ts","webpack:///./src/app/models/routing-amh/rule-assign-type.model.ts","webpack:///./src/app/models/routing-amh/rule.model.ts","webpack:///./src/app/models/routing/action-on.model.ts","webpack:///./src/app/models/routing/action.model.ts","webpack:///./src/app/models/routing/condition-type.model.ts","webpack:///./src/app/models/routing/condition.model.ts","webpack:///./src/app/models/routing/index.ts","webpack:///./src/app/models/routing/new-instance.model.ts","webpack:///./src/app/models/routing/point-list.model.ts","webpack:///./src/app/models/routing/point.model.ts","webpack:///./src/app/models/routing/rule.model.ts","webpack:///./src/app/models/routing/source.model.ts","webpack:///./src/app/saa-routing/index.ts","webpack:///./src/app/saa-routing/saa-export-import/index.ts?1fa0","webpack:///./src/app/saa-routing/saa-points-overview/index.ts?356a","webpack:///./src/app/saa-routing/saa-routing-home/index.ts?d39c","webpack:///./src/app/saa-routing/saa-routing-point/index.ts?2362","webpack:///./src/app/saa-routing/saa-routing-rule/index.ts?9734","webpack:///./src/app/saa-routing/saa-routing.component.ts","webpack:///./src/app/saa-routing/saa-routing.service.ts","webpack:///./src/app/saa-routing/saa-simulator/index.ts?5179"],"names":["webpackJsonp","904","module","exports","__webpack_require__","Observable_1","reduce_1","Observable","prototype","reduce","922","project","seed","this","lift","ReduceOperator","__extends","d","b","__","constructor","p","hasOwnProperty","Object","create","Subscriber_1","call","subscriber","source","_subscribe","ReduceSubscriber","_super","destination","hasValue","acc","hasSeed","_next","value","_tryReduce","result","err","error","_complete","next","complete","Subscriber","888","__export","m","926","1167","Option","id","code","description","selected","defineProperty","get","enumerable","configurable","fromJson","json","data","JSON","parse","mapToProperty","option","1153","updateFields","dest","orig","fields","forEach","f","ItemContainer","children","addChild","child","push","ItemChild","IdCodeDescription","empty","1168","assignment_type_model_ts_1","AssignmentConfig","type","maxBackendsAllowed","calculeMaxBackendsAllowed","AssignType","BK_CHANNEL","DTN_COPY","FEED_DTN_COPY","isTypeDifferent","typeAsString","showExtraFields","1169","AssignmentList","active","backCode","backDirection","backName","backSequence","ruleCode","ruleExpressions","ruleSequence","environment","version","1170","AssignmentRule","dataOwner","lockCode","sequence","expression","886","1130","assignment_type_model_1","AssignmentUniqueBackend","direction","toWriteModel","assignmentCode","modificationUserId","modificationDate","creationUserId","creationDate","1131","AssignmentUniqueRule","1171","assignment_unique_backend_model_1","assignment_unique_rule_model_1","AssignmentUnique","backendPrimaryKey","copies","name","rules","backends","undefined","backendCodeList","map","backend","_this","rule","writeModelObj","String","1172","Assignment","1173","BackendPK","hashPK","pk","toString","hash","1174","Backend","pkCode","pkDirection","880","1175","RuleAssignType","1176","audit_1","AMHRule","ruleType","setEnvAndVersion","cloneWithUpperCaseCode","toUpperCase","BaseAudit","1200","ActionOn","1183","referential_1","source_model_1","new_instance_model_1","Action","actionOn","newInstance","Source","NewInstance","update","that","updateField","instanceType","instanceTypeOption","instanceAction","action","instanceInterventionType","intervention","instanceInterventionTypeText","interventionText","instanceRoutingCode","routingCode","instanceTargetQueue","actionOption","instanceUnit","unit","instancePriority","priority","newInstanceAction","newInstanceRoutingCode","newInstanceInterventionType","newInstanceInterventionTypeText","newInstanceTargetQueue","newInstanceType","newInstanceUnit","newInstancePriority","1201","ConditionType","1184","referential_2","Condition","conditionOn","functions","message","functionsWriteModel","length","cur","criteria","functionList","1185","1186","1202","PointList","pointName","schemas","ruleSeq","ruleDescription","ruleMessage","originalPoint","originalCode","copyPoint","copyCode","1203","Point","full","1204","condition_model_1","action_model_1","Rule","routingPoint","lastModification","createdBy","condition","1179","543","1218","namespace","Promise","resolve","e","require","mod","__esModule","default","1257","1258","1219","1220","1248","core_1","router_1","SAARouting","ngOnInit","asyncDataWithWebpack","__decorate","Component","selector","directives","ROUTER_DIRECTIVES","template","RouteConfig","path","loader","useAsDefault","__metadata","1187","http_1","routing_amh_1","routing_1","services_1","routing_2","option_1","SAARoutingService","http","config","logger","schemaClause","pointsBySchemaQuery","filterRules","query","fromSortClauses","queryRule","findAssignmentByID","productID","res","findPoints","post","findPointNames","flatMap","dataset","from","hits","hit","toReturn","findPointMatches","text","findPointMatchesJson","toHits","toPointList","R","Array","point","list","payload","hasTextValue","withSchemaText","replace","createSchemaQueryClauses","findPointByName","found","_source","findRuleByPointAndSequence","ruleBySequenceFound","find","log","toRules","schema","join","findOne","target","some","indexOf","findRulesBySchemas","filter","stringify","allRules","schemaFound","debug","findRuleByCode","findRules","getFromSource","r","toLowerCase","toLocaleLowerCase","observer","findBackends","saveRule","env","headers","Headers","Content-Type","options","RequestOptions","put","createRule","saveAssignment","assignment","assignToWriteModel","createAssignment","export","fileName","filePath","response","getExportedFile","import","ruleWriteModel","assigRuleToModel","backendCode","assignmentRule","hitArray","resp","s","match","toFoundHits","totalHits","total","findSchemas","Injectable","Http","Config","Logger","1259"],"mappings":"AAAAA,cAAc,IAERC,IACA,SAASC,EAAQC,EAASC,GCHhC,YACA,IAAAC,GAAAD,EAAA,IACAE,EAAAF,EAAA,IACAC,GAAAE,WAAAC,UAAAC,OAAAH,EAAAG,QDUMC,IACA,SAASR,EAAQC,EAASC,GEdhC,YAyBA,SAAAK,QAAAE,EAAAC,GACA,MAAAC,MAAAC,KAAA,GAAAC,GAAAJ,EAAAC,IAzBA,GAAAI,GAAAH,WAAAG,WAAA,SAAAC,EAAAC,GAEA,QAAAC,MAAmBN,KAAAO,YAAAH,EADnB,OAAAI,KAAAH,KAAAI,eAAAD,KAAAJ,EAAAI,GAAAH,EAAAG,GAEAJ,GAAAT,UAAA,OAAAU,EAAAK,OAAAC,OAAAN,IAAAC,GAAAX,UAAAU,EAAAV,UAAA,GAAAW,MAEAM,EAAArB,EAAA,GAsBAD,GAAAM,aACA,IAAAM,GAAA,WACA,QAAAA,gBAAAJ,EAAAC,GACAC,KAAAF,UACAE,KAAAD,OAKA,MAHAG,gBAAAP,UAAAkB,KAAA,SAAAC,EAAAC,GACA,MAAAA,GAAAC,WAAA,GAAAC,GAAAH,EAAAd,KAAAF,QAAAE,KAAAD,QAEAG,iBAEAZ,GAAAY,gBAMA,IAAAe,GAAA,SAAAC,GAEA,QAAAD,kBAAAE,EAAArB,EAAAC,GACAmB,EAAAL,KAAAb,KAAAmB,GACAnB,KAAAoB,UAAA,EACApB,KAAAqB,IAAAtB,EACAC,KAAAF,UACAE,KAAAsB,QAAA,mBAAAvB,GA4BA,MAlCAI,GAAAc,iBAAAC,GAQAD,iBAAAtB,UAAA4B,MAAA,SAAAC,GACAxB,KAAAoB,WAAApB,KAAAoB,SAAApB,KAAAsB,SACAtB,KAAAyB,WAAAD,IAGAxB,KAAAqB,IAAAG,EACAxB,KAAAoB,UAAA,IAGAH,iBAAAtB,UAAA8B,WAAA,SAAAD,GACA,GAAAE,EACA,KACAA,EAAA1B,KAAAF,QAAAE,KAAAqB,IAAAG,GAEA,MAAAG,GAEA,WADA3B,MAAAmB,YAAAS,MAAAD,GAGA3B,KAAAqB,IAAAK,GAEAT,iBAAAtB,UAAAkC,UAAA,YACA7B,KAAAoB,UAAApB,KAAAsB,UACAtB,KAAAmB,YAAAW,KAAA9B,KAAAqB,KAEArB,KAAAmB,YAAAY,YAEAd,kBACCL,EAAAoB,WACD1C,GAAA2B,oBFqBMgB,IACA,SAAS5C,EAAQC,EAASC,GAE/B,YACA,SAAS2C,UAASC,GACd,IAAK,GAAI3B,KAAK2B,GAAQ7C,EAAQmB,eAAeD,KAAIlB,EAAQkB,GAAK2B,EAAE3B,IG5GrE0B,SAAA3C,EAAc,QHmHR6C,IACA,SAAS/C,EAAQC,EAASC,GAE/B,YACA,SAAS2C,UAASC,GACd,IAAK,GAAI3B,KAAK2B,GAAQ7C,EAAQmB,eAAeD,KAAIlB,EAAQkB,GAAK2B,EAAE3B,IIvHrE0B,SAAA3C,EAAc,QJ8HR8C,KACA,SAAShD,EAAQC,GAEtB,YKhID,IAAAgD,GAAA,WAOI,QAAAA,QAAYC,EAAWC,EAAaC,EAAoBC,GAAA,SAAAA,OAAA,GACpD1C,KAAKwC,KAAOA,EACZxC,KAAKuC,GAAKA,EACVvC,KAAKyC,YAAcA,EACnBzC,KAAK0C,SAAWA,EAYxB,MATIhC,QAAAiC,eAAIL,OAAA3C,UAAA,YL4HCiD,IK5HL,WAAyB,MAAO5C,MAAKyC,aL6HhCI,YAAY,EACZC,cAAc,IK1HZR,OAAAS,SAAP,SAAgBC,GACZ,GAAIC,GAAOC,KAAKC,MAAMH,EACtB,OAAO,IAAIV,QAAOW,EAAKV,GAAIU,EAAKT,KAAMS,EAAKR,cAJxCH,OAAAc,cAAgB,SAACC,GAAkB,MAAAA,GAAW,IAOzDf,SAvBahD,GAAAgD,OAAMA,GL0JbgB,KACA,SAASjE,EAAQC,GAEtB,YMzFD,SAAAiE,cAA6BC,EAAYC,EAAYC,GACjDA,EAAOC,QAAS,SAAAC,GAAK,MAAAJ,GAAKI,GAAKH,EAAKG,IAAMJ,EAAKI,KA1DnD,GAAAC,GAAA,WAKI,QAAAA,eAAYtB,EAAYE,GACpBzC,KAAKuC,GAAKA,EACVvC,KAAKyC,YAAcA,EACnBzC,KAAK8D,YASb,MANIpD,QAAAiC,eAAIkB,cAAAlE,UAAA,YN+ICiD,IM/IL,WAAyB,MAAO5C,MAAKyC,aNgJhCI,YAAY,EACZC,cAAc,IM/InBe,cAAAlE,UAAAoE,SAAA,SAASC,GACLhE,KAAK8D,SAASG,KAAKD,IAG3BH,gBAjBavE,GAAAuE,cAAaA,CAmB1B,IAAAK,GAAA,WAII,QAAAA,WAAY3B,EAAYE,GACpBzC,KAAKuC,GAAKA,EACVvC,KAAKyC,YAAcA,EAK3B,MAFI/B,QAAAiC,eAAIuB,UAAAvE,UAAA,YN8ICiD,IM9IL,WAAyB,MAAO5C,MAAKyC,aN+IhCI,YAAY,EACZC,cAAc,IM9IvBoB,YAXa5E,GAAA4E,UAASA,CAatB,IAAAC,GAAA,WAKI,QAAAA,mBAAY5B,EAAYC,EAAcC,GAClCzC,KAAKuC,GAAKA,EACVvC,KAAKwC,KAAOA,EACZxC,KAAKyC,YAAcA,EAe3B,MAZI/B,QAAAiC,eAAIwB,kBAAAxE,UAAA,YN6ICiD,IM7IL,WAAyB,MAAO5C,MAAKyC,aN8IhCI,YAAY,EACZC,cAAc,IM3IZqB,kBAAApB,SAAP,SAAgBC,GACZ,GAAIC,GAAOC,KAAKC,MAAMH,EACtB,OAAO,IAAImB,mBAAkBlB,EAAKV,GAAIU,EAAKT,KAAMS,EAAKR,cAGnD0B,kBAAAC,MAAP,WACG,MAAO,IAAID,mBAAkB,EAAG,GAAG,KAR/BA,kBAAAf,cAAgB,SAACC,GAAmB,MAAAA,GAAa,MAU5Dc,oBAvBa7E,GAAA6E,kBAAiBA,EAyBd7E,EAAAiE,aAAYA,cNsJtBc,KACA,SAAShF,EAAQC,EAASC,GAE/B,YO/ND,IAAA+E,GAAA/E,EAAyB,KAEzBgF,EAAA,WAIE,QAAAA,kBAAYC,EAAmBC,GAC7BzE,KAAKwE,KAAOA,EACZxE,KAAKyE,mBAAqBzE,KAAK0E,0BAA0BF,EAAMC,GAkCnE,MA/BUF,kBAAA5E,UAAA+E,0BAAR,SAAkCF,EAAmBC,GACnD,GAAIA,EACF,MAAOA,EAGT,QAAQD,GACN,IAAKF,GAAAK,WAAWC,WACd,MAAO,EACT,KAAKN,GAAAK,WAAWE,SAChB,IAAKP,GAAAK,WAAWG,cACd,MAAO,OAINP,iBAAA5E,UAAAoF,gBAAP,SAAuBP,GACrB,MAAQA,IAAQF,EAAAK,WAAW3E,KAAKwE,OAG3BD,iBAAA5E,UAAAqF,aAAP,WACE,MAAOV,GAAAK,WAAW3E,KAAKwE,OAGlBD,iBAAA5E,UAAAsF,gBAAP,WACE,OAAQjF,KAAKwE,MACX,IAAKF,GAAAK,WAAWC,WACd,OAAO,CACT,KAAKN,GAAAK,WAAWE,SAChB,IAAKP,GAAAK,WAAWG,cACd,OAAO,IAGfP,mBAxCajF,GAAAiF,iBAAgBA,GPsQvBW,KACA,SAAS7F,EAAQC,GAEtB,YQzQD,IAAA6F,GAAA,WAaE,QAAAA,gBAAYC,EAAiB5C,EAAc6C,EAAkBC,EAAuBC,EAAkBC,EAC1FC,EAAkBC,EAAyBC,EAAsBC,EAAsBC,GACjG7F,KAAKoF,OAASA,EACdpF,KAAKwC,KAAOA,EACZxC,KAAKqF,SAAWA,EAChBrF,KAAKsF,cAAgBA,EACrBtF,KAAKuF,SAAWA,EAChBvF,KAAKwF,aAAeA,EACpBxF,KAAKyF,SAAWA,EAChBzF,KAAK0F,gBAAkBA,EACvB1F,KAAK2F,aAAgBA,EACrB3F,KAAK4F,YAAcA,EACnB5F,KAAK6F,QAAUA,EAEnB,MAAAV,kBA3Ba7F,GAAA6F,eAAcA,GR+RrBW,KACA,SAASzG,EAAQC,GAEtB,YSnSD,IAAAyG,GAAA,WASE,QAAAA,gBAAYvD,EAAcwD,EAAmBC,EAAkBC,EAAmBN,EAAqBC,EAAiBM,GACtHnG,KAAKwC,KAAOA,EACZxC,KAAKgG,UAAYA,EACjBhG,KAAKiG,SAAWA,EAChBjG,KAAKkG,SAAWA,EAChBlG,KAAK4F,YAAcA,EACnB5F,KAAK6F,QAAUA,EACf7F,KAAKmG,WAAaA,EAEtB,MAAAJ,kBAlBazG,GAAAyG,eAAcA,GTqTrBK,IACA,SAAS/G,EAAQC,GAEtB,cUxTD,SAAYqF,GACVA,IAAA,2BACAA,IAAA,uBACAA,IAAA,kCAHUrF,EAAAqF,aAAArF,EAAAqF,eAAArF,GAAAqF,YVmUN0B,KACA,SAAShH,EAAQC,EAASC,GAE/B,YWvUD,IAAA+G,GAAA/G,EAAyB,KAEzBgH,EAAA,WAME,QAAAA,yBAAY/D,EAAcgE,EAAkBR,EAAoBC,GAC9DjG,KAAKwC,KAAOA,EACZxC,KAAKwG,UAAYA,EACjBxG,KAAKgG,UAAYA,EACjBhG,KAAKiG,SAAWA,EA4BpB,MAzBSM,yBAAA5G,UAAA8G,aAAP,SAAoBjC,EAAkBkC,EAAwBd,EAAqBC,EAAiBc,EAA8BC,EAA0BC,EAA0BC,GACpL,OAAQtC,GACN,IAAK8B,GAAA3B,WAAWE,SAChB,IAAKyB,GAAA3B,WAAWG,cACd,OACEtC,KAAMkE,EACNrB,SAAUrF,KAAKwC,KACf8C,cAAetF,KAAKwG,UACpBR,UAAWhG,KAAKgG,UAChBC,SAAUjG,KAAKiG,SACfL,YAAaA,EACbC,QAASA,EACTc,mBAAqBA,EACrBC,iBAAmBA,EACnBC,eAAiBA,EACjBC,aAAeA,EAEjB,SACA,WAIQP,wBAAAxD,SAAd,SAAuBC,GACnB,MAAO,IAAIuD,yBAAwBvD,EAAKR,KAAMQ,EAAKwD,UAAWxD,EAAKgD,UAAWhD,EAAKiD,WAEzFM,0BAtCajH,GAAAiH,wBAAuBA,GX6W9BQ,KACA,SAAS1H,EAAQC,EAASC,GAE/B,YYlXD,IAAA+G,GAAA/G,EAAyB,KAEzByH,EAAA,WASE,QAAAA,sBAAYxE,EAAcwD,EAAmBC,EAAkBC,EAAkBC,GAC/EnG,KAAKwC,KAAOA,EACZxC,KAAKgG,UAAYA,EACjBhG,KAAKiG,SAAWA,EAChBjG,KAAKkG,SAAWA,EAChBlG,KAAKmG,WAAaA,EA2BtB,MAxBSa,sBAAArH,UAAA8G,aAAP,SAAoBjC,EAAkBkC,EAAwBd,EAAqBC,EAAiBc,EAA8BC,EAA0BC,EAA0BC,GACpL,OAAQtC,GACN,IAAK8B,GAAA3B,WAAWC,WAChB,IAAK0B,GAAA3B,WAAWE,SAChB,IAAKyB,GAAA3B,WAAWG,cACd,OACItC,KAAMkE,EACNR,SAAUlG,KAAKkG,SACfT,SAAUzF,KAAKwC,KACfwD,UAAWhG,KAAKgG,UAChBC,SAAUjG,KAAKiG,SACfL,YAAaA,EACbC,QAASA,EACTc,mBAAqBA,EACrBC,iBAAmBA,EACnBC,eAAiBA,EACjBC,aAAeA,KAKXE,qBAAAjE,SAAd,SAAuBC,GACnB,MAAO,IAAIgE,sBAAqBhE,EAAKR,KAAMQ,EAAKgD,UAAWhD,EAAKiD,SAAUjD,EAAKkD,SAAUlD,EAAKmD,aAEpGa,uBAzCa1H,GAAA0H,qBAAoBA,GZwZ3BC,KACA,SAAS5H,EAAQC,EAASC,GAE/B,Ya5ZD,IAAA2H,GAAA3H,EAAsC,MACtC4H,EAAA5H,EAAmC,MACnC+G,EAAA/G,EAAyB,KAEzB6H,EAAA,WAeE,QAAAA,kBAAYhC,EAAkBiC,EAA+B7E,EAAewD,EAAoBvD,EAAsBwD,EAAmBC,EAAmBoB,EAAiBC,EAAe3B,EAAsBC,EAAkB2B,EAAqCC,GACvQzH,KAAKoF,OAASA,EACdpF,KAAKqH,kBAAoBA,EACzBrH,KAAKwC,KAAOA,EACZxC,KAAKgG,UAAYA,EACjBhG,KAAKyC,YAAcA,EACnBzC,KAAKiG,SAAWA,EAChBjG,KAAKkG,SAAWA,GAAYwB,OAC5B1H,KAAKsH,OAASA,GAAUI,OACxB1H,KAAKuH,KAAOA,EACZvH,KAAK4F,YAAcA,EACnB5F,KAAK6F,QAAUA,EACf7F,KAAKwH,MAAQA,MACbxH,KAAKyH,SAAWA,MA4DpB,MAzDSL,kBAAAzH,UAAAgI,gBAAP,WACE,MAAO3H,MAAKqH,mBAAqBrH,KAAKqH,kBAAkB7E,MAAQxC,KAAKyH,SAASG,IAAI,SAAAC,GAAW,MAAAA,GAAQrF,QAGhG4E,iBAAAzH,UAAA8G,aAAP,SAAoBjC,EAAkBoB,EAAqBC,EAAiBc,EAA8BC,EAA0BC,EAA0BC,GAA9J,GAAAgB,GAAA9H,KACMwH,EAAqCxH,KAAKwH,SAC9CA,GAAQA,EAAMI,IAAI,SAAAG,GAAQ,MAAAA,GAAKtB,aAAajC,EAAMsD,EAAKtF,KAAMoD,EAAaC,EAASc,EAAqBC,EAAkBC,EAAgBC,IAE1I,IAAIW,GAA2CzH,KAAKyH,YACpDA,GAAWA,EAASG,IAAI,SAAAC,GAAW,MAAAA,GAAQpB,aAAajC,EAAMsD,EAAKtF,KAAMoD,EAAaC,EAASc,EAAqBC,EAAkBC,EAAgBC,IAEtJ,IAAIkB,IACF9B,SAAUlG,KAAKkG,SACfd,OAAQ6C,OAAOjI,KAAKoF,QACpBY,UAAWhG,KAAKgG,UAChBC,SAAUjG,KAAKiG,SACfxD,YAAazC,KAAKyC,YAClBmD,YAAaA,EACbC,QAASA,EACT2B,MAAOA,EACPb,mBAAqBA,EACrBC,iBAAmBA,EACnBC,eAAiBA,EACjBC,aAAeA,EAIjB,QAAQtC,GACN,IAAK8B,GAAA3B,WAAWC,WAEdoD,EAAwB,SAAIhI,KAAKqH,kBAAkB7E,KACnDwF,EAA6B,cAAIhI,KAAKqH,kBAAkBb,SACxD,MAEF,KAAKF,GAAA3B,WAAWE,SAChB,IAAKyB,GAAA3B,WAAWG,cAEdkD,EAAsB,OAAIhI,KAAKsH,OAC/BU,EAAoB,KAAIhI,KAAKuH,KAC7BS,EAAwB,SAAIP,EAIhC,MAAOO,IAGKZ,iBAAArE,SAAd,SAAuBC,GACrB,GAAIwE,GAAqCxE,EAAKwE,UAC1CC,EAA2CzE,EAAKyE,YAEpD,OAAO,IAAIL,kBAAiBpE,EAAKoC,OAAQpC,EAAKqE,kBAAmBrE,EAAKR,KAAMQ,EAAKgD,UAAWhD,EAAKP,YAAaO,EAAKiD,SAAUjD,EAAKkD,SAAUlD,EAAKsE,OAAQtE,EAAKuE,KAAMvE,EAAK4C,YAAa5C,EAAK6C,QACzL2B,EAAMI,IAAI,SAAAG,GAAQ,MAAAZ,GAAAH,qBAAqBjE,SAASgF,KAChDN,EAASG,IAAI,SAAAC,GAAW,MAAAX,GAAAX,wBAAwBxD,SAAS8E,OAK/DT,mBAxFa9H,GAAA8H,iBAAgBA,Gb6dvBc,KACA,SAAS7I,EAAQC,GAEtB,YcjeD,IAAA6I,GAAA,WAYE,QAAAA,YAAY/C,EAAkBiC,EAA+B7E,EAAewD,EAAoBvD,EAAsBwD,EAAmBC,EAAmBN,EAAsBC,EAAkB2B,GAClMxH,KAAKoF,OAASA,EACdpF,KAAKqH,kBAAoBA,EACzBrH,KAAKwC,KAAOA,EACZxC,KAAKgG,UAAYA,EACjBhG,KAAKyC,YAAcA,EACnBzC,KAAKiG,SAAWA,EAChBjG,KAAKkG,SAAWA,EAChBlG,KAAK4F,YAAaA,EAClB5F,KAAK6F,QAAUA,EACf7F,KAAKwH,MAAQA,MAEjB,MAAAW,cAxBa7I,GAAA6I,WAAUA,GdsfjBC,KACA,SAAS/I,EAAQC,GAEtB,Ye7fD,IAAA+I,GAAA,WAIE,QAAAA,WAAY7F,EAAcgE,GACxBxG,KAAKwC,KAAOA,EACZxC,KAAKwG,UAAYA,EAUrB,MAPS6B,WAAAC,OAAP,SAAcC,GACZ,MAAOA,GAAG/F,KAAKgG,WAAa,IAAMD,EAAG/B,UAAUgC,YAG1CH,UAAAI,KAAP,SAAYjG,EAAcgE,GACxB,MAAOhE,GAAKgG,WAAa,IAAMhC,EAAUgC,YAE7CH,YAhBa/I,GAAA+I,UAASA,GfghBhBK,KACA,SAASrJ,EAAQC,GAEtB,YgBhhBD,IAAAqJ,GAAA,WASE,QAAAA,SAAYC,EAAeC,EAAoBrG,EAAewD,EAAoBvD,EAAsBwD,EAAmBsB,GACzHvH,KAAK4I,OAASA,EACd5I,KAAK6I,YAAcA,EACnB7I,KAAKwC,KAAOA,EACZxC,KAAKgG,UAAYA,EACjBhG,KAAKyC,YAAcA,EACnBzC,KAAKiG,SAAWA,EAChBjG,KAAKuH,KAAOA,EAIhB,MAAAoB,WApBarJ,GAAAqJ,QAAOA,GhBkiBdG,IACA,SAASzJ,EAAQC,EAASC,GAE/B,YACA,SAAS2C,UAASC,GACd,IAAK,GAAI3B,KAAK2B,GAAQ7C,EAAQmB,eAAeD,KAAIlB,EAAQkB,GAAK2B,EAAE3B,IiBziBrE0B,SAAA3C,EAAc,OACd2C,SAAA3C,EAAc,OACd2C,SAAA3C,EAAc,OACd2C,SAAA3C,EAAc,OACd2C,SAAA3C,EAAc,OACd2C,SAAA3C,EAAc,OACd2C,SAAA3C,EAAc,OACd2C,SAAA3C,EAAc,OACd2C,SAAA3C,EAAc,OACd2C,SAAA3C,EAAc,MACd2C,SAAA3C,EAAc,OACd2C,SAAA3C,EAAc,QjBgjBRwJ,KACA,SAAS1J,EAAQC,GAEtB,ckB9jBD,SAAY0J,GACVA,IAAA,aACAA,IAAA,uBACAA,IAAA,4BAHU1J,EAAA0J,iBAAA1J,EAAA0J,mBAAA1J,GAAA0J,gBlBykBNC,KACA,SAAS5J,EAAQC,EAASC,GAE/B,YmB7kBD,IAAA2J,GAAA3J,EAAwB,KAExB4J,EAAA,SAAAjI,GAWC,QAAAiI,SAAY3G,EAAc2D,EAAoBH,EAAqBC,EAAmBzB,EAAeoB,EAAsBC,GACzH3E,EAAAL,KAAAb,MAHMA,KAAA0C,UAAoB,EAI1B1C,KAAKwC,KAAKA,EACXxC,KAAKgG,UAAUA,EACfhG,KAAKmG,WAAWA,EAChBnG,KAAKiG,SAASA,EACdjG,KAAKwE,KAAKA,EAiCZ,MAlD6BrE,WAAAgJ,QAAAjI,GAqBtBiI,QAAAxJ,UAAA8G,aAAP,WACG,OACEN,WAAanG,KAAKmG,WAClBH,UAAYhG,KAAKgG,UACjBC,SAAWjG,KAAKiG,SAChBmD,SAAUpJ,KAAKwE,KACfoB,YAAa5F,KAAK4F,YAClBC,QAAS7F,KAAK6F,QACdc,mBAAqB3G,KAAK2G,mBAC1BC,iBAAkB5G,KAAK4G,iBACvBC,eAAiB7G,KAAK6G,eACvBC,aAAc9G,KAAK8G,eAIfqC,QAAAxJ,UAAA0J,iBAAP,SAAwBzD,EAAqBC,GAC1C7F,KAAK4F,YAAcA,EACnB5F,KAAK6F,QAAUA,GAGVsD,QAAAxJ,UAAA2J,uBAAP,WACE,MAAO,IAAIH,SAAQnJ,KAAKwC,KAAK+G,cAAevJ,KAAKmG,WAAYnG,KAAKgG,UAAYhG,KAAKiG,SAAUjG,KAAKwE,KAAMxE,KAAK4F,YAAa5F,KAAK6F,UAGnHsD,QAAApG,SAAd,SAAuBC,GACnB,MAAO,IAAImG,SAAQnG,EAAKR,KAAMQ,EAAKmD,WAAYnD,EAAKgD,UAAWhD,EAAKiD,SAAUjD,EAAKwB,KAAMxB,EAAK4C,YAAa5C,EAAK6C,UAItHsD,SAlD6BD,EAAAM,UAAhBlK,GAAA6J,QAAOA,GnBynBdM,KACA,SAASpK,EAAQC,GAEtB,coB9nBD,SAAYoK,GACVA,IAAA,mBACAA,IAAA,6BACAA,IAAA,gDAHUpK,EAAAoK,WAAApK,EAAAoK,aAAApK,GAAAoK,UpByoBNC,KACA,SAAStK,EAAQC,EAASC,GAE/B,YqB5oBD,IAAAqK,GAAArK,EAAgC,KAChCsK,EAAAtK,EAAqB,MACrBuK,EAAAvK,EAA0B,MAE1BwK,EAAA,WAME,QAAAA,QAAYC,EAA8BjJ,EAAgBkJ,GACtDjK,KAAKgK,SAAWA,EAChBhK,KAAKe,OAASA,EACdf,KAAKiK,YAAcA,EAmEzB,MAhEgBF,QAAA3F,MAAd,WACE,MAAO,IAAI2F,QAAOH,EAAAzF,kBAAkBC,QAASyF,EAAAK,OAAO9F,QAAS0F,EAAAK,YAAY/F,UAGpE2F,OAAApK,UAAAyK,OAAP,SAAcC,GAIZN,OAAOO,YAAYD,GAAO,WAAW,SAAS,eAAgBrK,OAGzD+J,OAAApK,UAAA8G,aAAP,WA0BC,GAAIuD,GAAgC,GAApBhK,KAAKgK,SAASzH,GAAU,SAA+B,GAApBvC,KAAKgK,SAASzH,GAAU,eAAiB,0BACxFgI,EAAgBvK,KAAKiK,YAAYM,cAAiBvK,KAAKiK,YAAYO,mBAAqB,IAAIxK,KAAKiK,YAAYO,mBAAqB,GAErI,QACAR,SAAYA,EACfS,eAAkBzK,KAAKe,OAAO2J,OAC9BC,yBAA4B3K,KAAKe,OAAO6J,aACxCC,6BAAgC7K,KAAKe,OAAO+J,iBAC5CC,oBAAuB/K,KAAKe,OAAOiK,YACnCC,oBAAuBjL,KAAKe,OAAOmK,aACnCC,aAAgBnL,KAAKe,OAAOqK,KAC5BC,iBAAoBrL,KAAKe,OAAOuK,SAChCC,kBAAqBvL,KAAKiK,YAAYS,OACtCc,uBAA0BxL,KAAKiK,YAAYe,YAC3CS,4BAA+BzL,KAAKiK,YAAYW,aAChDc,gCAAmC1L,KAAKiK,YAAYa,iBACpDa,uBAA0B3L,KAAKiK,YAAYiB,aAC3CU,gBAAmBrB,EACnBsB,gBAAmB7L,KAAKiK,YAAYmB,KACpCU,oBAAuB9L,KAAKiK,YAAYqB,WAIhCvB,OAAAO,YAAP,SAAmB7G,EAAYC,EAAwBF,GACrDE,EAAOC,QAAS,SAAAC,GAAK,MAAAJ,GAAKI,GAAKH,EAAKG,IAAMJ,EAAKI,MAGnDmG,SA5EazK,GAAAyK,OAAMA,GrBqtBbgC,KACA,SAAS1M,EAAQC,GAEtB,csB5tBD,SAAY0M,GACVA,IAAA,qBACAA,IAAA,uBACAA,IAAA,2CACAA,IAAA,oBAJU1M,EAAA0M,gBAAA1M,EAAA0M,kBAAA1M,GAAA0M,etBwuBNC,KACA,SAAS5M,EAAQC,EAASC,GAE/B,YuB3uBD,IAAAqK,GAAArK,EAAgC,KAChC2M,EAAA3M,EAA2B,KAG3B4M,EAAA,WAKE,QAAAA,WAAYC,EAAiCC,EAAiCC,GAC5EtM,KAAKoM,YAAcA,EACnBpM,KAAKqM,UAAYA,EACjBrM,KAAKsM,QAAUA,EA6BnB,MA1BSH,WAAA/H,MAAP,WACE,MAAO,IAAI+H,WAAUvC,EAAAzF,kBAAkBC,WAAa,KAG/C+H,UAAAxM,UAAAyK,OAAP,SAAcC,GACZ6B,EAAA3I,aAAavD,KAAMqK,GAAO,cAAe,YAAa,aAGjD8B,UAAAxM,UAAA8G,aAAP,WACE,GAAI8F,GAAsB7E,MAEtB1H,MAAKqM,WAAarM,KAAKqM,UAAUG,OAAS,IAC3CD,EAAsBvM,KAAKqM,UAAUzM,OAC5B,SAACyB,EAAKoL,GACJ,MAAOpL,GAAImL,OAAS,EAAInL,EAAM,IAAMoL,EAAIhK,YAAcgK,EAAIhK,aACzD,IAGf,IAAI2J,GAAqC,GAAvBpM,KAAKoM,YAAY7J,GAAU,UAAmC,GAAvBvC,KAAKoM,YAAY7J,GAAU,WAAa,sBAEjG,QACE6J,YAAeA,EACfM,SAAmC,GAAvB1M,KAAKoM,YAAY7J,GAAUvC,KAAKsM,QAAU,GACtDK,aAAuC,GAAvB3M,KAAKoM,YAAY7J,GAAUgK,EAAsB,KAGvEJ,YArCa7M,GAAA6M,UAASA,GvB2wBhBS,KACA,SAASvN,EAAQC,EAASC,GAE/B,YACA,SAAS2C,UAASC,GACd,IAAK,GAAI3B,KAAK2B,GAAQ7C,EAAQmB,eAAeD,KAAIlB,EAAQkB,GAAK2B,EAAE3B,IwBnxBrE0B,SAAA3C,EAAc,OACd2C,SAAA3C,EAAc,OACd2C,SAAA3C,EAAc,OACd2C,SAAA3C,EAAc,OACd2C,SAAA3C,EAAc,OACd2C,SAAA3C,EAAc,OACd2C,SAAA3C,EAAc,OACd2C,SAAA3C,EAAc,OACd2C,SAAA3C,EAAc,QxB0xBRsN,KACA,SAASxN,EAAQC,EAASC,GAE/B,YyBtyBD,IAAAsK,GAAAtK,EAAqB,MAErB4K,EAAA,SAAAjJ,GAIE,QAAAiJ,aAAYI,EAAuBC,EAA6BE,EAAiBQ,EAAuBN,EAAuBE,EAA2BM,EAAeJ,EAAsBM,GAC3LpK,EAAAL,KAAAb,KAAM0K,EAAQQ,EAAcN,EAAcE,EAAkBM,EAAMJ,EAAaM,GAC/EtL,KAAKuK,aAAeA,EACpBvK,KAAKwK,mBAAqBA,EAMhC,MAbiCrK,WAAAgK,YAAAjJ,GAUxBiJ,YAAA/F,MAAP,WACE,MAAO,IAAI+F,aAAY,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,KAEnDA,aAbiCN,EAAAK,OAApB5K,GAAA6K,YAAWA,GzBuzBlB2C,KACA,SAASzN,EAAQC,GAEtB,Y0B3zBD,IAAAyN,GAAA,WAWA,QAAAA,WAAYC,EAAmBC,EAAiBC,EAAiBC,EAA0BC,EAC/EC,EAAyBC,EAAwBC,EAAqBC,GAC9ExN,KAAKgN,UAAYA,EACjBhN,KAAKiN,QAAUA,EACfjN,KAAKkN,QAAUA,EACflN,KAAKmN,gBAAkBA,EACvBnN,KAAKoN,YAAcA,EACnBpN,KAAKqN,cAAgBA,EACrBrN,KAAKsN,aAAeA,EACpBtN,KAAKuN,UAAYA,EACjBvN,KAAKwN,SAAWA,EAEpB,MAAAT,aAvBazN,GAAAyN,UAASA,G1B+0BhBU,KACA,SAASpO,EAAQC,GAEtB,Y2Bj1BD,IAAAoO,GAAA,WAKE,QAAAA,OAAYV,EAAmBW,EAAenG,GAC5CxH,KAAKgN,UAAYA,EACjBhN,KAAK2N,KAAOA,EACZ3N,KAAKwH,MAAQA,EAEjB,MAAAkG,SAVapO,GAAAoO,MAAKA,G3B+1BZE,KACA,SAASvO,EAAQC,EAASC,GAE/B,Y4Bp2BD,IAAAsO,GAAAtO,EAAwB,MACxBuO,EAAAvO,EAAqB,MACrBqK,EAAArK,EAA2B,KAE3BwO,EAAA,WAWE,QAAAA,MAAY7H,EAAkB8H,EAAsBvL,EAAsBwK,EAAoBgB,EAAyBnH,EAAqBoH,EAAoBC,EAAuBzD,GACrL1K,KAAKkG,SAAWA,EAChBlG,KAAKgO,aAAeA,EACpBhO,KAAKyC,YAAcA,EACnBzC,KAAKiN,QAAUA,EACfjN,KAAKiO,iBAAmBA,EACxBjO,KAAK8G,aAAeA,EACpB9G,KAAKkO,UAAYA,EACjBlO,KAAKmO,UAAYA,EACjBnO,KAAK0K,OAASA,EAwBlB,MArBgBqD,MAAA3J,MAAd,WACE,MAAO,IAAI2J,MAAKrG,OAAW,GAAG,MAAMA,OAAWA,OAAWA,OAAWmG,EAAA1B,UAAU/H,QAAS0J,EAAA/D,OAAO3F,UAG1F2J,KAAApO,UAAAyK,OAAP,SAAeC,GACbT,EAAArG,aAAavD,KAAMqK,GAAO,WAAW,eAAe,cACnD,UAAU,mBAAmB,eAAe,cAC7CrK,KAAKmO,UAAU/D,OAAOC,EAAK8D,WAC3BnO,KAAK0K,OAAON,OAAOC,EAAKK,SAGnBqD,KAAApO,UAAA8G,aAAP,SAAoBb,EAAsBC,GACxC,OACE8H,KAAS,OACTR,gBAAoBnN,KAAKyC,YACzBmD,YAAgBA,EAChBC,QAAYA,EACZ6E,OAAW1K,KAAK0K,OAAOjE,eACvB0H,UAAcnO,KAAKmO,UAAU1H,iBAGnCsH,OA5CazO,GAAAyO,KAAIA,G5B04BXK,KACA,SAAS/O,EAAQC,GAEtB,Y6Bh5BD,IAAA4K,GAAA,WAUE,QAAAA,QAAYQ,EAAiBQ,EAAuBN,EAAuBE,EAA2BM,EAAeJ,EAAsBM,GACzItL,KAAK0K,OAASA,EACd1K,KAAKkL,aAAeA,EACpBlL,KAAK4K,aAAeA,EACpB5K,KAAK8K,iBAAmBA,EACxB9K,KAAKoL,KAAOA,EACZpL,KAAKgL,YAAcA,EACnBhL,KAAKsL,SAAWA,EAMpB,MAHSpB,QAAA9F,MAAP,WACE,MAAO,IAAI8F,QAAO,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,KAE9CA,SAvBa5K,GAAA4K,OAAMA,G7Bs6BbmE,IACA,SAAShP,EAAQC,EAASC,GAE/B,YACA,SAAS2C,UAASC,GACd,IAAK,GAAI3B,KAAK2B,GAAQ7C,EAAQmB,eAAeD,KAAIlB,EAAQkB,GAAK2B,EAAE3B,I8B56BrE0B,SAAA3C,EAAc,OACd2C,SAAA3C,EAAc,Q9Bm7BR+O,KACA,SAASjP,EAAQC,EAASC,G+Br7BhCF,EAAAC,QAAA,SAAAiP,GACA,UAAAC,SAAA,SAAAC,GACAlP,EAAAmP,EAAA,YAAAC,GACA,GAAAJ,EACAE,EAAAlP,EAAA,MAAAgP,QACO,CACP,GAAAK,GAAArP,EAAA,KACAkP,GAAAG,EAAAC,WAAAD,EAAAE,QAAAF,U/B+7BMG,KACA,SAAS1P,EAAQC,EAASC,GgCv8BhCF,EAAAC,QAAA,SAAAiP,GACA,UAAAC,SAAA,SAAAC,GACAlP,EAAAmP,EAAA,YAAAC,GACA,GAAAJ,EACAE,EAAAlP,EAAA,MAAAgP,QACO,CACP,GAAAK,GAAArP,EAAA,KACAkP,GAAAG,EAAAC,WAAAD,EAAAE,QAAAF,UhCi9BMI,KACA,SAAS3P,EAAQC,EAASC,GiCz9BhCF,EAAAC,QAAA,SAAAiP,GACA,UAAAC,SAAA,SAAAC,GACAlP,EAAAmP,EAAA,YAAAC,GACA,GAAAJ,EACAE,EAAAlP,EAAA,MAAAgP,QACO,CACP,GAAAK,GAAArP,EAAA,KACAkP,GAAAG,EAAAC,WAAAD,EAAAE,QAAAF,UjCm+BMK,KACA,SAAS5P,EAAQC,EAASC,GkC3+BhCF,EAAAC,QAAA,SAAAiP,GACA,UAAAC,SAAA,SAAAC,GACAlP,EAAAmP,EAAA,YAAAC,GACA,GAAAJ,EACAE,EAAAlP,EAAA,MAAAgP,QACO,CACP,GAAAK,GAAArP,EAAA,KACAkP,GAAAG,EAAAC,WAAAD,EAAAE,QAAAF,UlCq/BMM,KACA,SAAS7P,EAAQC,EAASC,GmC7/BhCF,EAAAC,QAAA,SAAAiP,GACA,UAAAC,SAAA,SAAAC,GACAlP,EAAAmP,EAAA,YAAAC,GACA,GAAAJ,EACAE,EAAAlP,EAAA,MAAAgP,QACO,CACP,GAAAK,GAAArP,EAAA,KACAkP,GAAAG,EAAAC,WAAAD,EAAAE,QAAAF,UnCugCMO,KACA,SAAS9P,EAAQC,EAASC,GAE/B,YoCjhCD,IAAA6P,GAAA7P,EAAwB,IACxB8P,EAAA9P,EAA0D,IA2B1D+P,EAAA,WACE,QAAAA,eA2BF,MAvBEA,YAAA3P,UAAA4P,SAAA,aAQAD,WAAA3P,UAAA6P,qBAAA,aApCFF,WAAAG,YAACL,EAAAM,WACCC,SAAU,cAMVC,YAAaP,EAAAQ,mBACbC,SAAU,8CAIXT,EAAAU,cACGC,KAAM,IAAKzI,KAAM,iBAAkB0I,OAAQ,WAAM,MAAA1Q,GAAQ,MAAkC,mBAAmB2Q,cAAc,IAC5HF,KAAM,oBAAqBzI,KAAM,iBAAkB0I,OAAQ,WAAM,MAAA1Q,GAAQ,MAAqC,iCAC9GyQ,KAAM,wBAAyBzI,KAAM,cAAe0I,OAAQ,WAAM,MAAA1Q,GAAQ,MAAmC,sBAC7GyQ,KAAM,0BAA2BzI,KAAM,YAAa0I,OAAQ,WAAM,MAAA1Q,GAAQ,MAAmC,sBAC7GyQ,KAAM,uBAAwBzI,KAAM,aAAc0I,OAAQ,WAAM,MAAA1Q,GAAQ,MAAkC,qBAC1GyQ,KAAM,0CAA2CzI,KAAM,WAAY0I,OAAQ,WAAM,MAAA1Q,GAAQ,MAAkC,qBAC3HyQ,KAAM,UAAWzI,KAAM,YAAa0I,OAAQ,WAAM,MAAA1Q,GAAQ,MAAmC,+BAC7FyQ,KAAM,cAAezI,KAAM,gBAAiB0I,OAAQ,WAAM,MAAA1Q,GAAQ,MAA+B,4BACjGyQ,KAAM,UAAWzI,KAAM,YAAa0I,OAAQ,WAAM,MAAA1Q,GAAQ,MAAmC,gCpC0iCxF4Q,WAAW,yBACZb,coCziCKhQ,GAAAgQ,WAAUA,GpCijCjBc,KACA,SAAS/Q,EAAQC,EAASC,GAE/B,YqChlCD,IAAA8Q,GAAA9Q,EAA8C,KAC9C6P,EAAA7P,EAA2B,IAC3BC,EAAAD,EAA2B,IAC3B+Q,EAAA/Q,EAAwF,KACxFgR,EAAAhR,EAAqB,MAErBiR,EAAAjR,EAA+B,IAC/BkR,EAAAlR,EAAiC,MACjCmR,EAAAnR,EAAuB,IACvBA,GAAO,IAGP,IAAAoR,GAAA,WA4HE,QAAAA,mBAAoBC,EAAoBC,EAAwBC,GAA5C9Q,KAAA4Q,OAAoB5Q,KAAA6Q,SAAwB7Q,KAAA8Q,SA3HxD9Q,KAAA+Q,aAAe,iLAWf/Q,KAAAgR,oBAAsB,yYAwBtBhR,KAAAiR,YAAuB,gDAMvBjR,KAAAkR,MAAgB,mFAShBlR,KAAAmR,gBAAkB,8MAkBlBnR,KAAAoR,UAAoB,k0CAoe9B,MAxaET,mBAAAhR,UAAA0R,mBAAA,SAAmBC,GACjB,MAAOtR,MAAK4Q,KAAKhO,IAAI,0BAA0BgF,IAAI,SAAA2J,GAAO,MAAAA,GAAIvO,UAQhE2N,kBAAAhR,UAAA6R,WAAA,WACE,MAAOxR,MAAK4Q,KAAKa,KAAKzR,KAAK6Q,OAAOjO,IAAI,aAAe,0BAA2B,sFAAsFgF,IAAI,SAAA2J,GAAO,MAAAA,GAAIvO,UAGvL2N,kBAAAhR,UAAA+R,eAAA,WACE,MAAO1R,MAAK4Q,KAAKa,KAAKzR,KAAK6Q,OAAOjO,IAAI,aAAe,oCAAqC,gHACvFgF,IAAI,SAAA2J,GAAO,MAAAA,GAAIvO,SACf2O,QAAQ,SAAAC,GAAW,MAAApS,GAAAE,WAAWmS,KAAKD,EAAc,KAAEE,QACnDlK,IAAI,SAAAmK,GACH,GAAIC,IACFhF,UAAa+E,EAAY,OAAa,UAAE,GAG1C,OAAOC,MAIbrB,kBAAAhR,UAAAsS,iBAAA,SAAiBhF,EAAyBiF,GACxC,MAAIA,GACKlS,KAAKmS,qBAAqBlF,EAAQiF,GACtCP,QAAQ3R,KAAKoS,QACbT,QAAQ3R,KAAKqS,aACbzS,OAAO,SAACyB,EAAKiR,GAAqB,MAAbjR,GAAI4C,KAAKqO,GAAWjR,GAAO,GAAIkR,QAGhDvS,KAAKmS,qBAAqBlF,EAAQiF,GACtCP,QAAQ3R,KAAKoS,QACbT,QAAQ3R,KAAKqS,aACbzS,OAAO,SAACyB,EAAKiR,GAAqB,MAAbjR,GAAI4C,KAAKqO,GAAWjR,GAAO,GAAIkR,SAInD5B,kBAAAhR,UAAA0S,YAAR,SAAoBG,GAClB,GAAIC,KAkBJ,OAjBID,GAAMhL,MAAMgF,OAAS,EAEvBgG,EAAMhL,MAAMI,IAAI,SAAAG,GACd,GAAIsF,GAAgBtF,EAAK2C,OAAO3J,OAASgH,EAAK2C,OAAO3J,OAAOmK,aAAe,GACvEoC,EAAevF,EAAK2C,OAAO3J,OAASgH,EAAK2C,OAAO3J,OAAOiK,YAAc,GACrEuC,EAAYxF,EAAK2C,OAAOT,YAAclC,EAAK2C,OAAOT,YAAYiB,aAAe,GAC7EsC,EAAWzF,EAAK2C,OAAOT,YAAclC,EAAK2C,OAAOT,YAAYe,YAAc,EAE/EyH,GAAKxO,KAAK,GAAIwM,GAAA1D,UAAUhF,EAAKiG,aAAcjG,EAAKkF,QAASlF,EAAK7B,SAAU6B,EAAKtF,YAAasF,EAAKoG,UAAYpG,EAAKoG,UAAU7B,QAAU,GAClIe,EAAeC,EAAcC,EAAWC,MAK5CiF,EAAKxO,KAAK,GAAIwM,GAAA1D,UAAUyF,EAAMxF,UAAW,GAAItF,OAAW,GAAI,KAGvDlI,EAAAE,WAAWmS,KAAKY,IAKjB9B,kBAAAhR,UAAAwS,qBAAR,SAA6BlF,EAAyBiF,GACtD,GAAIQ,GACAC,EAAeT,GAAQA,EAAK1F,QAAU,CAExC,IAAIS,GAAWA,EAAQT,QAAU,EAAG,CAClC,GAAIoG,GAAiBD,EACC3S,KAAKiR,YAAY4B,QAAQ,mBAAoB7S,KAAKoR,UAAUyB,QAAQ,kBAAmBX,IACrF,EAExBQ,GAAU1S,KAAKgR,oBACA6B,QAAQ,qBAAsB7S,KAAK8S,yBAAyB7F,IAC5D4F,QAAQ,2BAA4BD,GACpCC,QAAQ,yBAA0B7S,KAAKmR,qBAItDuB,GADSC,EACC3S,KAAKkR,MACE2B,QAAQ,mBAAoB7S,KAAKoR,UAAUyB,QAAQ,kBAAmBX,IACtEW,QAAQ,yBAA0B7S,KAAKmR,iBAE9C,oFAKV,OAAOnR,MAAK4Q,KAAKa,KAAKzR,KAAK6Q,OAAOjO,IAAI,aAAe,oCAAqC8P,GAAS9K,IAAI,SAAA2J,GAAO,MAAAA,GAAIvO,UAItH2N,kBAAAhR,UAAAoT,gBAAA,SAAgB/F,GACd,MAAOhN,MAAK4Q,KAAKhO,IAAI5C,KAAK6Q,OAAOjO,IAAI,aAAe,mBAAqBoK,GACtEpF,IAAI,SAAA2J,GAAO,MAAAA,GAAIvO,SACf4E,IAAI,SAAA2J,GAEH,OAASyB,MAASzB,EAAIyB,MAAOjS,OAAUwQ,EAAI0B,YAIjDtC,kBAAAhR,UAAAuT,2BAAA,SAA2BlG,EAAmB9G,GAA9C,GAAA4B,GAAA9H,IACE,OAAOA,MAAK+S,gBAAgB/F,GACzB2E,QACD,SAACJ,GAEC,GAAIA,EAAIyB,MAAO,CACb,GAAIA,MACAG,EAAsB5B,EAAIxQ,OAAOyG,MAAM4L,KAAK,SAAArL,GAAQ,MAAAA,GAAK7B,UAAYA,GAKzE,OAJIiN,IACFH,EAAM/O,MAAO+O,OAAS,EAAMxR,MAAS2R,IAEvCrL,EAAKgJ,OAAOuC,IAAI,kBAAoBL,GAC7BxT,EAAAE,WAAWmS,KAAKmB,GAIvB,MADAlL,GAAKgJ,OAAOlP,MAAM,mBACXpC,EAAAE,WAAWmS,OAAQmB,OAAS,EAAMxR,eAOzCmP,kBAAAhR,UAAA2T,QAAR,SAAgBd,GACd,GAAIC,KAaJ,OAXID,GAAMhL,MAAMgF,OAAS,GAEvBgG,EAAMhL,MAAMI,IAAI,SAAAG,GACVA,EAAKkF,SAAWlF,EAAKkF,QAAQT,OAAS,EAG1CiG,EAAKxO,KAAK,GAAIsM,GAAAxC,KAAKhG,EAAK7B,SAAU6B,EAAKiG,aAAcjG,EAAKtF,YAAasF,EAAKkF,QAASvF,OAAWA,OAAWK,EAAKoG,UAAWpG,EAAK2C,WAK7HlL,EAAAE,WAAWmS,KAAKY,IAGjB9B,kBAAAhR,UAAAmT,yBAAR,SAAiC7F,GAAjC,GAAAnF,GAAA9H,IACE,QAAKiN,GAAWA,EAAQT,QAAU,EACzB,GAGHS,EAAQrF,IAAI,SAAA2L,GAAU,MAAAzL,GAAKiJ,aAAa8B,QAAQ,kBAAmBU,KAASC,KAAK,MAGjF7C,kBAAAhR,UAAA8T,QAAR,SAAgB1S,EAAwB2S,GACtC,SAAK3S,GAA2B,GAAjBA,EAAOyL,SAAgBkH,GAA2B,GAAjBA,EAAOlH,SAIhDkH,EAAOC,KAAK,SAAAjF,GAAK,MAAA3N,GAAO6S,QAAQlF,KAAM,KAG/CiC,kBAAAhR,UAAAkU,mBAAA,SAAmB5G,EAAwB6G,GAA3C,GAAAhM,GAAA9H,IAA2C,UAAA8T,OAAA,GACzC9T,KAAK8Q,OAAOuC,IAAI,qCAAuCnQ,KAAK6Q,UAAU9G,GAEtE,IAAIyF,GAAU1S,KAAKgR,oBACF6B,QAAQ,qBAAsB7S,KAAK8S,yBAAyB7F,IAC5D4F,QAAQ,2BAA2B,IACnCA,QAAQ,yBAA0B7S,KAAKmR,iBAGpD6C,EAAWhU,KAAK4Q,KAAKa,KAAKzR,KAAK6Q,OAAOjO,IAAI,aAAe,oCAAqC8P,GAC/F9K,IAAI,SAAA2J,GAAO,MAAAA,GAAIvO,SACf2O,QAAQ3R,KAAKoS,QACbT,QAAQ3R,KAAKsT,QAUhB,OARIQ,KACFE,EAAWA,EAASF,OAAO,SAAA/L,GACzB,GAAIkM,GAAcnM,EAAK2L,QAAQ1L,EAAKkF,QAASA,EAE7C,OADAnF,GAAKgJ,OAAOoD,MAAM,oBAAsBnM,EAAKkF,QAAU,kBAAoBgH,GACpEA,KAIJD,EAASpU,OAAO,SAACyB,EAAKiR,GAAqB,MAAbjR,GAAI4C,KAAKqO,GAAWjR,GAAO,GAAIkR,SAGtE5B,kBAAAhR,UAAAwU,eAAA,SAAe3R,GAAf,GAAAsF,GAAA9H,IACEA,MAAK8Q,OAAOuC,IAAI,kBAAoB7Q,EACxB,IAAI8N,GAAAnH,QAAQ,GAAI,GAC5B,OAAOnJ,MAAKoU,YAAYzC,QACtB,SAAC1O,GACC,GAAI8E,GAAO4I,kBAAkB0D,cAAcpR,GAAMmQ,KAAK,SAAAkB,GACpD,MAAOA,GAAE9R,KAAK+R,gBAAkB/R,EAAOA,EAAKgS,oBAAsB,KAGpE,OADA1M,GAAKgJ,OAAOuC,IAAI,sBAAwBtL,GACpCA,EACKvI,EAAAE,WAAWiB,OAAO,SAAA8T,GAIvB,MAHAA,GAAS3S,KAAKiG,GACd0M,EAAS1S,WAEF,WAAM,MAAA+F,GAAKgJ,OAAOuC,IAAI,qBAGxB7T,EAAAE,WAAWiB,OAAO,SAAA8T,GAKvB,MAJAA,GAAS3S,KAAK,GAAIwO,GAAAnH,QAAQ,GAAI,KAC9BrB,EAAKgJ,OAAOuC,IAAI,oCAChBoB,EAAS1S,WAEF,WAAM,MAAA+F,GAAKgJ,OAAOuC,IAAI,4BAQvC1C,kBAAAhR,UAAAyU,UAAA,WACE,MAAOpU,MAAK4Q,KAAKhO,IAAI5C,KAAK6Q,OAAOjO,IAAI,aAAe,uCAAuCgF,IAAI,SAAA2J,GAAO,MAAAA,GAAIvO,UAG5G2N,kBAAAhR,UAAA+U,aAAA,WAEE,MADA1U,MAAK8Q,OAAOuC,IAAI,sBAAwBrT,KAAK6Q,OAAOjO,IAAI,cACjD5C,KAAK4Q,KAAKhO,IAAI5C,KAAK6Q,OAAOjO,IAAI,aAAe,0CAA0CgF,IAAI,SAAA2J,GAAO,MAAAA,GAAIvO,UAuD/G2N,kBAAAhR,UAAAgV,SAAA,SAASC,EAAa/O,EAAiBkC,GAAvC,GAAAD,GAAA9H,KACM6U,EAAU,GAAIxE,GAAAyE,SAAUC,eAAgB,qBACxCC,EAAU,GAAI3E,GAAA4E,gBAAiBJ,QAASA,IAExCnC,EAAkBxP,KAAK6Q,UAAUhM,EAAKtB,aAAamO,EAAK/O,GAE5D,OADA7F,MAAK8Q,OAAOuC,IAAI,oBAAsBX,GAC/B1S,KAAK4Q,KAAKsE,IAAIlV,KAAK6Q,OAAOjO,IAAI,cAAgB,WAAamF,EAAKiG,aAAe,UAAYjG,EAAK7B,SAAUwM,EAASsC,GAASpN,IAAI,SAAA2J,GAASzJ,EAAKgJ,OAAOuC,IAAI,cAAgB9B,EAAIvO,QAASuO,EAAIvO,UAGnM2N,kBAAAhR,UAAAwV,WAAA,SAAWP,EAAa/O,EAAiBkC,GAAzC,GAAAD,GAAA9H,KACM6U,EAAU,GAAIxE,GAAAyE,SAAUC,eAAgB,qBACxCC,EAAU,GAAI3E,GAAA4E,gBAAiBJ,QAASA,IAExCnC,EAAkBxP,KAAK6Q,UAAUhM,EAAKtB,aAAamO,EAAK/O,GAE5D,OADA7F,MAAK8Q,OAAOuC,IAAI,sBAAwBX,GACjC1S,KAAK4Q,KAAKa,KAAKzR,KAAK6Q,OAAOjO,IAAI,cAAgB,WAAamF,EAAKiG,aAAe,UAAYjG,EAAK7B,SAAUwM,EAASsC,GAASpN,IAAI,SAAA2J,GAASzJ,EAAKgJ,OAAOuC,IAAI,gBAAkB9B,EAAIvO,QAASuO,EAAIvO,UAGtM2N,kBAAAhR,UAAAyV,eAAA,SAAeC,GAAf,GAAAvN,GAAA9H,KACM6U,EAAU,GAAIxE,GAAAyE,SAAUC,eAAgB,qBACxCC,EAAU,GAAI3E,GAAA4E,gBAAiBJ,QAASA,IAExCnC,EAAkB1S,KAAKsV,mBAAmBD,EAE9C,OADArV,MAAK8Q,OAAOuC,IAAI,0BAA4BX,GACrC1S,KAAK4Q,KAAKsE,IAAIlV,KAAK6Q,OAAOjO,IAAI,cAAgB,2BAA6ByS,EAAW7S,KAAMkQ,EAASsC,GAASpN,IAAI,SAAA2J,GAASzJ,EAAKgJ,OAAOuC,IAAI,cAAgB9B,EAAIvO,QAASuO,EAAIvO,UAGrL2N,kBAAAhR,UAAA4V,iBAAA,SAAiBF,GAAjB,GAAAvN,GAAA9H,KACM6U,EAAU,GAAIxE,GAAAyE,SAAUC,eAAgB,qBACxCC,EAAU,GAAI3E,GAAA4E,gBAAiBJ,QAASA,IAExCnC,EAAkB1S,KAAKsV,mBAAmBD,EAE9C,OADArV,MAAK8Q,OAAOuC,IAAI,4BAA8BX,GACvC1S,KAAK4Q,KAAKa,KAAKzR,KAAK6Q,OAAOjO,IAAI,cAAgB,2BAA6ByS,EAAW7S,KAAMkQ,EAASsC,GAASpN,IAAI,SAAA2J,GAAwD,MAA/CzJ,GAAKgJ,OAAOuC,IAAI,gBAAkB9B,EAAIvO,QAAgBuO,EAAIvO,UAG/L2N,kBAAAhR,UAAA6V,OAAA,SAAOZ,EAAa/O,EAAiB4P,GAArC,GAAA3N,GAAA9H,KACM6U,EAAU,GAAIxE,GAAAyE,SAAUC,eAAgB,qBACxCC,EAAU,GAAI3E,GAAA4E,gBAAiBJ,QAASA,IAExCnC,EAAkBxP,KAAK6Q,WACzB2B,SAAU,UACVD,SAAUA,EACVb,IAAKA,EACL/O,QAASA,GAGX,OADA7F,MAAK8Q,OAAOuC,IAAI,wBAA0BX,GACnC1S,KAAK4Q,KAAKa,KAAKzR,KAAK6Q,OAAOjO,IAAI,cAAgB,kBAAmB8P,EAASsC,GAC/EpN,IAAI,SAAA2J,GAEH,MADAzJ,GAAKgJ,OAAOuC,IAAI,gBAAkB9B,EAAIvO,OAAO2S,UACtCpE,EAAIvO,UAKjB2N,kBAAAhR,UAAAiW,gBAAA,SAAgBH,GACd,MAAOzV,MAAK4Q,KAAKhO,IAAI5C,KAAK6Q,OAAOjO,IAAI,cAAgB,mBAAqB6S,GAAU7N,IAAI,SAAA2J,GAAO,MAAAA,GAAIvO,UAGrG2N,kBAAAhR,UAAAkW,OAAA,SAAOH,GAAP,GAAA5N,GAAA9H,KACM6U,EAAU,GAAIxE,GAAAyE,SAAUC,eAAgB,qBACxCC,EAAU,GAAI3E,GAAA4E,gBAAiBJ,QAASA,IAExCnC,EAAkBxP,KAAK6Q,WACzB2B,SAAUA,GAGZ,OADA1V,MAAK8Q,OAAOuC,IAAI,iBAAmBX,GAC5B1S,KAAK4Q,KAAKa,KAAKzR,KAAK6Q,OAAOjO,IAAI,cAAgB,kBAAmB8P,EAASsC,GAASpN,IAAI,SAAA2J,GAAwD,MAA/CzJ,GAAKgJ,OAAOuC,IAAI,gBAAkB9B,EAAIvO,QAAgBuO,EAAIvO,UAG5J2N,kBAAAhR,UAAA2V,mBAAR,SAA2BD,GAA3B,GAAAvN,GAAA9H,KAEMgI,GACF9B,SAAUmP,EAAWnP,SACrBb,SAAUgQ,EAAWhO,kBAAkB7E,KACvC8C,cAAe+P,EAAWhO,kBAAkBb,UAC5CpB,OAAQ6C,OAAOoN,EAAWjQ,QAC1BY,UAAWqP,EAAWrP,UACtBC,SAAUoP,EAAWpP,SACrBxD,YAAa4S,EAAW5S,YACxB+E,UAGEA,EAAQ6N,EAAW7N,SAMvB,OALAA,GAAM7D,QAAQ,SAAAoE,GACZ,GAAI+N,GAAiBhO,EAAKiO,iBAAiBV,EAAW7S,KAAMuF,EAC5DC,GAAcR,MAAMvD,KAAK6R,KAGpB5S,KAAK6Q,UAAU/L,IAehB2I,kBAAAhR,UAAAoW,iBAAR,SAAyBC,EAAqBC,GAG5C,MAFAjW,MAAK8Q,OAAOuC,IAAI,8BAAgC2C,EAAc,4BAA8BC,EAAe/P,SACvG,wBAA0B+P,EAAezT,KAAO,6BAA+ByT,EAAejQ,UAAY,4BAA8BiQ,EAAehQ,WAEzJzD,KAAMwT,EACN9P,SAAU+P,EAAe/P,SACzBT,SAAUwQ,EAAezT,KACzBwD,UAAWiQ,EAAejQ,UAC1BC,SAAUgQ,EAAehQ,WAItB0K,kBAAA0D,cAAP,SAAqBpR,GACnB,GAAIiT,GAAWjT,EAAW,KAAE6O,KACxBqE,EAAOD,EAAStO,IAAI,SAAAwO,GAAK,MAAAA,GAAEnD,SAC/B,OAAOkD,IAGDxF,kBAAAhR,UAAAyS,OAAR,SAAeiE,GACb,MAAO7W,GAAAE,WAAWmS,KAAKwE,EAAY,KAAEvE,MAClClK,IAAI,SAAAmK,GAAO,MAAAA,GAAa,WAIrBpB,kBAAAhR,UAAA2W,YAAR,SAAoBD,GAClB,GAAIE,GAAYF,EAAMvE,KAAK0E,KAE3B,IAAID,EAAY,EAAG,CACjB,GAAIzE,GAAOuE,EAAY,KAAEvE,KAAKlK,IAAI,SAAAmK,GAAO,MAAAA,GAAa,SAEtD,OAAOvS,GAAAE,WAAWmS,OAAQmB,OAAS,EAAMlB,KAAQA,KAGjD,MAAOtS,GAAAE,WAAWmS,OAAQmB,OAAS,EAAOlB,YAI9CnB,kBAAAhR,UAAA8W,YAAA,WAEE,MADAzW,MAAK8Q,OAAOuC,IAAI,qBAAuBrT,KAAK6Q,OAAOjO,IAAI,cAChD5C,KAAK4Q,KAAKhO,IAAI5C,KAAK6Q,OAAOjO,IAAI,aAAe,sCACjDgF,IAAI,SAAA2J,GAAO,MAAAA,GAAIvO,SACf2O,QAAQ3R,KAAKsW,aACb1O,IAAI,SAAAuO,GAAU,MAAOA,GAAKrE,KAAKlK,IAAI,SAAAmK,GAAS,MAAO,IAAIrB,GAAApO,OAAO,EAAGyP,EAAU,KAAGA,EAAU,WAviB/FpB,kBAAAlB,YAACL,EAAAsH,arC68CQvG,WAAW,qBAAsBE,EAAOsG,KAAMnG,EAAWoG,OAAQpG,EAAWqG,UAC7ElG,qBqC78CKrR,GAAAqR,kBAAiBA,GrCq9CxBmG,KACA,SAASzX,EAAQC,EAASC,GsCl+ChCF,EAAAC,QAAA,SAAAiP,GACA,UAAAC,SAAA,SAAAC,GACAlP,EAAAmP,EAAA,WAAAC,GACA,GAAAJ,EACAE,EAAAlP,EAAA,MAAAgP,QACO,CACP,GAAAK,GAAArP,EAAA,KACAkP,GAAAG,EAAAC,WAAAD,EAAAE,QAAAF","file":"1.c2d024fea936b7873685.chunk.js","sourcesContent":["webpackJsonp([1],{\n\n/***/ 904:\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\tvar Observable_1 = __webpack_require__(14);\n\tvar reduce_1 = __webpack_require__(922);\n\tObservable_1.Observable.prototype.reduce = reduce_1.reduce;\n\t//# sourceMappingURL=reduce.js.map\n\n/***/ },\n\n/***/ 922:\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\tvar __extends = (this && this.__extends) || function (d, b) {\n\t    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n\t    function __() { this.constructor = d; }\n\t    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n\t};\n\tvar Subscriber_1 = __webpack_require__(70);\n\t/**\n\t * Returns an Observable that applies a specified accumulator function to the first item emitted by a source Observable,\n\t * then feeds the result of that function along with the second item emitted by the source Observable into the same\n\t * function, and so on until all items have been emitted by the source Observable, and emits the final result from\n\t * the final call to your function as its sole item.\n\t * This technique, which is called \"reduce\" here, is sometimes called \"aggregate,\" \"fold,\" \"accumulate,\" \"compress,\" or\n\t * \"inject\" in other programming contexts.\n\t *\n\t * <img src=\"./img/reduce.png\" width=\"100%\">\n\t *\n\t * @param {initialValue} the initial (seed) accumulator value\n\t * @param {accumulator} an accumulator function to be invoked on each item emitted by the source Observable, the\n\t * result of which will be used in the next accumulator call.\n\t * @return {Observable} an Observable that emits a single item that is the result of accumulating the output from the\n\t * items emitted by the source Observable.\n\t * @method reduce\n\t * @owner Observable\n\t */\n\tfunction reduce(project, seed) {\n\t    return this.lift(new ReduceOperator(project, seed));\n\t}\n\texports.reduce = reduce;\n\tvar ReduceOperator = (function () {\n\t    function ReduceOperator(project, seed) {\n\t        this.project = project;\n\t        this.seed = seed;\n\t    }\n\t    ReduceOperator.prototype.call = function (subscriber, source) {\n\t        return source._subscribe(new ReduceSubscriber(subscriber, this.project, this.seed));\n\t    };\n\t    return ReduceOperator;\n\t}());\n\texports.ReduceOperator = ReduceOperator;\n\t/**\n\t * We need this JSDoc comment for affecting ESDoc.\n\t * @ignore\n\t * @extends {Ignored}\n\t */\n\tvar ReduceSubscriber = (function (_super) {\n\t    __extends(ReduceSubscriber, _super);\n\t    function ReduceSubscriber(destination, project, seed) {\n\t        _super.call(this, destination);\n\t        this.hasValue = false;\n\t        this.acc = seed;\n\t        this.project = project;\n\t        this.hasSeed = typeof seed !== 'undefined';\n\t    }\n\t    ReduceSubscriber.prototype._next = function (value) {\n\t        if (this.hasValue || (this.hasValue = this.hasSeed)) {\n\t            this._tryReduce(value);\n\t        }\n\t        else {\n\t            this.acc = value;\n\t            this.hasValue = true;\n\t        }\n\t    };\n\t    ReduceSubscriber.prototype._tryReduce = function (value) {\n\t        var result;\n\t        try {\n\t            result = this.project(this.acc, value);\n\t        }\n\t        catch (err) {\n\t            this.destination.error(err);\n\t            return;\n\t        }\n\t        this.acc = result;\n\t    };\n\t    ReduceSubscriber.prototype._complete = function () {\n\t        if (this.hasValue || this.hasSeed) {\n\t            this.destination.next(this.acc);\n\t        }\n\t        this.destination.complete();\n\t    };\n\t    return ReduceSubscriber;\n\t}(Subscriber_1.Subscriber));\n\texports.ReduceSubscriber = ReduceSubscriber;\n\t//# sourceMappingURL=reduce.js.map\n\n/***/ },\n\n/***/ 888:\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tfunction __export(m) {\r\n\t    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n\t}\r\n\t__export(__webpack_require__(1153));\r\n\n\n/***/ },\n\n/***/ 926:\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tfunction __export(m) {\r\n\t    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n\t}\r\n\t__export(__webpack_require__(1167));\r\n\n\n/***/ },\n\n/***/ 1167:\n/***/ function(module, exports) {\n\n\t\"use strict\";\r\n\tvar Option = (function () {\r\n\t    function Option(id, code, description, selected) {\r\n\t        if (selected === void 0) { selected = false; }\r\n\t        this.code = code;\r\n\t        this.id = id;\r\n\t        this.description = description;\r\n\t        this.selected = selected;\r\n\t    }\r\n\t    Object.defineProperty(Option.prototype, \"htmlText\", {\r\n\t        get: function () { return this.description; },\r\n\t        enumerable: true,\r\n\t        configurable: true\r\n\t    });\r\n\t    Option.fromJson = function (json) {\r\n\t        var data = JSON.parse(json);\r\n\t        return new Option(data.id, data.code, data.description);\r\n\t    };\r\n\t    Option.mapToProperty = function (option) { return option[\"id\"]; };\r\n\t    return Option;\r\n\t}());\r\n\texports.Option = Option;\r\n\n\n/***/ },\n\n/***/ 1153:\n/***/ function(module, exports) {\n\n\t\"use strict\";\r\n\tvar ItemContainer = (function () {\r\n\t    function ItemContainer(id, description) {\r\n\t        this.id = id;\r\n\t        this.description = description;\r\n\t        this.children = [];\r\n\t    }\r\n\t    Object.defineProperty(ItemContainer.prototype, \"htmlText\", {\r\n\t        get: function () { return this.description; },\r\n\t        enumerable: true,\r\n\t        configurable: true\r\n\t    });\r\n\t    ItemContainer.prototype.addChild = function (child) {\r\n\t        this.children.push(child);\r\n\t    };\r\n\t    return ItemContainer;\r\n\t}());\r\n\texports.ItemContainer = ItemContainer;\r\n\tvar ItemChild = (function () {\r\n\t    function ItemChild(id, description) {\r\n\t        this.id = id;\r\n\t        this.description = description;\r\n\t    }\r\n\t    Object.defineProperty(ItemChild.prototype, \"htmlText\", {\r\n\t        get: function () { return this.description; },\r\n\t        enumerable: true,\r\n\t        configurable: true\r\n\t    });\r\n\t    return ItemChild;\r\n\t}());\r\n\texports.ItemChild = ItemChild;\r\n\tvar IdCodeDescription = (function () {\r\n\t    function IdCodeDescription(id, code, description) {\r\n\t        this.id = id;\r\n\t        this.code = code;\r\n\t        this.description = description;\r\n\t    }\r\n\t    Object.defineProperty(IdCodeDescription.prototype, \"htmlText\", {\r\n\t        get: function () { return this.description; },\r\n\t        enumerable: true,\r\n\t        configurable: true\r\n\t    });\r\n\t    IdCodeDescription.fromJson = function (json) {\r\n\t        var data = JSON.parse(json);\r\n\t        return new IdCodeDescription(data.id, data.code, data.description);\r\n\t    };\r\n\t    IdCodeDescription.empty = function () {\r\n\t        return new IdCodeDescription(1, \"\", \"\");\r\n\t    };\r\n\t    IdCodeDescription.mapToProperty = function (option) { return option[\"code\"]; };\r\n\t    return IdCodeDescription;\r\n\t}());\r\n\texports.IdCodeDescription = IdCodeDescription;\r\n\tfunction updateFields(dest, orig, fields) {\r\n\t    fields.forEach(function (f) { return dest[f] = orig[f] || dest[f]; });\r\n\t}\r\n\texports.updateFields = updateFields;\r\n\n\n/***/ },\n\n/***/ 1168:\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tvar assignment_type_model_ts_1 = __webpack_require__(886);\r\n\tvar AssignmentConfig = (function () {\r\n\t    function AssignmentConfig(type, maxBackendsAllowed) {\r\n\t        this.type = type;\r\n\t        this.maxBackendsAllowed = this.calculeMaxBackendsAllowed(type, maxBackendsAllowed);\r\n\t    }\r\n\t    AssignmentConfig.prototype.calculeMaxBackendsAllowed = function (type, maxBackendsAllowed) {\r\n\t        if (maxBackendsAllowed) {\r\n\t            return maxBackendsAllowed;\r\n\t        }\r\n\t        switch (type) {\r\n\t            case assignment_type_model_ts_1.AssignType.BK_CHANNEL:\r\n\t                return 1;\r\n\t            case assignment_type_model_ts_1.AssignType.DTN_COPY:\r\n\t            case assignment_type_model_ts_1.AssignType.FEED_DTN_COPY:\r\n\t                return 1000;\r\n\t        }\r\n\t    };\r\n\t    AssignmentConfig.prototype.isTypeDifferent = function (type) {\r\n\t        return type != assignment_type_model_ts_1.AssignType[this.type];\r\n\t    };\r\n\t    AssignmentConfig.prototype.typeAsString = function () {\r\n\t        return assignment_type_model_ts_1.AssignType[this.type];\r\n\t    };\r\n\t    AssignmentConfig.prototype.showExtraFields = function () {\r\n\t        switch (this.type) {\r\n\t            case assignment_type_model_ts_1.AssignType.BK_CHANNEL:\r\n\t                return false;\r\n\t            case assignment_type_model_ts_1.AssignType.DTN_COPY:\r\n\t            case assignment_type_model_ts_1.AssignType.FEED_DTN_COPY:\r\n\t                return true;\r\n\t        }\r\n\t    };\r\n\t    return AssignmentConfig;\r\n\t}());\r\n\texports.AssignmentConfig = AssignmentConfig;\r\n\n\n/***/ },\n\n/***/ 1169:\n/***/ function(module, exports) {\n\n\t\"use strict\";\r\n\tvar AssignmentList = (function () {\r\n\t    function AssignmentList(active, code, backCode, backDirection, backName, backSequence, ruleCode, ruleExpressions, ruleSequence, environment, version) {\r\n\t        this.active = active;\r\n\t        this.code = code;\r\n\t        this.backCode = backCode;\r\n\t        this.backDirection = backDirection;\r\n\t        this.backName = backName;\r\n\t        this.backSequence = backSequence;\r\n\t        this.ruleCode = ruleCode;\r\n\t        this.ruleExpressions = ruleExpressions;\r\n\t        this.ruleSequence = ruleSequence;\r\n\t        this.environment = environment;\r\n\t        this.version = version;\r\n\t    }\r\n\t    return AssignmentList;\r\n\t}());\r\n\texports.AssignmentList = AssignmentList;\r\n\n\n/***/ },\n\n/***/ 1170:\n/***/ function(module, exports) {\n\n\t\"use strict\";\r\n\tvar AssignmentRule = (function () {\r\n\t    function AssignmentRule(code, dataOwner, lockCode, sequence, environment, version, expression) {\r\n\t        this.code = code;\r\n\t        this.dataOwner = dataOwner;\r\n\t        this.lockCode = lockCode;\r\n\t        this.sequence = sequence;\r\n\t        this.environment = environment;\r\n\t        this.version = version;\r\n\t        this.expression = expression;\r\n\t    }\r\n\t    return AssignmentRule;\r\n\t}());\r\n\texports.AssignmentRule = AssignmentRule;\r\n\n\n/***/ },\n\n/***/ 886:\n/***/ function(module, exports) {\n\n\t\"use strict\";\r\n\t(function (AssignType) {\r\n\t    AssignType[AssignType[\"BK_CHANNEL\"] = 1] = \"BK_CHANNEL\";\r\n\t    AssignType[AssignType[\"DTN_COPY\"] = 2] = \"DTN_COPY\";\r\n\t    AssignType[AssignType[\"FEED_DTN_COPY\"] = 4] = \"FEED_DTN_COPY\";\r\n\t})(exports.AssignType || (exports.AssignType = {}));\r\n\tvar AssignType = exports.AssignType;\r\n\n\n/***/ },\n\n/***/ 1130:\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tvar assignment_type_model_1 = __webpack_require__(886);\r\n\tvar AssignmentUniqueBackend = (function () {\r\n\t    function AssignmentUniqueBackend(code, direction, dataOwner, lockCode) {\r\n\t        this.code = code;\r\n\t        this.direction = direction;\r\n\t        this.dataOwner = dataOwner;\r\n\t        this.lockCode = lockCode;\r\n\t    }\r\n\t    AssignmentUniqueBackend.prototype.toWriteModel = function (type, assignmentCode, environment, version, modificationUserId, modificationDate, creationUserId, creationDate) {\r\n\t        switch (type) {\r\n\t            case assignment_type_model_1.AssignType.DTN_COPY:\r\n\t            case assignment_type_model_1.AssignType.FEED_DTN_COPY:\r\n\t                return {\r\n\t                    code: assignmentCode,\r\n\t                    backCode: this.code,\r\n\t                    backDirection: this.direction,\r\n\t                    dataOwner: this.dataOwner,\r\n\t                    lockCode: this.lockCode,\r\n\t                    environment: environment,\r\n\t                    version: version,\r\n\t                    modificationUserId: modificationUserId,\r\n\t                    modificationDate: modificationDate,\r\n\t                    creationUserId: creationUserId,\r\n\t                    creationDate: creationDate\r\n\t                };\r\n\t            default:\r\n\t                return {};\r\n\t        }\r\n\t    };\r\n\t    AssignmentUniqueBackend.fromJson = function (json) {\r\n\t        return new AssignmentUniqueBackend(json.code, json.direction, json.dataOwner, json.lockCode);\r\n\t    };\r\n\t    return AssignmentUniqueBackend;\r\n\t}());\r\n\texports.AssignmentUniqueBackend = AssignmentUniqueBackend;\r\n\n\n/***/ },\n\n/***/ 1131:\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tvar assignment_type_model_1 = __webpack_require__(886);\r\n\tvar AssignmentUniqueRule = (function () {\r\n\t    function AssignmentUniqueRule(code, dataOwner, lockCode, sequence, expression) {\r\n\t        this.code = code;\r\n\t        this.dataOwner = dataOwner;\r\n\t        this.lockCode = lockCode;\r\n\t        this.sequence = sequence;\r\n\t        this.expression = expression;\r\n\t    }\r\n\t    AssignmentUniqueRule.prototype.toWriteModel = function (type, assignmentCode, environment, version, modificationUserId, modificationDate, creationUserId, creationDate) {\r\n\t        switch (type) {\r\n\t            case assignment_type_model_1.AssignType.BK_CHANNEL:\r\n\t            case assignment_type_model_1.AssignType.DTN_COPY:\r\n\t            case assignment_type_model_1.AssignType.FEED_DTN_COPY:\r\n\t                return {\r\n\t                    code: assignmentCode,\r\n\t                    sequence: this.sequence,\r\n\t                    ruleCode: this.code,\r\n\t                    dataOwner: this.dataOwner,\r\n\t                    lockCode: this.lockCode,\r\n\t                    environment: environment,\r\n\t                    version: version,\r\n\t                    modificationUserId: modificationUserId,\r\n\t                    modificationDate: modificationDate,\r\n\t                    creationUserId: creationUserId,\r\n\t                    creationDate: creationDate\r\n\t                };\r\n\t        }\r\n\t    };\r\n\t    AssignmentUniqueRule.fromJson = function (json) {\r\n\t        return new AssignmentUniqueRule(json.code, json.dataOwner, json.lockCode, json.sequence, json.expression);\r\n\t    };\r\n\t    return AssignmentUniqueRule;\r\n\t}());\r\n\texports.AssignmentUniqueRule = AssignmentUniqueRule;\r\n\n\n/***/ },\n\n/***/ 1171:\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tvar assignment_unique_backend_model_1 = __webpack_require__(1130);\r\n\tvar assignment_unique_rule_model_1 = __webpack_require__(1131);\r\n\tvar assignment_type_model_1 = __webpack_require__(886);\r\n\tvar AssignmentUnique = (function () {\r\n\t    function AssignmentUnique(active, backendPrimaryKey, code, dataOwner, description, lockCode, sequence, copies, name, environment, version, rules, backends) {\r\n\t        this.active = active;\r\n\t        this.backendPrimaryKey = backendPrimaryKey;\r\n\t        this.code = code;\r\n\t        this.dataOwner = dataOwner;\r\n\t        this.description = description;\r\n\t        this.lockCode = lockCode;\r\n\t        this.sequence = sequence || undefined;\r\n\t        this.copies = copies || undefined;\r\n\t        this.name = name;\r\n\t        this.environment = environment;\r\n\t        this.version = version;\r\n\t        this.rules = rules || [];\r\n\t        this.backends = backends || [];\r\n\t    }\r\n\t    AssignmentUnique.prototype.backendCodeList = function () {\r\n\t        return this.backendPrimaryKey ? [this.backendPrimaryKey.code] : this.backends.map(function (backend) { return backend.code; });\r\n\t    };\r\n\t    AssignmentUnique.prototype.toWriteModel = function (type, environment, version, modificationUserId, modificationDate, creationUserId, creationDate) {\r\n\t        var _this = this;\r\n\t        var rules = this.rules || [];\r\n\t        rules = rules.map(function (rule) { return rule.toWriteModel(type, _this.code, environment, version, modificationUserId, modificationDate, creationUserId, creationDate); });\r\n\t        var backends = this.backends || [];\r\n\t        backends = backends.map(function (backend) { return backend.toWriteModel(type, _this.code, environment, version, modificationUserId, modificationDate, creationUserId, creationDate); });\r\n\t        var writeModelObj = {\r\n\t            sequence: this.sequence,\r\n\t            active: String(this.active),\r\n\t            dataOwner: this.dataOwner,\r\n\t            lockCode: this.lockCode,\r\n\t            description: this.description,\r\n\t            environment: environment,\r\n\t            version: version,\r\n\t            rules: rules,\r\n\t            modificationUserId: modificationUserId,\r\n\t            modificationDate: modificationDate,\r\n\t            creationUserId: creationUserId,\r\n\t            creationDate: creationDate\r\n\t        };\r\n\t        switch (type) {\r\n\t            case assignment_type_model_1.AssignType.BK_CHANNEL:\r\n\t                writeModelObj[\"backCode\"] = this.backendPrimaryKey.code;\r\n\t                writeModelObj[\"backDirection\"] = this.backendPrimaryKey.direction;\r\n\t                break;\r\n\t            case assignment_type_model_1.AssignType.DTN_COPY:\r\n\t            case assignment_type_model_1.AssignType.FEED_DTN_COPY:\r\n\t                writeModelObj[\"copies\"] = this.copies;\r\n\t                writeModelObj[\"name\"] = this.name;\r\n\t                writeModelObj[\"backends\"] = backends;\r\n\t                break;\r\n\t        }\r\n\t        return writeModelObj;\r\n\t    };\r\n\t    AssignmentUnique.fromJson = function (json) {\r\n\t        var rules = json.rules || [];\r\n\t        var backends = json.backends || [];\r\n\t        return new AssignmentUnique(json.active, json.backendPrimaryKey, json.code, json.dataOwner, json.description, json.lockCode, json.sequence, json.copies, json.name, json.environment, json.version, rules.map(function (rule) { return assignment_unique_rule_model_1.AssignmentUniqueRule.fromJson(rule); }), backends.map(function (backend) { return assignment_unique_backend_model_1.AssignmentUniqueBackend.fromJson(backend); }));\r\n\t    };\r\n\t    return AssignmentUnique;\r\n\t}());\r\n\texports.AssignmentUnique = AssignmentUnique;\r\n\n\n/***/ },\n\n/***/ 1172:\n/***/ function(module, exports) {\n\n\t\"use strict\";\r\n\tvar Assignment = (function () {\r\n\t    function Assignment(active, backendPrimaryKey, code, dataOwner, description, lockCode, sequence, environment, version, rules) {\r\n\t        this.active = active;\r\n\t        this.backendPrimaryKey = backendPrimaryKey;\r\n\t        this.code = code;\r\n\t        this.dataOwner = dataOwner;\r\n\t        this.description = description;\r\n\t        this.lockCode = lockCode;\r\n\t        this.sequence = sequence;\r\n\t        this.environment = environment;\r\n\t        this.version = version;\r\n\t        this.rules = rules || [];\r\n\t    }\r\n\t    return Assignment;\r\n\t}());\r\n\texports.Assignment = Assignment;\r\n\n\n/***/ },\n\n/***/ 1173:\n/***/ function(module, exports) {\n\n\t\"use strict\";\r\n\tvar BackendPK = (function () {\r\n\t    function BackendPK(code, direction) {\r\n\t        this.code = code;\r\n\t        this.direction = direction;\r\n\t    }\r\n\t    BackendPK.hashPK = function (pk) {\r\n\t        return pk.code.toString() + \"@\" + pk.direction.toString();\r\n\t    };\r\n\t    BackendPK.hash = function (code, direction) {\r\n\t        return code.toString() + \"@\" + direction.toString();\r\n\t    };\r\n\t    return BackendPK;\r\n\t}());\r\n\texports.BackendPK = BackendPK;\r\n\n\n/***/ },\n\n/***/ 1174:\n/***/ function(module, exports) {\n\n\t\"use strict\";\r\n\tvar Backend = (function () {\r\n\t    function Backend(pkCode, pkDirection, code, dataOwner, description, lockCode, name) {\r\n\t        this.pkCode = pkCode;\r\n\t        this.pkDirection = pkDirection;\r\n\t        this.code = code;\r\n\t        this.dataOwner = dataOwner;\r\n\t        this.description = description;\r\n\t        this.lockCode = lockCode;\r\n\t        this.name = name;\r\n\t    }\r\n\t    return Backend;\r\n\t}());\r\n\texports.Backend = Backend;\r\n\n\n/***/ },\n\n/***/ 880:\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tfunction __export(m) {\r\n\t    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n\t}\r\n\t__export(__webpack_require__(1170));\r\n\t__export(__webpack_require__(1172));\r\n\t__export(__webpack_require__(1169));\r\n\t__export(__webpack_require__(1173));\r\n\t__export(__webpack_require__(1174));\r\n\t__export(__webpack_require__(1176));\r\n\t__export(__webpack_require__(1171));\r\n\t__export(__webpack_require__(1131));\r\n\t__export(__webpack_require__(1130));\r\n\t__export(__webpack_require__(886));\r\n\t__export(__webpack_require__(1168));\r\n\t__export(__webpack_require__(1175));\r\n\n\n/***/ },\n\n/***/ 1175:\n/***/ function(module, exports) {\n\n\t\"use strict\";\r\n\t(function (RuleAssignType) {\r\n\t    RuleAssignType[RuleAssignType[\"ALL\"] = 1] = \"ALL\";\r\n\t    RuleAssignType[RuleAssignType[\"ASSIGNED\"] = 2] = \"ASSIGNED\";\r\n\t    RuleAssignType[RuleAssignType[\"UNASSIGNED\"] = 4] = \"UNASSIGNED\";\r\n\t})(exports.RuleAssignType || (exports.RuleAssignType = {}));\r\n\tvar RuleAssignType = exports.RuleAssignType;\r\n\n\n/***/ },\n\n/***/ 1176:\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tvar audit_1 = __webpack_require__(542);\r\n\tvar AMHRule = (function (_super) {\r\n\t    __extends(AMHRule, _super);\r\n\t    function AMHRule(code, expression, dataOwner, lockCode, type, environment, version) {\r\n\t        _super.call(this);\r\n\t        //UI fields\r\n\t        this.selected = false;\r\n\t        this.code = code;\r\n\t        this.dataOwner = dataOwner;\r\n\t        this.expression = expression;\r\n\t        this.lockCode = lockCode;\r\n\t        this.type = type;\r\n\t    }\r\n\t    AMHRule.prototype.toWriteModel = function () {\r\n\t        return {\r\n\t            expression: this.expression,\r\n\t            dataOwner: this.dataOwner,\r\n\t            lockCode: this.lockCode,\r\n\t            ruleType: this.type,\r\n\t            environment: this.environment,\r\n\t            version: this.version,\r\n\t            modificationUserId: this.modificationUserId,\r\n\t            modificationDate: this.modificationDate,\r\n\t            creationUserId: this.creationUserId,\r\n\t            creationDate: this.creationDate\r\n\t        };\r\n\t    };\r\n\t    ;\r\n\t    AMHRule.prototype.setEnvAndVersion = function (environment, version) {\r\n\t        this.environment = environment;\r\n\t        this.version = version;\r\n\t    };\r\n\t    AMHRule.prototype.cloneWithUpperCaseCode = function () {\r\n\t        return new AMHRule(this.code.toUpperCase(), this.expression, this.dataOwner, this.lockCode, this.type, this.environment, this.version);\r\n\t    };\r\n\t    AMHRule.fromJson = function (json) {\r\n\t        return new AMHRule(json.code, json.expression, json.dataOwner, json.lockCode, json.type, json.environment, json.version);\r\n\t    };\r\n\t    return AMHRule;\r\n\t}(audit_1.BaseAudit));\r\n\texports.AMHRule = AMHRule;\r\n\n\n/***/ },\n\n/***/ 1200:\n/***/ function(module, exports) {\n\n\t\"use strict\";\r\n\t(function (ActionOn) {\r\n\t    ActionOn[ActionOn[\"Source\"] = 1] = \"Source\";\r\n\t    ActionOn[ActionOn[\"NewInstance\"] = 2] = \"NewInstance\";\r\n\t    ActionOn[ActionOn[\"SourceAndNewInstance\"] = 4] = \"SourceAndNewInstance\";\r\n\t})(exports.ActionOn || (exports.ActionOn = {}));\r\n\tvar ActionOn = exports.ActionOn;\r\n\n\n/***/ },\n\n/***/ 1183:\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tvar referential_1 = __webpack_require__(888);\r\n\tvar source_model_1 = __webpack_require__(1179);\r\n\tvar new_instance_model_1 = __webpack_require__(1186);\r\n\tvar Action = (function () {\r\n\t    //   constructor();\r\n\t    function Action(actionOn, source, newInstance) {\r\n\t        this.actionOn = actionOn;\r\n\t        this.source = source;\r\n\t        this.newInstance = newInstance;\r\n\t    }\r\n\t    Action.empty = function () {\r\n\t        return new Action(referential_1.IdCodeDescription.empty(), source_model_1.Source.empty(), new_instance_model_1.NewInstance.empty());\r\n\t    };\r\n\t    Action.prototype.update = function (that) {\r\n\t        // this.actionOn = that.actionOn || this.actionOn;\r\n\t        // this.source = that.source || this.source;\r\n\t        // this.newInstance = that.newInstance || this.newInstance;\r\n\t        Action.updateField(that, [\"actionOn\", \"source\", \"newInstance\"], this);\r\n\t    };\r\n\t    Action.prototype.toWriteModel = function () {\r\n\t        /*\r\n\t      \"action\": {\r\n\t        \"actionOn\": \"SOURCE\",\r\n\t        \"instanceAction\": \"ACTION_TYPE_COMPLETE\",\r\n\t        \"instanceInterventionType\": \"INTV_NO_INTV\",\r\n\t        \"instanceInterventionTypeText\": null,\r\n\t        \"instanceRoutingCode\": \"IFR-S\",\r\n\t        \"instanceTargetQueue\": null,\r\n\t        \"instanceUnit\": null,\r\n\t        \"instancePriority\": null,\r\n\t        \"newInstanceAction\": null,\r\n\t        \"newInstanceRoutingCode\": null,\r\n\t        \"newInstanceInterventionType\": null,\r\n\t        \"newInstanceInterventionTypeText\": null,\r\n\t        \"newInstanceTargetQueue\": null,\r\n\t        \"newInstanceType\": null,\r\n\t        \"newInstanceUnit\": null,\r\n\t        \"newInstancePriority\": null\r\n\t      },\r\n\t      \"condition\":{\r\n\t        \"conditionOn\": \"MESSAGE\",\r\n\t          \"criteria\": \"(Sender = 'PARBFRPP') and (SibesBranchCodeE = 'XXX') and (SibesFlux like '&PS%') and (SibesService like '0243%,0246%,4678%,9881%')\",\r\n\t          \"functionList\": null\r\n\t      }\r\n\t     */\r\n\t        var actionOn = this.actionOn.id == 1 ? \"SOURCE\" : this.actionOn.id == 2 ? \"NEW_INSTANCE\" : \"SOURCE_AND_NEW_INSTANCE\";\r\n\t        var instanceType = this.newInstance.instanceType + (this.newInstance.instanceTypeOption ? \"_\" + this.newInstance.instanceTypeOption : \"\");\r\n\t        return {\r\n\t            \"actionOn\": actionOn,\r\n\t            \"instanceAction\": this.source.action,\r\n\t            \"instanceInterventionType\": this.source.intervention,\r\n\t            \"instanceInterventionTypeText\": this.source.interventionText,\r\n\t            \"instanceRoutingCode\": this.source.routingCode,\r\n\t            \"instanceTargetQueue\": this.source.actionOption,\r\n\t            \"instanceUnit\": this.source.unit,\r\n\t            \"instancePriority\": this.source.priority,\r\n\t            \"newInstanceAction\": this.newInstance.action,\r\n\t            \"newInstanceRoutingCode\": this.newInstance.routingCode,\r\n\t            \"newInstanceInterventionType\": this.newInstance.intervention,\r\n\t            \"newInstanceInterventionTypeText\": this.newInstance.interventionText,\r\n\t            \"newInstanceTargetQueue\": this.newInstance.actionOption,\r\n\t            \"newInstanceType\": instanceType,\r\n\t            \"newInstanceUnit\": this.newInstance.unit,\r\n\t            \"newInstancePriority\": this.newInstance.priority\r\n\t        };\r\n\t    };\r\n\t    Action.updateField = function (orig, fields, dest) {\r\n\t        fields.forEach(function (f) { return dest[f] = orig[f] || dest[f]; });\r\n\t    };\r\n\t    return Action;\r\n\t}());\r\n\texports.Action = Action;\r\n\n\n/***/ },\n\n/***/ 1201:\n/***/ function(module, exports) {\n\n\t\"use strict\";\r\n\t(function (ConditionType) {\r\n\t    ConditionType[ConditionType[\"MESSAGE\"] = 1] = \"MESSAGE\";\r\n\t    ConditionType[ConditionType[\"FUNCTION\"] = 2] = \"FUNCTION\";\r\n\t    ConditionType[ConditionType[\"MESSAGEANDFUNCTION\"] = 4] = \"MESSAGEANDFUNCTION\";\r\n\t    ConditionType[ConditionType[\"ALWAYS\"] = 8] = \"ALWAYS\";\r\n\t})(exports.ConditionType || (exports.ConditionType = {}));\r\n\tvar ConditionType = exports.ConditionType;\r\n\n\n/***/ },\n\n/***/ 1184:\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tvar referential_1 = __webpack_require__(888);\r\n\tvar referential_2 = __webpack_require__(888);\r\n\tvar Condition = (function () {\r\n\t    function Condition(conditionOn, functions, message) {\r\n\t        this.conditionOn = conditionOn;\r\n\t        this.functions = functions;\r\n\t        this.message = message;\r\n\t    }\r\n\t    Condition.empty = function () {\r\n\t        return new Condition(referential_1.IdCodeDescription.empty(), [], \"\");\r\n\t    };\r\n\t    Condition.prototype.update = function (that) {\r\n\t        referential_2.updateFields(this, that, [\"conditionOn\", \"functions\", \"message\"]);\r\n\t    };\r\n\t    Condition.prototype.toWriteModel = function () {\r\n\t        var functionsWriteModel = undefined;\r\n\t        if (this.functions && this.functions.length > 0) {\r\n\t            functionsWriteModel = this.functions.reduce(function (acc, cur) {\r\n\t                return acc.length > 0 ? acc + \",\" + cur.description : cur.description;\r\n\t            }, \"\");\r\n\t        }\r\n\t        var conditionOn = this.conditionOn.id == 1 ? \"MESSAGE\" : this.conditionOn.id == 2 ? \"FUNCTION\" : \"MESSAGE_AND_FUNCTION\";\r\n\t        return {\r\n\t            \"conditionOn\": conditionOn,\r\n\t            \"criteria\": this.conditionOn.id != 2 ? this.message : \"\",\r\n\t            \"functionList\": this.conditionOn.id != 1 ? functionsWriteModel : \"\"\r\n\t        };\r\n\t    };\r\n\t    return Condition;\r\n\t}());\r\n\texports.Condition = Condition;\r\n\n\n/***/ },\n\n/***/ 1185:\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tfunction __export(m) {\r\n\t    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n\t}\r\n\t__export(__webpack_require__(1200));\r\n\t__export(__webpack_require__(1183));\r\n\t__export(__webpack_require__(1201));\r\n\t__export(__webpack_require__(1184));\r\n\t__export(__webpack_require__(1186));\r\n\t__export(__webpack_require__(1204));\r\n\t__export(__webpack_require__(1179));\r\n\t__export(__webpack_require__(1203));\r\n\t__export(__webpack_require__(1202));\r\n\n\n/***/ },\n\n/***/ 1186:\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tvar source_model_1 = __webpack_require__(1179);\r\n\tvar NewInstance = (function (_super) {\r\n\t    __extends(NewInstance, _super);\r\n\t    function NewInstance(instanceType, instanceTypeOption, action, actionOption, intervention, interventionText, unit, routingCode, priority) {\r\n\t        _super.call(this, action, actionOption, intervention, interventionText, unit, routingCode, priority);\r\n\t        this.instanceType = instanceType;\r\n\t        this.instanceTypeOption = instanceTypeOption;\r\n\t    }\r\n\t    NewInstance.empty = function () {\r\n\t        return new NewInstance(\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\");\r\n\t    };\r\n\t    return NewInstance;\r\n\t}(source_model_1.Source));\r\n\texports.NewInstance = NewInstance;\r\n\n\n/***/ },\n\n/***/ 1202:\n/***/ function(module, exports) {\n\n\t\"use strict\";\r\n\tvar PointList = (function () {\r\n\t    function PointList(pointName, schemas, ruleSeq, ruleDescription, ruleMessage, originalPoint, originalCode, copyPoint, copyCode) {\r\n\t        this.pointName = pointName;\r\n\t        this.schemas = schemas;\r\n\t        this.ruleSeq = ruleSeq;\r\n\t        this.ruleDescription = ruleDescription;\r\n\t        this.ruleMessage = ruleMessage;\r\n\t        this.originalPoint = originalPoint;\r\n\t        this.originalCode = originalCode;\r\n\t        this.copyPoint = copyPoint;\r\n\t        this.copyCode = copyCode;\r\n\t    }\r\n\t    return PointList;\r\n\t}());\r\n\texports.PointList = PointList;\r\n\n\n/***/ },\n\n/***/ 1203:\n/***/ function(module, exports) {\n\n\t\"use strict\";\r\n\tvar Point = (function () {\r\n\t    function Point(pointName, full, rules) {\r\n\t        this.pointName = pointName;\r\n\t        this.full = full;\r\n\t        this.rules = rules;\r\n\t    }\r\n\t    return Point;\r\n\t}());\r\n\texports.Point = Point;\r\n\n\n/***/ },\n\n/***/ 1204:\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tvar condition_model_1 = __webpack_require__(1184);\r\n\tvar action_model_1 = __webpack_require__(1183);\r\n\tvar referential_1 = __webpack_require__(888);\r\n\tvar Rule = (function () {\r\n\t    function Rule(sequence, routingPoint, description, schemas, lastModification, creationDate, createdBy, condition, action) {\r\n\t        this.sequence = sequence;\r\n\t        this.routingPoint = routingPoint;\r\n\t        this.description = description;\r\n\t        this.schemas = schemas;\r\n\t        this.lastModification = lastModification;\r\n\t        this.creationDate = creationDate;\r\n\t        this.createdBy = createdBy;\r\n\t        this.condition = condition;\r\n\t        this.action = action;\r\n\t    }\r\n\t    Rule.empty = function () {\r\n\t        return new Rule(undefined, \"\", \"\", [], undefined, undefined, undefined, condition_model_1.Condition.empty(), action_model_1.Action.empty());\r\n\t    };\r\n\t    Rule.prototype.update = function (that) {\r\n\t        referential_1.updateFields(this, that, [\"sequence\", \"routingPoint\", \"description\",\r\n\t            \"schemas\", \"lastModification\", \"creationDate\", \"createdBy\"]);\r\n\t        this.condition.update(that.condition);\r\n\t        this.action.update(that.action);\r\n\t    };\r\n\t    Rule.prototype.toWriteModel = function (environment, version) {\r\n\t        return {\r\n\t            \"full\": \"true\",\r\n\t            \"ruleDescription\": this.description,\r\n\t            \"environment\": environment,\r\n\t            \"version\": version,\r\n\t            \"action\": this.action.toWriteModel(),\r\n\t            \"condition\": this.condition.toWriteModel()\r\n\t        };\r\n\t    };\r\n\t    return Rule;\r\n\t}());\r\n\texports.Rule = Rule;\r\n\n\n/***/ },\n\n/***/ 1179:\n/***/ function(module, exports) {\n\n\t\"use strict\";\r\n\tvar Source = (function () {\r\n\t    //   constructor();\r\n\t    function Source(action, actionOption, intervention, interventionText, unit, routingCode, priority) {\r\n\t        this.action = action;\r\n\t        this.actionOption = actionOption;\r\n\t        this.intervention = intervention;\r\n\t        this.interventionText = interventionText;\r\n\t        this.unit = unit;\r\n\t        this.routingCode = routingCode;\r\n\t        this.priority = priority;\r\n\t    }\r\n\t    Source.empty = function () {\r\n\t        return new Source(\"\", \"\", \"\", \"\", \"\", \"\", \"\");\r\n\t    };\r\n\t    return Source;\r\n\t}());\r\n\texports.Source = Source;\r\n\n\n/***/ },\n\n/***/ 543:\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tfunction __export(m) {\r\n\t    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n\t}\r\n\t__export(__webpack_require__(1248));\r\n\t__export(__webpack_require__(1187));\r\n\n\n/***/ },\n\n/***/ 1218:\n/***/ function(module, exports, __webpack_require__) {\n\n\tmodule.exports = function (namespace) {\n\t  return new Promise(function (resolve) {\n\t    __webpack_require__.e/* nsure */(20, function (require) {\n\t      if (namespace) {\n\t        resolve(__webpack_require__(1209)[namespace]);\n\t      } else {\n\t        var mod = __webpack_require__(1209);\n\t        resolve(mod.__esModule ? mod.default : mod)\n\t      }\n\t    });\n\t  });\n\t}\n\n/***/ },\n\n/***/ 1257:\n/***/ function(module, exports, __webpack_require__) {\n\n\tmodule.exports = function (namespace) {\n\t  return new Promise(function (resolve) {\n\t    __webpack_require__.e/* nsure */(18, function (require) {\n\t      if (namespace) {\n\t        resolve(__webpack_require__(1210)[namespace]);\n\t      } else {\n\t        var mod = __webpack_require__(1210);\n\t        resolve(mod.__esModule ? mod.default : mod)\n\t      }\n\t    });\n\t  });\n\t}\n\n/***/ },\n\n/***/ 1258:\n/***/ function(module, exports, __webpack_require__) {\n\n\tmodule.exports = function (namespace) {\n\t  return new Promise(function (resolve) {\n\t    __webpack_require__.e/* nsure */(25, function (require) {\n\t      if (namespace) {\n\t        resolve(__webpack_require__(1211)[namespace]);\n\t      } else {\n\t        var mod = __webpack_require__(1211);\n\t        resolve(mod.__esModule ? mod.default : mod)\n\t      }\n\t    });\n\t  });\n\t}\n\n/***/ },\n\n/***/ 1219:\n/***/ function(module, exports, __webpack_require__) {\n\n\tmodule.exports = function (namespace) {\n\t  return new Promise(function (resolve) {\n\t    __webpack_require__.e/* nsure */(24, function (require) {\n\t      if (namespace) {\n\t        resolve(__webpack_require__(1212)[namespace]);\n\t      } else {\n\t        var mod = __webpack_require__(1212);\n\t        resolve(mod.__esModule ? mod.default : mod)\n\t      }\n\t    });\n\t  });\n\t}\n\n/***/ },\n\n/***/ 1220:\n/***/ function(module, exports, __webpack_require__) {\n\n\tmodule.exports = function (namespace) {\n\t  return new Promise(function (resolve) {\n\t    __webpack_require__.e/* nsure */(10, function (require) {\n\t      if (namespace) {\n\t        resolve(__webpack_require__(1213)[namespace]);\n\t      } else {\n\t        var mod = __webpack_require__(1213);\n\t        resolve(mod.__esModule ? mod.default : mod)\n\t      }\n\t    });\n\t  });\n\t}\n\n/***/ },\n\n/***/ 1248:\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tvar core_1 = __webpack_require__(30);\r\n\tvar router_1 = __webpack_require__(58);\r\n\t// console.log('`SAARouting` component loaded asynchronously');\r\n\tvar SAARouting = (function () {\r\n\t    function SAARouting() {\r\n\t    }\r\n\t    SAARouting.prototype.ngOnInit = function () {\r\n\t        // console.log('hello `SAA Routing` component');\r\n\t        // static data that is bundled\r\n\t        // var mockData = require('assets/mock-data/mock-data.json');\r\n\t        // console.log('mockData', mockData);\r\n\t        // if you're working with mock data you can also use http.get('assets/mock-data/mock-data.json')\r\n\t        // this.asyncDataWithWebpack();\r\n\t    };\r\n\t    SAARouting.prototype.asyncDataWithWebpack = function () {\r\n\t        // you can also async load mock data with 'es6-promise-loader'\r\n\t        // you would do this if you don't want the mock-data bundled\r\n\t        // remember that 'es6-promise-loader' is a promise\r\n\t        // var asyncMockDataPromiseFactory = require('es6-promise!assets/mock-data/mock-data.json');\r\n\t        // setTimeout(() => {\r\n\t        //\r\n\t        //   let asyncDataPromise = asyncMockDataPromiseFactory();\r\n\t        //   asyncDataPromise.then(json => {\r\n\t        //     console.log('async mockData', json);\r\n\t        //   });\r\n\t        //\r\n\t        // });\r\n\t    };\r\n\t    SAARouting = __decorate([\r\n\t        core_1.Component({\r\n\t            selector: 'saa-routing',\r\n\t            //   styles: [`\r\n\t            //     h1 {\r\n\t            //       font-family: Arial, Helvetica, sans-serif\r\n\t            //     }\r\n\t            //   `],\r\n\t            directives: [router_1.ROUTER_DIRECTIVES],\r\n\t            template: \"\\n    <router-outlet></router-outlet>\\n  \"\r\n\t        }),\r\n\t        router_1.RouteConfig([\r\n\t            { path: '/', name: 'SAARoutingHome', loader: function () { return __webpack_require__(1258)('SAARoutingHome'); }, useAsDefault: true },\r\n\t            { path: '/routing-overview', name: 'PointsOverview', loader: function () { return __webpack_require__(1257)('SAAPointsOverviewComponent'); } },\r\n\t            { path: '/routing-point/create', name: 'PointCreate', loader: function () { return __webpack_require__(1219)('SAARoutingPoint'); } },\r\n\t            { path: '/routing-point/:id/edit', name: 'PointEdit', loader: function () { return __webpack_require__(1219)('SAARoutingPoint'); } },\r\n\t            { path: '/routing-rule/create', name: 'RuleCreate', loader: function () { return __webpack_require__(1220)('SAARoutingRule'); } },\r\n\t            { path: '/routing-rule/:pointName/:sequence/edit', name: 'RuleEdit', loader: function () { return __webpack_require__(1220)('SAARoutingRule'); } },\r\n\t            { path: '/export', name: 'SAAExport', loader: function () { return __webpack_require__(1218)('SAAExportImportComponent'); } },\r\n\t            { path: '/simulation', name: 'SAASimulation', loader: function () { return __webpack_require__(1259)('SAASimulatorComponent'); } },\r\n\t            { path: '/import', name: 'SAAImport', loader: function () { return __webpack_require__(1218)('SAAExportImportComponent'); } }\r\n\t        ]), \r\n\t        __metadata('design:paramtypes', [])\r\n\t    ], SAARouting);\r\n\t    return SAARouting;\r\n\t}());\r\n\texports.SAARouting = SAARouting;\r\n\n\n/***/ },\n\n/***/ 1187:\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tvar http_1 = __webpack_require__(257);\r\n\tvar core_1 = __webpack_require__(30);\r\n\tvar Observable_1 = __webpack_require__(14);\r\n\tvar routing_amh_1 = __webpack_require__(880);\r\n\tvar routing_1 = __webpack_require__(1185);\r\n\tvar services_1 = __webpack_require__(38);\r\n\tvar routing_2 = __webpack_require__(1185);\r\n\tvar option_1 = __webpack_require__(926);\r\n\t__webpack_require__(904);\r\n\tvar SAARoutingService = (function () {\r\n\t    function SAARoutingService(http, config, logger) {\r\n\t        this.http = http;\r\n\t        this.config = config;\r\n\t        this.logger = logger;\r\n\t        this.schemaClause = \"\\n  {\\n    \\\"match\\\": {\\n        \\\"rules.schemas\\\": {\\n        \\\"query\\\": \\\"##TO_REPLACE##\\\",\\n        \\\"analyzer\\\": \\\"standard\\\",\\n        \\\"operator\\\": \\\"and\\\"\\n        }\\n      }\\n  }\\n  \";\r\n\t        this.pointsBySchemaQuery = \"\\n  { \\n    \\\"query\\\": {\\n    \\\"bool\\\": {\\n      \\\"must\\\": [\\n        {\\n          \\\"nested\\\": {\\n            \\\"path\\\": \\\"rules\\\",\\n            \\\"query\\\": {\\n              \\\"bool\\\": {\\n                \\\"should\\\": [\\n                  ##MATCH_CLAUSES##\\n                ]\\n              }\\n            }\\n          }\\n        }\\n      ]\\n    }\\n  }\\n    ##FILTER_RULES_CLAUSE##\\n    ##RANGE_SORT_CLAUSE##\\n  }\";\r\n\t        this.filterRules = \"\\n  ,\\n  \\\"filter\\\":{\\n    ##RULE_CLAUSE##\\n  }\";\r\n\t        this.query = \" \\n    {\\n  \\\"query\\\": {\\n    ##RULE_CLAUSE##\\n  }\\n  ##RANGE_SORT_CLAUSE##\\n}\\n  \";\r\n\t        this.fromSortClauses = \"\\n  ,\\n  \\\"from\\\": 0,\\n  \\\"size\\\": 1000,\\n  \\\"sort\\\": [\\n    {\\n      \\\"pointName\\\": {\\n        \\\"order\\\": \\\"asc\\\"\\n      }\\n    },\\n    {\\n      \\\"rules.sequence\\\": {\\n        \\\"order\\\": \\\"desc\\\"\\n      }\\n    }\\n  ]\\n  \";\r\n\t        this.queryRule = \" \\n    \\\"bool\\\": {\\n      \\\"should\\\": [\\n        {\\n          \\\"match\\\": {\\n            \\\"pointName\\\": {\\n              \\\"query\\\": \\\"##TO_REPLACE##\\\",\\n              \\\"analyzer\\\": \\\"standard\\\",\\n              \\\"operator\\\": \\\"and\\\"\\n            }\\n          }\\n        },\\n        {\\n          \\\"nested\\\": {\\n            \\\"path\\\": \\\"rules.condition\\\",\\n            \\\"query\\\": {\\n              \\\"bool\\\": {\\n                \\\"must\\\": [\\n                  {\\n                    \\\"match\\\": {\\n                      \\\"rules.condition.message\\\": {\\n                        \\\"query\\\": \\\"##TO_REPLACE##\\\",\\n                        \\\"analyzer\\\": \\\"standard\\\",\\n                        \\\"operator\\\": \\\"and\\\"\\n                      }\\n                    }\\n                  }\\n                ]\\n              }\\n            }\\n          }  \\n        },\\n        {\\n          \\\"nested\\\": {\\n            \\\"path\\\": \\\"rules\\\",\\n            \\\"query\\\": {\\n              \\\"bool\\\": {\\n                \\\"must\\\": [\\n                  {\\n                    \\\"match\\\": {\\n                      \\\"rules.description\\\": {\\n                        \\\"query\\\": \\\"##TO_REPLACE##\\\",\\n                        \\\"analyzer\\\": \\\"standard\\\",\\n                        \\\"operator\\\": \\\"and\\\"\\n                      }\\n                    }\\n                  }\\n                ]\\n              }\\n            }\\n          }\\n        }\\n      ]\\n    }\\n  \";\r\n\t        // this.logger.log(\" retrieving config\");\r\n\t        // this.logger.log(\"saaBackUrl value: \" + config.get('saaBackUrl'));\r\n\t    }\r\n\t    SAARoutingService.prototype.findAssignmentByID = function (productID) {\r\n\t        return this.http.get('/products/${productID}').map(function (res) { return res.json(); });\r\n\t    };\r\n\t    //TODO: \r\n\t    /*\r\n\t     *  + remove limit size=100 for all http request, use pagination instead\r\n\t    */\r\n\t    SAARoutingService.prototype.findPoints = function () {\r\n\t        return this.http.post(this.config.get(\"esBackUrl\") + \"/routing/points/_search\", '{\"sort\": [{\"pointName\": {\"order\": \"asc\"}}, {\"rules.sequence\": {\"order\": \"desc\"}}]}').map(function (res) { return res.json(); });\r\n\t    };\r\n\t    SAARoutingService.prototype.findPointNames = function () {\r\n\t        return this.http.post(this.config.get(\"esBackUrl\") + \"/routing/points/_search?size=1000\", '{ \"fields\": [\"pointName\"], \"sort\": [{\"pointName\": {\"order\": \"asc\"}}, {\"rules.sequence\": {\"order\": \"desc\"}}]}')\r\n\t            .map(function (res) { return res.json(); })\r\n\t            .flatMap(function (dataset) { return Observable_1.Observable.from(dataset['hits'].hits); })\r\n\t            .map(function (hit) {\r\n\t            var toReturn = {\r\n\t                \"pointName\": hit[\"fields\"][\"pointName\"][0]\r\n\t            };\r\n\t            // this.logger.debug(\"hit \"+JSON.stringify(hit) + \"  to return \"+ JSON.stringify(toReturn));\r\n\t            return toReturn;\r\n\t        });\r\n\t    };\r\n\t    SAARoutingService.prototype.findPointMatches = function (schemas, text) {\r\n\t        if (text) {\r\n\t            return this.findPointMatchesJson(schemas, text)\r\n\t                .flatMap(this.toHits)\r\n\t                .flatMap(this.toPointList)\r\n\t                .reduce(function (acc, R) { acc.push(R); return acc; }, new Array());\r\n\t        }\r\n\t        else {\r\n\t            return this.findPointMatchesJson(schemas, text)\r\n\t                .flatMap(this.toHits)\r\n\t                .flatMap(this.toPointList)\r\n\t                .reduce(function (acc, R) { acc.push(R); return acc; }, new Array());\r\n\t        }\r\n\t    };\r\n\t    SAARoutingService.prototype.toPointList = function (point) {\r\n\t        var list = [];\r\n\t        if (point.rules.length > 0) {\r\n\t            point.rules.map(function (rule) {\r\n\t                var originalPoint = rule.action.source ? rule.action.source.actionOption : \"\";\r\n\t                var originalCode = rule.action.source ? rule.action.source.routingCode : \"\";\r\n\t                var copyPoint = rule.action.newInstance ? rule.action.newInstance.actionOption : \"\";\r\n\t                var copyCode = rule.action.newInstance ? rule.action.newInstance.routingCode : \"\";\r\n\t                list.push(new routing_2.PointList(rule.routingPoint, rule.schemas, rule.sequence, rule.description, rule.condition ? rule.condition.message : \"\", originalPoint, originalCode, copyPoint, copyCode));\r\n\t            });\r\n\t        }\r\n\t        else {\r\n\t            //this.logger.debug(\"adding assign \"+assign.code+\" without rules\");\r\n\t            list.push(new routing_2.PointList(point.pointName, \"\", undefined, \"\", \"\"));\r\n\t        }\r\n\t        // this.logger.debug(\"last flatMap with \" + list.length);\r\n\t        return Observable_1.Observable.from(list);\r\n\t    };\r\n\t    SAARoutingService.prototype.findPointMatchesJson = function (schemas, text) {\r\n\t        var payload;\r\n\t        var hasTextValue = text && text.length >= 1;\r\n\t        if (schemas && schemas.length >= 1) {\r\n\t            var withSchemaText = hasTextValue ?\r\n\t                this.filterRules.replace(/##RULE_CLAUSE##/g, this.queryRule.replace(/##TO_REPLACE##/g, text))\r\n\t                : \"\";\r\n\t            payload = this.pointsBySchemaQuery\r\n\t                .replace(/##MATCH_CLAUSES##/g, this.createSchemaQueryClauses(schemas))\r\n\t                .replace(/##FILTER_RULES_CLAUSE##/g, withSchemaText)\r\n\t                .replace(/##RANGE_SORT_CLAUSE##/g, this.fromSortClauses);\r\n\t        }\r\n\t        else if (hasTextValue) {\r\n\t            payload = this.query\r\n\t                .replace(/##RULE_CLAUSE##/g, this.queryRule.replace(/##TO_REPLACE##/g, text))\r\n\t                .replace(/##RANGE_SORT_CLAUSE##/g, this.fromSortClauses);\r\n\t        }\r\n\t        else {\r\n\t            payload = '{\"sort\": [{\"pointName\": {\"order\": \"asc\"}}, {\"rules.sequence\": {\"order\": \"desc\"}}]}';\r\n\t        }\r\n\t        //this.logger.debug(\"findPointMatches payload \"+ payload);\r\n\t        return this.http.post(this.config.get(\"esBackUrl\") + \"/routing/points/_search?size=1000\", payload).map(function (res) { return res.json(); });\r\n\t    };\r\n\t    SAARoutingService.prototype.findPointByName = function (pointName) {\r\n\t        return this.http.get(this.config.get(\"esBackUrl\") + \"/routing/points/\" + pointName)\r\n\t            .map(function (res) { return res.json(); })\r\n\t            .map(function (res) {\r\n\t            // this.logger.debug(\"from 1st call \"+JSON.stringify(res));\r\n\t            return { \"found\": res.found, \"source\": res._source };\r\n\t        });\r\n\t    };\r\n\t    SAARoutingService.prototype.findRuleByPointAndSequence = function (pointName, sequence) {\r\n\t        var _this = this;\r\n\t        return this.findPointByName(pointName)\r\n\t            .flatMap(function (res) {\r\n\t            //this.logger.debug(\"from call \"+JSON.stringify(res));\r\n\t            if (res.found) {\r\n\t                var found = [];\r\n\t                var ruleBySequenceFound = res.source.rules.find(function (rule) { return rule.sequence == sequence; });\r\n\t                if (ruleBySequenceFound) {\r\n\t                    found.push({ \"found\": true, \"value\": ruleBySequenceFound });\r\n\t                }\r\n\t                _this.logger.log(\"ruleBySequence \" + found);\r\n\t                return Observable_1.Observable.from(found);\r\n\t            }\r\n\t            else {\r\n\t                //TODO: check how to return an error\r\n\t                _this.logger.error(\"no point found \");\r\n\t                return Observable_1.Observable.from([{ \"found\": true, \"value\": {} }]);\r\n\t            }\r\n\t        });\r\n\t    };\r\n\t    SAARoutingService.prototype.toRules = function (point) {\r\n\t        var list = [];\r\n\t        if (point.rules.length > 0) {\r\n\t            point.rules.map(function (rule) {\r\n\t                if (rule.schemas && rule.schemas.length > 0) {\r\n\t                }\r\n\t                list.push(new routing_1.Rule(rule.sequence, rule.routingPoint, rule.description, rule.schemas, undefined, undefined, rule.condition, rule.action));\r\n\t            });\r\n\t        }\r\n\t        // this.logger.debug(\"last flatMap with \" + list.length);\r\n\t        return Observable_1.Observable.from(list);\r\n\t    };\r\n\t    SAARoutingService.prototype.createSchemaQueryClauses = function (schemas) {\r\n\t        var _this = this;\r\n\t        if (!schemas || schemas.length <= 0) {\r\n\t            return \"\";\r\n\t        }\r\n\t        return schemas.map(function (schema) { return _this.schemaClause.replace(/##TO_REPLACE##/g, schema); }).join(\",\");\r\n\t    };\r\n\t    SAARoutingService.prototype.findOne = function (source, target) {\r\n\t        if (!source || source.length == 0 || !target || target.length == 0) {\r\n\t            return false;\r\n\t        }\r\n\t        return target.some(function (e) { return source.indexOf(e) != -1; });\r\n\t    };\r\n\t    SAARoutingService.prototype.findRulesBySchemas = function (schemas, filter) {\r\n\t        var _this = this;\r\n\t        if (filter === void 0) { filter = true; }\r\n\t        this.logger.log(\">> looking for rules with schemas \" + JSON.stringify(schemas));\r\n\t        var payload = this.pointsBySchemaQuery\r\n\t            .replace(/##MATCH_CLAUSES##/g, this.createSchemaQueryClauses(schemas))\r\n\t            .replace(/##FILTER_RULES_CLAUSE##/g, \"\")\r\n\t            .replace(/##RANGE_SORT_CLAUSE##/g, this.fromSortClauses);\r\n\t        //this.logger.debug(\"findPointMatches payload \"+ payload);\r\n\t        var allRules = this.http.post(this.config.get(\"esBackUrl\") + \"/routing/points/_search?size=1000\", payload)\r\n\t            .map(function (res) { return res.json(); })\r\n\t            .flatMap(this.toHits)\r\n\t            .flatMap(this.toRules);\r\n\t        if (filter) {\r\n\t            allRules = allRules.filter(function (rule) {\r\n\t                var schemaFound = _this.findOne(rule.schemas, schemas);\r\n\t                _this.logger.debug(\"in filter rules: \" + rule.schemas + \" schemaFound = \" + schemaFound);\r\n\t                return schemaFound;\r\n\t            });\r\n\t        }\r\n\t        return allRules.reduce(function (acc, R) { acc.push(R); return acc; }, new Array());\r\n\t        ;\r\n\t    };\r\n\t    SAARoutingService.prototype.findRuleByCode = function (code) {\r\n\t        var _this = this;\r\n\t        this.logger.log(\">> looking for \" + code);\r\n\t        var found = new routing_amh_1.AMHRule(\"\", \"\");\r\n\t        return this.findRules().flatMap(function (data) {\r\n\t            var rule = SAARoutingService.getFromSource(data).find(function (r) {\r\n\t                return r.code.toLowerCase() == (code ? code.toLocaleLowerCase() : '');\r\n\t            });\r\n\t            _this.logger.log(\">> elastic return  \" + rule);\r\n\t            if (rule) {\r\n\t                return Observable_1.Observable.create(function (observer) {\r\n\t                    observer.next(rule);\r\n\t                    observer.complete();\r\n\t                    // Any cleanup logic might go here\r\n\t                    return function () { return _this.logger.log('disposed found'); };\r\n\t                });\r\n\t            }\r\n\t            else {\r\n\t                return Observable_1.Observable.create(function (observer) {\r\n\t                    observer.next(new routing_amh_1.AMHRule(\"\", \"\"));\r\n\t                    _this.logger.log(\"returning to observer code=empty\");\r\n\t                    observer.complete();\r\n\t                    // Any cleanup logic might go here\r\n\t                    return function () { return _this.logger.log('disposed not found'); };\r\n\t                });\r\n\t            }\r\n\t        });\r\n\t        // return Observable.from(this.findAMHRuleByCode(code));\r\n\t    };\r\n\t    SAARoutingService.prototype.findRules = function () {\r\n\t        return this.http.get(this.config.get(\"esBackUrl\") + \"/amhrouting/rules/_search?size=1000\").map(function (res) { return res.json(); });\r\n\t    };\r\n\t    SAARoutingService.prototype.findBackends = function () {\r\n\t        this.logger.log(\"findBackends url = \" + this.config.get(\"esBackUrl\"));\r\n\t        return this.http.get(this.config.get(\"esBackUrl\") + \"/amhrouting/backends/_search?size=1000\").map(function (res) { return res.json(); });\r\n\t    };\r\n\t    // findAssignmentsBySequence(sequence: number): Observable<any> {\r\n\t    //   return this.findAssignments().flatMap(\r\n\t    //     (data) => {\r\n\t    //       let assignments = SAARoutingService.getFromSource(data);\r\n\t    //       let found=[];\r\n\t    //       let assignBySequenceFound = assignments.find(assignment => assignment.sequence == sequence);\r\n\t    //       if (assignBySequenceFound) {\r\n\t    //         found.push(assignBySequenceFound);\r\n\t    //       }\r\n\t    //       this.logger.log(\"assignmentBySequence \"+ found);\r\n\t    //       return Observable.from(found);\r\n\t    //     }\r\n\t    //   );\r\n\t    // }\r\n\t    // findAssignmentsByCode(code: string): Observable<any> {\r\n\t    //   return this.findAssignments().flatMap(\r\n\t    //     (data) => {\r\n\t    //       let assignments = SAARoutingService.getFromSource(data);\r\n\t    //       let found=[];\r\n\t    //       let assignByCodeFound = assignments.find(assignment => assignment.code == code);\r\n\t    //       if (assignByCodeFound) {\r\n\t    //         found.push(assignByCodeFound);\r\n\t    //       }\r\n\t    //       this.logger.log(\"assignmentByCode \"+ found);\r\n\t    //       return Observable.from(found);\r\n\t    //     }\r\n\t    //   );\r\n\t    // }\r\n\t    // findAssignmentsByBackendPK(pk: BackendPK): Observable<any> {\r\n\t    //   return this.findAssignments().flatMap(\r\n\t    //     (data) => {\r\n\t    //       let assignments = SAARoutingService.getFromSource(data);\r\n\t    //       let found=[];\r\n\t    //       for (var i = 0; i < assignments.length; i++) {\r\n\t    //         var existingBackend = assignments[i];\r\n\t    //         if (existingBackend.backendPrimaryKey.code === pk.code && existingBackend.backendPrimaryKey.direction === pk.direction) {\r\n\t    //           found.push(existingBackend);\r\n\t    //           break;\r\n\t    //         }\r\n\t    //       }\r\n\t    //       this.logger.log(\"[flatMap] returning \"+ found);\r\n\t    //       return Observable.from(found);\r\n\t    //     }\r\n\t    //   );\r\n\t    // }\r\n\t    SAARoutingService.prototype.saveRule = function (env, version, rule) {\r\n\t        var _this = this;\r\n\t        var headers = new http_1.Headers({ 'Content-Type': 'application/json' });\r\n\t        var options = new http_1.RequestOptions({ headers: headers });\r\n\t        var payload = JSON.stringify(rule.toWriteModel(env, version));\r\n\t        this.logger.log(\" save rule sent: \" + payload);\r\n\t        return this.http.put(this.config.get(\"saaBackUrl\") + \"/points/\" + rule.routingPoint + \"/rules/\" + rule.sequence, payload, options).map(function (res) { _this.logger.log(\" from save \" + res.json()); res.json(); });\r\n\t    };\r\n\t    SAARoutingService.prototype.createRule = function (env, version, rule) {\r\n\t        var _this = this;\r\n\t        var headers = new http_1.Headers({ 'Content-Type': 'application/json' });\r\n\t        var options = new http_1.RequestOptions({ headers: headers });\r\n\t        var payload = JSON.stringify(rule.toWriteModel(env, version));\r\n\t        this.logger.log(\" create rule sent: \" + payload);\r\n\t        return this.http.post(this.config.get(\"saaBackUrl\") + \"/points/\" + rule.routingPoint + \"/rules/\" + rule.sequence, payload, options).map(function (res) { _this.logger.log(\" from create \" + res.json()); res.json(); });\r\n\t    };\r\n\t    SAARoutingService.prototype.saveAssignment = function (assignment) {\r\n\t        var _this = this;\r\n\t        var headers = new http_1.Headers({ 'Content-Type': 'application/json' });\r\n\t        var options = new http_1.RequestOptions({ headers: headers });\r\n\t        var payload = this.assignToWriteModel(assignment);\r\n\t        this.logger.log(\" save assignment sent: \" + payload);\r\n\t        return this.http.put(this.config.get(\"saaBackUrl\") + \"/amhrouting/assignments/\" + assignment.code, payload, options).map(function (res) { _this.logger.log(\" from save \" + res.json()); res.json(); });\r\n\t    };\r\n\t    SAARoutingService.prototype.createAssignment = function (assignment) {\r\n\t        var _this = this;\r\n\t        var headers = new http_1.Headers({ 'Content-Type': 'application/json' });\r\n\t        var options = new http_1.RequestOptions({ headers: headers });\r\n\t        var payload = this.assignToWriteModel(assignment);\r\n\t        this.logger.log(\" create assignment sent: \" + payload);\r\n\t        return this.http.post(this.config.get(\"saaBackUrl\") + \"/amhrouting/assignments/\" + assignment.code, payload, options).map(function (res) { _this.logger.log(\" from create \" + res.json()); return res.json(); });\r\n\t    };\r\n\t    SAARoutingService.prototype.export = function (env, version, fileName) {\r\n\t        var _this = this;\r\n\t        var headers = new http_1.Headers({ 'Content-Type': 'application/json' });\r\n\t        var options = new http_1.RequestOptions({ headers: headers });\r\n\t        var payload = JSON.stringify({\r\n\t            filePath: \"useless\",\r\n\t            fileName: fileName,\r\n\t            env: env,\r\n\t            version: version\r\n\t        });\r\n\t        this.logger.log(\" export sent to SAA: \" + payload);\r\n\t        return this.http.post(this.config.get(\"saaBackUrl\") + \"/routing/export\", payload, options)\r\n\t            .map(function (res) {\r\n\t            _this.logger.log(\" from export \" + res.json().response);\r\n\t            return res.json();\r\n\t        });\r\n\t    };\r\n\t    SAARoutingService.prototype.getExportedFile = function (fileName) {\r\n\t        return this.http.get(this.config.get(\"saaBackUrl\") + \"/routing/export/\" + fileName).map(function (res) { return res.json(); });\r\n\t    };\r\n\t    SAARoutingService.prototype.import = function (filePath) {\r\n\t        var _this = this;\r\n\t        var headers = new http_1.Headers({ 'Content-Type': 'application/json' });\r\n\t        var options = new http_1.RequestOptions({ headers: headers });\r\n\t        var payload = JSON.stringify({\r\n\t            filePath: filePath\r\n\t        });\r\n\t        this.logger.log(\" import sent: \" + payload);\r\n\t        return this.http.post(this.config.get(\"saaBackUrl\") + \"/routing/import\", payload, options).map(function (res) { _this.logger.log(\" from import \" + res.json()); return res.json(); });\r\n\t    };\r\n\t    SAARoutingService.prototype.assignToWriteModel = function (assignment) {\r\n\t        var _this = this;\r\n\t        var writeModelObj = {\r\n\t            sequence: assignment.sequence,\r\n\t            backCode: assignment.backendPrimaryKey.code,\r\n\t            backDirection: assignment.backendPrimaryKey.direction,\r\n\t            active: String(assignment.active),\r\n\t            dataOwner: assignment.dataOwner,\r\n\t            lockCode: assignment.lockCode,\r\n\t            description: assignment.description,\r\n\t            rules: []\r\n\t        };\r\n\t        var rules = assignment.rules || [];\r\n\t        rules.forEach(function (rule) {\r\n\t            var ruleWriteModel = _this.assigRuleToModel(assignment.code, rule);\r\n\t            writeModelObj.rules.push(ruleWriteModel);\r\n\t        });\r\n\t        return JSON.stringify(writeModelObj);\r\n\t    };\r\n\t    //  code: String, sequence: Long, ruleCode: String,\r\n\t    //                                    dataOwner: Option[String], lockCode: Option[String],\r\n\t    //                                    environment: Option[String] = None, //lastModification: Option[Date] = None, creationDate: Option[Date] = None,\r\n\t    //                                    createdBy: Option[String] = None, lastModifiedBy: Option[String] = None, version: Option[Long] = None\r\n\t    //  public code: string;\r\n\t    //   public dataOwner: string;\r\n\t    //   public lockCode: string;\r\n\t    //   public sequence: number;\r\n\t    //   public expression:string;\r\n\t    SAARoutingService.prototype.assigRuleToModel = function (backendCode, assignmentRule) {\r\n\t        this.logger.log(\"assigRuleToModel with code \" + backendCode + \" assignmentRule.sequence \" + assignmentRule.sequence\r\n\t            + \" assignmentRule.code \" + assignmentRule.code + \" assignmentRule.dataOwner \" + assignmentRule.dataOwner + \" assignmentRule.lockCode \" + assignmentRule.lockCode);\r\n\t        return {\r\n\t            code: backendCode,\r\n\t            sequence: assignmentRule.sequence,\r\n\t            ruleCode: assignmentRule.code,\r\n\t            dataOwner: assignmentRule.dataOwner,\r\n\t            lockCode: assignmentRule.lockCode\r\n\t        };\r\n\t    };\r\n\t    SAARoutingService.getFromSource = function (data) {\r\n\t        var hitArray = data['hits'].hits;\r\n\t        var resp = hitArray.map(function (s) { return s._source; });\r\n\t        return resp;\r\n\t    };\r\n\t    SAARoutingService.prototype.toHits = function (match) {\r\n\t        return Observable_1.Observable.from(match['hits'].hits)\r\n\t            .map(function (hit) { return hit[\"_source\"]; });\r\n\t    };\r\n\t    //TODO: check how to pass 'this' in the context to user this.logger instead of console\r\n\t    SAARoutingService.prototype.toFoundHits = function (match) {\r\n\t        var totalHits = match.hits.total;\r\n\t        //console.debug(\"totalHits : \"+totalHits);\r\n\t        if (totalHits > 0) {\r\n\t            var hits = match['hits'].hits.map(function (hit) { return hit[\"_source\"]; });\r\n\t            //console.debug(\"from  \"+ JSON.stringify(hits));\r\n\t            return Observable_1.Observable.from([{ \"found\": true, \"hits\": hits }]);\r\n\t        }\r\n\t        else {\r\n\t            //console.debug(\"returning empty hits[] \");\r\n\t            return Observable_1.Observable.from([{ \"found\": false, \"hits\": [] }]);\r\n\t        }\r\n\t    };\r\n\t    SAARoutingService.prototype.findSchemas = function () {\r\n\t        this.logger.log(\"findSchemas url = \" + this.config.get(\"esBackUrl\"));\r\n\t        return this.http.get(this.config.get(\"esBackUrl\") + \"/routing/schemas/_search?size=1000\")\r\n\t            .map(function (res) { return res.json(); })\r\n\t            .flatMap(this.toFoundHits)\r\n\t            .map(function (resp) { return resp.hits.map(function (hit) { return new option_1.Option(1, hit['name'], hit['name']); }); });\r\n\t    };\r\n\t    SAARoutingService = __decorate([\r\n\t        core_1.Injectable(), \r\n\t        __metadata('design:paramtypes', [http_1.Http, services_1.Config, services_1.Logger])\r\n\t    ], SAARoutingService);\r\n\t    return SAARoutingService;\r\n\t}());\r\n\texports.SAARoutingService = SAARoutingService;\r\n\n\n/***/ },\n\n/***/ 1259:\n/***/ function(module, exports, __webpack_require__) {\n\n\tmodule.exports = function (namespace) {\n\t  return new Promise(function (resolve) {\n\t    __webpack_require__.e/* nsure */(8, function (require) {\n\t      if (namespace) {\n\t        resolve(__webpack_require__(1214)[namespace]);\n\t      } else {\n\t        var mod = __webpack_require__(1214);\n\t        resolve(mod.__esModule ? mod.default : mod)\n\t      }\n\t    });\n\t  });\n\t}\n\n/***/ }\n\n});\n\n\n// WEBPACK FOOTER //\n// 1.c2d024fea936b7873685.chunk.js","\"use strict\";\nvar Observable_1 = require('../../Observable');\nvar reduce_1 = require('../../operator/reduce');\nObservable_1.Observable.prototype.reduce = reduce_1.reduce;\n//# sourceMappingURL=reduce.js.map\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/rxjs/add/operator/reduce.js\n// module id = 904\n// module chunks = 1 9 11 12 13 14 15 16 17","\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar Subscriber_1 = require('../Subscriber');\n/**\n * Returns an Observable that applies a specified accumulator function to the first item emitted by a source Observable,\n * then feeds the result of that function along with the second item emitted by the source Observable into the same\n * function, and so on until all items have been emitted by the source Observable, and emits the final result from\n * the final call to your function as its sole item.\n * This technique, which is called \"reduce\" here, is sometimes called \"aggregate,\" \"fold,\" \"accumulate,\" \"compress,\" or\n * \"inject\" in other programming contexts.\n *\n * <img src=\"./img/reduce.png\" width=\"100%\">\n *\n * @param {initialValue} the initial (seed) accumulator value\n * @param {accumulator} an accumulator function to be invoked on each item emitted by the source Observable, the\n * result of which will be used in the next accumulator call.\n * @return {Observable} an Observable that emits a single item that is the result of accumulating the output from the\n * items emitted by the source Observable.\n * @method reduce\n * @owner Observable\n */\nfunction reduce(project, seed) {\n    return this.lift(new ReduceOperator(project, seed));\n}\nexports.reduce = reduce;\nvar ReduceOperator = (function () {\n    function ReduceOperator(project, seed) {\n        this.project = project;\n        this.seed = seed;\n    }\n    ReduceOperator.prototype.call = function (subscriber, source) {\n        return source._subscribe(new ReduceSubscriber(subscriber, this.project, this.seed));\n    };\n    return ReduceOperator;\n}());\nexports.ReduceOperator = ReduceOperator;\n/**\n * We need this JSDoc comment for affecting ESDoc.\n * @ignore\n * @extends {Ignored}\n */\nvar ReduceSubscriber = (function (_super) {\n    __extends(ReduceSubscriber, _super);\n    function ReduceSubscriber(destination, project, seed) {\n        _super.call(this, destination);\n        this.hasValue = false;\n        this.acc = seed;\n        this.project = project;\n        this.hasSeed = typeof seed !== 'undefined';\n    }\n    ReduceSubscriber.prototype._next = function (value) {\n        if (this.hasValue || (this.hasValue = this.hasSeed)) {\n            this._tryReduce(value);\n        }\n        else {\n            this.acc = value;\n            this.hasValue = true;\n        }\n    };\n    ReduceSubscriber.prototype._tryReduce = function (value) {\n        var result;\n        try {\n            result = this.project(this.acc, value);\n        }\n        catch (err) {\n            this.destination.error(err);\n            return;\n        }\n        this.acc = result;\n    };\n    ReduceSubscriber.prototype._complete = function () {\n        if (this.hasValue || this.hasSeed) {\n            this.destination.next(this.acc);\n        }\n        this.destination.complete();\n    };\n    return ReduceSubscriber;\n}(Subscriber_1.Subscriber));\nexports.ReduceSubscriber = ReduceSubscriber;\n//# sourceMappingURL=reduce.js.map\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/rxjs/operator/reduce.js\n// module id = 922\n// module chunks = 1 9 11 12 13 14 15 16 17","export * from './ui.model';\n\n\n// WEBPACK FOOTER //\n// ./src/app/models/referential/index.ts","\r\nexport * from './option.model';\n\n\n// WEBPACK FOOTER //\n// ./src/app/models/referential/option/index.ts","import {IText} from '../';\r\n\r\nexport class Option implements IText {\r\n    public id:number;\r\n    public code:string;\r\n    public description:string;\r\n    public selected : boolean;\r\n    \r\n    \r\n    constructor(id:number, code:string, description:string, selected:boolean = false) {\r\n        this.code = code;\r\n        this.id = id;\r\n        this.description = description;\r\n        this.selected = selected;\r\n    }\r\n    \r\n    get htmlText():string  { return this.description;}\r\n    \r\n    static mapToProperty = (option:Object) => option[\"id\"];\r\n    \r\n    static fromJson(json: string) {\r\n        var data = JSON.parse(json);\r\n        return new Option(data.id, data.code, data.description);\r\n    }\r\n    \r\n}   \n\n\n// WEBPACK FOOTER //\n// ./src/app/models/referential/option/option.model.ts","export interface IText {\r\n    htmlText: string;\r\n    id :number;\r\n    \r\n}\r\n\r\nexport interface IOption {\r\n    id: number;\r\n    code: string;\r\n    text: string;\r\n    children: IOption[];\r\n}\r\n\r\nexport class ItemContainer implements IText {\r\n    public id: number;\r\n    public description: string;\r\n    public children: ItemChild[];\r\n\r\n    constructor(id: number, description: string) {\r\n        this.id = id;\r\n        this.description = description;\r\n        this.children = [];\r\n    }\r\n\r\n    get htmlText(): string { return this.description; }\r\n\r\n    addChild(child: ItemChild) {\r\n        this.children.push(child);\r\n    }\r\n\r\n}\r\n\r\nexport class ItemChild implements IText {\r\n    public id: number;\r\n    public description: string;\r\n\r\n    constructor(id: number, description: string) {\r\n        this.id = id;\r\n        this.description = description;\r\n    }\r\n\r\n    get htmlText(): string { return this.description; }\r\n\r\n}\r\n\r\nexport class IdCodeDescription implements IText {\r\n    public id: number;\r\n    public code: string;\r\n    public description: string;\r\n\r\n    constructor(id: number, code: string, description: string) {\r\n        this.id = id;\r\n        this.code = code;\r\n        this.description = description;\r\n    }\r\n\r\n    get htmlText(): string { return this.description; }\r\n\r\n    static mapToProperty = (option: Object) => option[\"code\"];\r\n\r\n    static fromJson(json: string) {\r\n        var data = JSON.parse(json);\r\n        return new IdCodeDescription(data.id, data.code, data.description);\r\n    }\r\n\r\n    static empty() : IdCodeDescription {\r\n       return new IdCodeDescription(1, \"\",\"\"); \r\n    }\r\n}\r\n\r\nexport function updateFields(dest : any, orig : any, fields : Array<string>) {\r\n    fields.forEach( f => dest[f] = orig[f] || dest[f]);\r\n}\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/models/referential/ui.model.ts","import {AssignType} from './assignment-type.model.ts';\r\n\r\nexport class AssignmentConfig {\r\n  public maxBackendsAllowed: number;\r\n  public type: AssignType;\r\n  \r\n  constructor(type : AssignType, maxBackendsAllowed?: number) {\r\n    this.type = type;\r\n    this.maxBackendsAllowed = this.calculeMaxBackendsAllowed(type, maxBackendsAllowed);\r\n  }\r\n\r\n  private calculeMaxBackendsAllowed(type : AssignType, maxBackendsAllowed: number) {\r\n    if (maxBackendsAllowed) {\r\n      return maxBackendsAllowed;\r\n    }\r\n\r\n    switch (type) {\r\n      case AssignType.BK_CHANNEL:\r\n        return 1;\r\n      case AssignType.DTN_COPY:\r\n      case AssignType.FEED_DTN_COPY:\r\n        return 1000;  \r\n    }\r\n  }\r\n\r\n  public isTypeDifferent(type: string) : boolean {\r\n    return  type != AssignType[this.type];\r\n  }\r\n\r\n  public typeAsString() : string {\r\n    return AssignType[this.type];\r\n  }\r\n\r\n  public showExtraFields() : boolean {\r\n    switch (this.type) {\r\n      case AssignType.BK_CHANNEL:\r\n        return false;\r\n      case AssignType.DTN_COPY:\r\n      case AssignType.FEED_DTN_COPY:\r\n        return true;  \r\n    }\r\n  }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/app/models/routing-amh/assignment-config.model.ts","\r\n \r\nexport class AssignmentList {\r\n  public active: boolean;\r\n  public code: string;\r\n  public backCode: string;\r\n  public backDirection: string;\r\n  public backName: string;\r\n  public backSequence: number;\r\n  public ruleCode: string;\r\n  public ruleExpressions: string;\r\n  public ruleSequence: number;\r\n  public environment: string;\r\n  public version: string;\r\n  \r\n  constructor(active: boolean, code: string, backCode: string, backDirection: string, backName: string, backSequence: number, \r\n              ruleCode: string, ruleExpressions: string, ruleSequence: number, environment : string, version : string ) {\r\n    this.active = active;\r\n    this.code = code;\r\n    this.backCode = backCode;\r\n    this.backDirection = backDirection;\r\n    this.backName = backName;\r\n    this.backSequence = backSequence;\r\n    this.ruleCode = ruleCode;\r\n    this.ruleExpressions = ruleExpressions;\r\n    this.ruleSequence  = ruleSequence;\r\n    this.environment = environment;\r\n    this.version = version;\r\n  }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/app/models/routing-amh/assignment-list.model.ts","\r\nexport class AssignmentRule {\r\n  public code: string;\r\n  public dataOwner: string;\r\n  public lockCode: string;\r\n  public sequence: number;\r\n  public expression:string;\r\n  public environment: string;\r\n  public version: string;\r\n\r\n  constructor(code: string, dataOwner: string, lockCode: string, sequence: number,  environment: string, version: string, expression?:string) {\r\n    this.code = code;\r\n    this.dataOwner = dataOwner;\r\n    this.lockCode = lockCode;\r\n    this.sequence = sequence;\r\n    this.environment = environment;\r\n    this.version = version;\r\n    this.expression = expression;\r\n  }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/app/models/routing-amh/assignment-rule.model.ts","\r\nexport enum AssignType {\r\n  BK_CHANNEL    = 1 << 0,\r\n  DTN_COPY      = 1 << 1,\r\n  FEED_DTN_COPY = 1 << 2\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/app/models/routing-amh/assignment-type.model.ts","import {AssignType} from './assignment-type.model';\r\n\r\nexport class AssignmentUniqueBackend {\r\n  public code: string;\r\n  public direction: string;\r\n  public dataOwner: string;\r\n  public lockCode: string;\r\n  \r\n  constructor(code: string, direction:string, dataOwner?: string, lockCode?: string) {\r\n    this.code = code;\r\n    this.direction = direction;\r\n    this.dataOwner = dataOwner;\r\n    this.lockCode = lockCode;\r\n  }\r\n\r\n  public toWriteModel(type: AssignType, assignmentCode: string, environment: string, version: string, modificationUserId : string,  modificationDate: string, creationUserId? : string, creationDate?: string): any {\r\n    switch (type) {\r\n      case AssignType.DTN_COPY:\r\n      case AssignType.FEED_DTN_COPY:\r\n        return {\r\n          code: assignmentCode,\r\n          backCode: this.code,\r\n          backDirection: this.direction,\r\n          dataOwner: this.dataOwner,\r\n          lockCode: this.lockCode,\r\n          environment: environment,\r\n          version: version,\r\n          modificationUserId : modificationUserId,\r\n          modificationDate : modificationDate,\r\n          creationUserId : creationUserId,\r\n          creationDate : creationDate\r\n        }\r\n        default: \r\n        return {}\r\n    }\r\n  }\r\n\r\n  public static fromJson(json : any) : AssignmentUniqueBackend {\r\n      return new AssignmentUniqueBackend(json.code, json.direction, json.dataOwner, json.lockCode); \r\n  }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/app/models/routing-amh/assignment-unique-backend.model.ts","import {AssignType} from './assignment-type.model';\r\n\r\nexport class AssignmentUniqueRule {\r\n  public code: string;\r\n  public dataOwner: string;\r\n  public lockCode: string;\r\n  public sequence: number;\r\n  public expression: string;\r\n //UI properties\r\n public selected : boolean;\r\n \r\n  constructor(code: string, dataOwner: string, lockCode: string, sequence: number, expression?: string) {\r\n    this.code = code;\r\n    this.dataOwner = dataOwner;\r\n    this.lockCode = lockCode;\r\n    this.sequence = sequence;\r\n    this.expression = expression;\r\n  }\r\n\r\n  public toWriteModel(type: AssignType, assignmentCode: string, environment: string, version: string, modificationUserId : string,  modificationDate: string, creationUserId? : string, creationDate?: string): any {\r\n    switch (type) {\r\n      case AssignType.BK_CHANNEL:\r\n      case AssignType.DTN_COPY:\r\n      case AssignType.FEED_DTN_COPY:\r\n        return {\r\n            code: assignmentCode,\r\n            sequence: this.sequence,\r\n            ruleCode: this.code,\r\n            dataOwner: this.dataOwner,\r\n            lockCode: this.lockCode,\r\n            environment: environment,\r\n            version: version,\r\n            modificationUserId : modificationUserId,\r\n            modificationDate : modificationDate,\r\n            creationUserId : creationUserId,\r\n            creationDate : creationDate\r\n          };\r\n    }\r\n  }\r\n\r\n  public static fromJson(json : any) : AssignmentUniqueRule {\r\n      return new AssignmentUniqueRule(json.code, json.dataOwner, json.lockCode, json.sequence, json.expression); \r\n  }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/app/models/routing-amh/assignment-unique-rule.model.ts","import {BackendPK} from './backend-pk.model';\r\nimport {AssignmentUniqueBackend} from './assignment-unique-backend.model';\r\nimport {AssignmentUniqueRule} from './assignment-unique-rule.model';\r\nimport {AssignType} from './assignment-type.model';\r\n\r\nexport class AssignmentUnique {\r\n  public active: boolean;\r\n  public code: string;\r\n  public backendPrimaryKey: BackendPK;\r\n  public dataOwner: string;\r\n  public description: string;\r\n  public lockCode: string;\r\n  public sequence: number;\r\n  public copies: number;\r\n  public name: string;\r\n  public environment: string;\r\n  public version: string;\r\n  public rules: Array<AssignmentUniqueRule>;\r\n  public backends: Array<AssignmentUniqueBackend>;\r\n\r\n  constructor(active?: boolean, backendPrimaryKey?: BackendPK, code?: string, dataOwner?: string, description?: string, lockCode?: string, sequence?: number, copies?: number, name?: string, environment?: string, version?: string, rules?: Array<AssignmentUniqueRule>, backends?: Array<AssignmentUniqueBackend>) {\r\n    this.active = active;\r\n    this.backendPrimaryKey = backendPrimaryKey;\r\n    this.code = code;\r\n    this.dataOwner = dataOwner;\r\n    this.description = description;\r\n    this.lockCode = lockCode;\r\n    this.sequence = sequence || undefined;\r\n    this.copies = copies || undefined;\r\n    this.name = name;\r\n    this.environment = environment;\r\n    this.version = version;\r\n    this.rules = rules || [];\r\n    this.backends = backends || [];\r\n  }\r\n\r\n  public backendCodeList() : Array<string> {\r\n    return this.backendPrimaryKey ? [this.backendPrimaryKey.code] : this.backends.map(backend => backend.code);\r\n  }\r\n\r\n  public toWriteModel(type: AssignType, environment: string, version: string, modificationUserId : string,  modificationDate: string, creationUserId? : string, creationDate?: string): any {\r\n    let rules: Array<AssignmentUniqueRule> = this.rules || [];\r\n    rules = rules.map(rule => rule.toWriteModel(type, this.code, environment, version, modificationUserId,  modificationDate, creationUserId, creationDate));\r\n    \r\n    let backends: Array<AssignmentUniqueBackend> = this.backends || [];\r\n    backends = backends.map(backend => backend.toWriteModel(type, this.code, environment, version, modificationUserId,  modificationDate, creationUserId, creationDate));\r\n\r\n    let writeModelObj = {\r\n      sequence: this.sequence,\r\n      active: String(this.active),\r\n      dataOwner: this.dataOwner,\r\n      lockCode: this.lockCode,\r\n      description: this.description,\r\n      environment: environment,\r\n      version: version,\r\n      rules: rules,\r\n      modificationUserId : modificationUserId,\r\n      modificationDate : modificationDate,\r\n      creationUserId : creationUserId,\r\n      creationDate : creationDate\r\n    };\r\n    \r\n\r\n    switch (type) {\r\n      case AssignType.BK_CHANNEL:\r\n        \r\n        writeModelObj[\"backCode\"] = this.backendPrimaryKey.code;\r\n        writeModelObj[\"backDirection\"] = this.backendPrimaryKey.direction;\r\n        break;\r\n      \r\n      case AssignType.DTN_COPY:\r\n      case AssignType.FEED_DTN_COPY:\r\n\r\n        writeModelObj[\"copies\"] = this.copies;\r\n        writeModelObj[\"name\"] = this.name;\r\n        writeModelObj[\"backends\"] = backends;\r\n        break;\r\n    }\r\n\r\n    return writeModelObj;\r\n  }\r\n\r\n  public static fromJson(json: any): AssignmentUnique {\r\n    let rules: Array<AssignmentUniqueRule> = json.rules || [];\r\n    let backends: Array<AssignmentUniqueBackend> = json.backends || [];\r\n\r\n    return new AssignmentUnique(json.active, json.backendPrimaryKey, json.code, json.dataOwner, json.description, json.lockCode, json.sequence, json.copies, json.name, json.environment, json.version,\r\n      rules.map(rule => AssignmentUniqueRule.fromJson(rule)),\r\n      backends.map(backend => AssignmentUniqueBackend.fromJson(backend)));\r\n  }\r\n \r\n  \r\n\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/app/models/routing-amh/assignment-unique.model.ts","\r\nimport {BackendPK} from './backend-pk.model';\r\nimport {AssignmentRule} from './assignment-rule.model';\r\n \r\nexport class Assignment {\r\n  public active: boolean;\r\n  public backendPrimaryKey: BackendPK;\r\n  public code: string;\r\n  public dataOwner: string;\r\n  public description: string;\r\n  public lockCode: string;\r\n  public sequence: number;\r\n  public environment: string;\r\n  public version: string;\r\n  public rules: AssignmentRule[];\r\n\r\n  constructor(active?: boolean, backendPrimaryKey?: BackendPK, code?: string, dataOwner?: string, description?: string, lockCode?: string, sequence?: number, environment?: string, version?: string, rules?: AssignmentRule[]) {\r\n    this.active = active;\r\n    this.backendPrimaryKey = backendPrimaryKey;\r\n    this.code = code;\r\n    this.dataOwner = dataOwner;\r\n    this.description = description;\r\n    this.lockCode = lockCode;\r\n    this.sequence = sequence;\r\n    this.environment =environment;\r\n    this.version = version;\r\n    this.rules = rules || [];\r\n  }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/app/models/routing-amh/assignment.model.ts","export class BackendPK {\r\n  public code: string;\r\n  public direction: string;\r\n\r\n  constructor(code: string, direction: string) {\r\n    this.code = code;\r\n    this.direction = direction;\r\n  }\r\n\r\n  static hashPK(pk: BackendPK): string {\r\n    return pk.code.toString() + \"@\" + pk.direction.toString();\r\n  }\r\n  \r\n  static hash(code: string, direction: string): string {\r\n    return code.toString() + \"@\" + direction.toString();\r\n  }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/app/models/routing-amh/backend-pk.model.ts","import {BackendPK} from './backend-pk.model';\r\n\r\n\r\nexport class Backend {\r\n  public pkCode: string;\r\n  public pkDirection: string;\r\n  public code: string;\r\n  public name: string;\r\n  public dataOwner: string;\r\n  public description: string;\r\n  public lockCode: string;\r\n\r\n  constructor(pkCode:string, pkDirection:string, code?: string, dataOwner?: string, description?: string, lockCode?: string, name?: string) {\r\n    this.pkCode = pkCode;\r\n    this.pkDirection = pkDirection;\r\n    this.code = code;\r\n    this.dataOwner = dataOwner;\r\n    this.description = description;\r\n    this.lockCode = lockCode;\r\n    this.name = name;\r\n  }\r\n\r\n\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/app/models/routing-amh/backend.model.ts","\r\nexport * from './assignment-rule.model';\r\nexport * from './assignment.model';\r\nexport * from './assignment-list.model';\r\nexport * from './backend-pk.model';\r\nexport * from './backend.model';\r\nexport * from './rule.model';\r\nexport * from './assignment-unique.model';\r\nexport * from './assignment-unique-rule.model';\r\nexport * from './assignment-unique-backend.model';\r\nexport * from './assignment-type.model';\r\nexport * from './assignment-config.model';\r\nexport * from './rule-assign-type.model';\n\n\n// WEBPACK FOOTER //\n// ./src/app/models/routing-amh/index.ts","\r\nexport enum RuleAssignType {\r\n  ALL        = 1 << 0,\r\n  ASSIGNED   = 1 << 1,\r\n  UNASSIGNED = 1 << 2\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/app/models/routing-amh/rule-assign-type.model.ts","import {BaseAudit} from '../audit';\r\n\r\nexport class AMHRule extends BaseAudit {\r\n  public code: string;\r\n  public dataOwner: string;\r\n  public expression: string;\r\n  public lockCode: string;\r\n  public type: string;\r\n  public environment: string;\r\n  public version: string;\r\n  //UI fields\r\n  public selected: boolean = false;\r\n  \r\n constructor(code: string, expression: string, dataOwner?: string,  lockCode?: string, type?: string, environment?: string, version?: string) {\r\n   super();\r\n   this.code=code;\r\n  this.dataOwner=dataOwner;\r\n  this.expression=expression;\r\n  this.lockCode=lockCode;\r\n  this.type=type;\r\n }\r\n \r\n\r\npublic toWriteModel() : any {\r\n   return {\r\n     expression : this.expression,\r\n     dataOwner : this.dataOwner,\r\n     lockCode : this.lockCode,\r\n     ruleType: this.type,\r\n     environment: this.environment,\r\n     version: this.version,\r\n     modificationUserId : this.modificationUserId,\r\n     modificationDate: this.modificationDate, \r\n     creationUserId : this.creationUserId,\r\n    creationDate: this.creationDate \r\n    }\r\n  };\r\n\r\n public setEnvAndVersion(environment: string, version: string) {\r\n    this.environment = environment;\r\n    this.version = version;\r\n  }\r\n\r\n  public cloneWithUpperCaseCode() : AMHRule {\r\n    return new AMHRule(this.code.toUpperCase(), this.expression, this.dataOwner,  this.lockCode, this.type, this.environment, this.version);\r\n  }\r\n\r\n  public static fromJson(json : any) : AMHRule {\r\n      return new AMHRule(json.code, json.expression, json.dataOwner, json.lockCode, json.type, json.environment, json.version); \r\n  }\r\n\r\n\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/app/models/routing-amh/rule.model.ts","export enum ActionOn {\r\n  Source = 1 << 0,\r\n  NewInstance = 1 << 1,\r\n  SourceAndNewInstance = 1 << 2\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/app/models/routing/action-on.model.ts","import {IdCodeDescription} from '../referential';\r\nimport {Source} from './source.model';\r\nimport {NewInstance} from './new-instance.model';\r\n\r\nexport class Action {\r\n  public actionOn: IdCodeDescription;\r\n  public source: Source;\r\n  public newInstance: NewInstance;\r\n  \r\n//   constructor();\r\n  constructor(actionOn?: IdCodeDescription, source?:Source, newInstance?:NewInstance) {\r\n      this.actionOn = actionOn;\r\n      this.source = source;\r\n      this.newInstance = newInstance;\r\n  }\r\n\r\n  public static empty() : Action {\r\n    return new Action(IdCodeDescription.empty(), Source.empty(), NewInstance.empty());\r\n  }\r\n\r\n  public update(that : Action) {\r\n    // this.actionOn = that.actionOn || this.actionOn;\r\n    // this.source = that.source || this.source;\r\n    // this.newInstance = that.newInstance || this.newInstance;\r\n    Action.updateField(that, [\"actionOn\",\"source\",\"newInstance\"], this);\r\n  }\r\n\r\n  public toWriteModel()  : any { \r\n    /*\r\n  \"action\": {\r\n    \"actionOn\": \"SOURCE\",\r\n\t\"instanceAction\": \"ACTION_TYPE_COMPLETE\",\r\n\t\"instanceInterventionType\": \"INTV_NO_INTV\",\r\n\t\"instanceInterventionTypeText\": null,\r\n\t\"instanceRoutingCode\": \"IFR-S\",\r\n\t\"instanceTargetQueue\": null,\r\n\t\"instanceUnit\": null,\r\n\t\"instancePriority\": null,\r\n\t\"newInstanceAction\": null,\r\n\t\"newInstanceRoutingCode\": null,\r\n\t\"newInstanceInterventionType\": null,\r\n\t\"newInstanceInterventionTypeText\": null,\r\n\t\"newInstanceTargetQueue\": null,\r\n\t\"newInstanceType\": null,\r\n\t\"newInstanceUnit\": null,\r\n\t\"newInstancePriority\": null\r\n  }, \r\n  \"condition\":{\r\n    \"conditionOn\": \"MESSAGE\",\r\n\t  \"criteria\": \"(Sender = 'PARBFRPP') and (SibesBranchCodeE = 'XXX') and (SibesFlux like '&PS%') and (SibesService like '0243%,0246%,4678%,9881%')\",\r\n\t  \"functionList\": null\r\n  }\r\n */\r\n   let actionOn  = this.actionOn.id == 1 ? \"SOURCE\" : this.actionOn.id == 2 ? \"NEW_INSTANCE\" : \"SOURCE_AND_NEW_INSTANCE\";\r\n   let instanceType =  this.newInstance.instanceType +  (this.newInstance.instanceTypeOption ? \"_\"+this.newInstance.instanceTypeOption : \"\");\r\n  \r\n    return {\r\n    \"actionOn\": actionOn,\r\n\t\"instanceAction\": this.source.action,\r\n\t\"instanceInterventionType\": this.source.intervention,\r\n\t\"instanceInterventionTypeText\": this.source.interventionText,\r\n\t\"instanceRoutingCode\": this.source.routingCode,\r\n\t\"instanceTargetQueue\": this.source.actionOption,\r\n\t\"instanceUnit\": this.source.unit,\r\n\t\"instancePriority\": this.source.priority,\r\n\t\"newInstanceAction\": this.newInstance.action,\r\n\t\"newInstanceRoutingCode\": this.newInstance.routingCode,\r\n\t\"newInstanceInterventionType\": this.newInstance.intervention,\r\n\t\"newInstanceInterventionTypeText\": this.newInstance.interventionText,\r\n\t\"newInstanceTargetQueue\": this.newInstance.actionOption,\r\n\t\"newInstanceType\": instanceType,\r\n\t\"newInstanceUnit\": this.newInstance.unit,\r\n\t\"newInstancePriority\": this.newInstance.priority\r\n    };\r\n  }\r\n\r\n  static updateField(orig : any, fields : Array<string>, dest : any) {\r\n    fields.forEach( f => dest[f] = orig[f] || dest[f]);\r\n  }\r\n  \r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/app/models/routing/action.model.ts","export enum ConditionType {\r\n  MESSAGE = 1 << 0,\r\n  FUNCTION = 1 << 1,\r\n  MESSAGEANDFUNCTION = 1 << 2,\r\n  ALWAYS = 1 << 3\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/app/models/routing/condition-type.model.ts","import {IdCodeDescription} from '../referential';\r\nimport {updateFields} from '../referential';\r\n\r\n\r\nexport class Condition {\r\n  public conditionOn: IdCodeDescription;\r\n  public functions: IdCodeDescription[];\r\n  public message: string;\r\n\r\n  constructor(conditionOn?: IdCodeDescription, functions?: IdCodeDescription[], message?: string) {\r\n    this.conditionOn = conditionOn;\r\n    this.functions = functions;\r\n    this.message = message;\r\n  }\r\n\r\n  static empty(): Condition {\r\n    return new Condition(IdCodeDescription.empty(), [], \"\");\r\n  }\r\n\r\n  public update(that: Condition) {\r\n    updateFields(this, that, [\"conditionOn\", \"functions\", \"message\"]);\r\n  }\r\n\r\n  public toWriteModel(): any {\r\n    let functionsWriteModel = undefined;\r\n\r\n    if (this.functions && this.functions.length > 0) {\r\n       functionsWriteModel = this.functions.reduce(\r\n                (acc, cur) => {\r\n                  return acc.length > 0 ? acc + \",\" + cur.description : cur.description;\r\n                }, \"\");\r\n    }\r\n\r\n    let conditionOn = this.conditionOn.id == 1 ? \"MESSAGE\" : this.conditionOn.id == 2 ? \"FUNCTION\" : \"MESSAGE_AND_FUNCTION\";\r\n    \r\n    return {\r\n      \"conditionOn\": conditionOn,\r\n      \"criteria\": this.conditionOn.id != 2 ? this.message : \"\",\r\n      \"functionList\": this.conditionOn.id != 1 ? functionsWriteModel : \"\"\r\n    };\r\n  }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/app/models/routing/condition.model.ts","\r\nexport * from './action-on.model';\r\nexport * from './action.model';\r\nexport * from './condition-type.model';\r\nexport * from './condition.model';\r\nexport * from './new-instance.model';\r\nexport * from './rule.model';\r\nexport * from './source.model';\r\nexport * from './point.model';\r\nexport * from './point-list.model';\n\n\n// WEBPACK FOOTER //\n// ./src/app/models/routing/index.ts","import {Source} from './source.model';\r\n\r\nexport class NewInstance extends Source {\r\n  public instanceType: string;\r\n  public instanceTypeOption: string;\r\n  \r\n  constructor(instanceType?: string, instanceTypeOption?: string, action?: string, actionOption?: string, intervention?: string, interventionText?: string, unit?: string, routingCode?: string, priority?: string){\r\n      super(action, actionOption, intervention, interventionText, unit, routingCode, priority);\r\n      this.instanceType = instanceType;\r\n      this.instanceTypeOption = instanceTypeOption;\r\n  }\r\n\r\n  static empty () : NewInstance {\r\n    return new NewInstance(\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\");\r\n  }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/app/models/routing/new-instance.model.ts","\r\nexport class PointList {\r\n  public pointName: string;\r\n  public schemas: string;\r\n  public ruleSeq: number;\r\n  public ruleDescription: string;\r\n  public ruleMessage: string;\r\n  public originalPoint : String;\r\n  public originalCode : String;\r\n  public copyPoint : String;\r\n  public copyCode : String;\r\n\r\nconstructor(pointName: string, schemas: string, ruleSeq: number, ruleDescription : string, ruleMessage : string, \r\n            originalPoint? : String, originalCode? : String, copyPoint? : String, copyCode? : String) {\r\n    this.pointName = pointName;\r\n    this.schemas = schemas;\r\n    this.ruleSeq = ruleSeq;\r\n    this.ruleDescription = ruleDescription;\r\n    this.ruleMessage = ruleMessage;\r\n    this.originalPoint = originalPoint;\r\n    this.originalCode = originalCode;\r\n    this.copyPoint = copyPoint;\r\n    this.copyCode = copyCode;\r\n  }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/app/models/routing/point-list.model.ts","import {Rule} from './rule.model';\r\n\r\nexport class Point {\r\n  public pointName: string;\r\n  public full: boolean;\r\n  public rules: Rule[];\r\n  \r\n  constructor(pointName: string, full: boolean, rules: Rule[]) {\r\n    this.pointName = pointName;\r\n    this.full = full;\r\n    this.rules = rules;\r\n  }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/app/models/routing/point.model.ts","import {Condition} from './condition.model';\r\nimport {Action} from './action.model';\r\nimport {updateFields} from '../referential';\r\n\r\nexport class Rule {\r\n  public sequence: number;\r\n  public routingPoint: string;\r\n  public description: string;\r\n  public schemas: string[];\r\n  public lastModification: Date;\r\n  public creationDate: Date;\r\n  public createdBy: string;\r\n  public condition: Condition;\r\n  public action: Action;\r\n\r\n  constructor(sequence: number, routingPoint: string, description?: string, schemas?: string[], lastModification?: Date, creationDate?: Date, createdBy?: string, condition?: Condition, action?: Action) {\r\n    this.sequence = sequence; \r\n    this.routingPoint = routingPoint;\r\n    this.description = description;\r\n    this.schemas = schemas;\r\n    this.lastModification = lastModification;\r\n    this.creationDate = creationDate;\r\n    this.createdBy = createdBy;\r\n    this.condition = condition;\r\n    this.action = action; \r\n  }\r\n\r\n  public static empty() : Rule {\r\n    return new Rule(undefined, \"\",\"\",[],undefined, undefined, undefined, Condition.empty(), Action.empty());\r\n  }\r\n\r\n  public update( that : Rule) {\r\n    updateFields(this, that, [\"sequence\",\"routingPoint\",\"description\"\r\n    ,\"schemas\",\"lastModification\",\"creationDate\",\"createdBy\"]);\r\n    this.condition.update(that.condition);\r\n    this.action.update(that.action);\r\n  }\r\n\r\n  public toWriteModel(environment : string, version : string) : any {\r\n    return {\r\n      \"full\" : \"true\",\r\n      \"ruleDescription\" : this.description,\r\n      \"environment\" : environment,\r\n      \"version\" : version,\r\n      \"action\" : this.action.toWriteModel(),\r\n      \"condition\" : this.condition.toWriteModel()\r\n    };\r\n  }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/app/models/routing/rule.model.ts","\r\nexport class Source {\r\n  public action: string;\r\n  public actionOption: string;\r\n  public intervention: string;\r\n  public interventionText: string;\r\n  public unit: string;\r\n  public routingCode: string;\r\n  public priority: string;\r\n\r\n  //   constructor();\r\n  constructor(action?: string, actionOption?: string, intervention?: string, interventionText?: string, unit?: string, routingCode?: string, priority?: string) {\r\n    this.action = action;\r\n    this.actionOption = actionOption;\r\n    this.intervention = intervention;\r\n    this.interventionText = interventionText;\r\n    this.unit = unit;\r\n    this.routingCode = routingCode;\r\n    this.priority = priority;\r\n  }\r\n\r\n  static empty() : Source {\r\n    return new Source(\"\", \"\", \"\", \"\", \"\", \"\", \"\");\r\n  }  \r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/app/models/routing/source.model.ts","export * from './saa-routing.component';\r\nexport * from './saa-routing.service';\n\n\n// WEBPACK FOOTER //\n// ./src/app/saa-routing/index.ts","module.exports = function (namespace) {\n  return new Promise(function (resolve) {\n    require.ensure([], function (require) {\n      if (namespace) {\n        resolve(require(\"!!C:\\\\dev\\\\projects\\\\angular\\\\groupaxis\\\\01-RELEASE-v1.0\\\\node_modules\\\\awesome-typescript-loader\\\\dist.babel\\\\entry.js!C:\\\\dev\\\\projects\\\\angular\\\\groupaxis\\\\01-RELEASE-v1.0\\\\src\\\\app\\\\saa-routing\\\\saa-export-import\\\\index.ts\")[namespace]);\n      } else {\n        var mod = require(\"!!C:\\\\dev\\\\projects\\\\angular\\\\groupaxis\\\\01-RELEASE-v1.0\\\\node_modules\\\\awesome-typescript-loader\\\\dist.babel\\\\entry.js!C:\\\\dev\\\\projects\\\\angular\\\\groupaxis\\\\01-RELEASE-v1.0\\\\src\\\\app\\\\saa-routing\\\\saa-export-import\\\\index.ts\");\n        resolve(mod.__esModule ? mod.default : mod)\n      }\n    });\n  });\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/es6-promise-loader!./src/app/saa-routing/saa-export-import/index.ts\n// module id = 1218\n// module chunks = 1","module.exports = function (namespace) {\n  return new Promise(function (resolve) {\n    require.ensure([], function (require) {\n      if (namespace) {\n        resolve(require(\"!!C:\\\\dev\\\\projects\\\\angular\\\\groupaxis\\\\01-RELEASE-v1.0\\\\node_modules\\\\awesome-typescript-loader\\\\dist.babel\\\\entry.js!C:\\\\dev\\\\projects\\\\angular\\\\groupaxis\\\\01-RELEASE-v1.0\\\\src\\\\app\\\\saa-routing\\\\saa-points-overview\\\\index.ts\")[namespace]);\n      } else {\n        var mod = require(\"!!C:\\\\dev\\\\projects\\\\angular\\\\groupaxis\\\\01-RELEASE-v1.0\\\\node_modules\\\\awesome-typescript-loader\\\\dist.babel\\\\entry.js!C:\\\\dev\\\\projects\\\\angular\\\\groupaxis\\\\01-RELEASE-v1.0\\\\src\\\\app\\\\saa-routing\\\\saa-points-overview\\\\index.ts\");\n        resolve(mod.__esModule ? mod.default : mod)\n      }\n    });\n  });\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/es6-promise-loader!./src/app/saa-routing/saa-points-overview/index.ts\n// module id = 1257\n// module chunks = 1","module.exports = function (namespace) {\n  return new Promise(function (resolve) {\n    require.ensure([], function (require) {\n      if (namespace) {\n        resolve(require(\"!!C:\\\\dev\\\\projects\\\\angular\\\\groupaxis\\\\01-RELEASE-v1.0\\\\node_modules\\\\awesome-typescript-loader\\\\dist.babel\\\\entry.js!C:\\\\dev\\\\projects\\\\angular\\\\groupaxis\\\\01-RELEASE-v1.0\\\\src\\\\app\\\\saa-routing\\\\saa-routing-home\\\\index.ts\")[namespace]);\n      } else {\n        var mod = require(\"!!C:\\\\dev\\\\projects\\\\angular\\\\groupaxis\\\\01-RELEASE-v1.0\\\\node_modules\\\\awesome-typescript-loader\\\\dist.babel\\\\entry.js!C:\\\\dev\\\\projects\\\\angular\\\\groupaxis\\\\01-RELEASE-v1.0\\\\src\\\\app\\\\saa-routing\\\\saa-routing-home\\\\index.ts\");\n        resolve(mod.__esModule ? mod.default : mod)\n      }\n    });\n  });\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/es6-promise-loader!./src/app/saa-routing/saa-routing-home/index.ts\n// module id = 1258\n// module chunks = 1","module.exports = function (namespace) {\n  return new Promise(function (resolve) {\n    require.ensure([], function (require) {\n      if (namespace) {\n        resolve(require(\"!!C:\\\\dev\\\\projects\\\\angular\\\\groupaxis\\\\01-RELEASE-v1.0\\\\node_modules\\\\awesome-typescript-loader\\\\dist.babel\\\\entry.js!C:\\\\dev\\\\projects\\\\angular\\\\groupaxis\\\\01-RELEASE-v1.0\\\\src\\\\app\\\\saa-routing\\\\saa-routing-point\\\\index.ts\")[namespace]);\n      } else {\n        var mod = require(\"!!C:\\\\dev\\\\projects\\\\angular\\\\groupaxis\\\\01-RELEASE-v1.0\\\\node_modules\\\\awesome-typescript-loader\\\\dist.babel\\\\entry.js!C:\\\\dev\\\\projects\\\\angular\\\\groupaxis\\\\01-RELEASE-v1.0\\\\src\\\\app\\\\saa-routing\\\\saa-routing-point\\\\index.ts\");\n        resolve(mod.__esModule ? mod.default : mod)\n      }\n    });\n  });\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/es6-promise-loader!./src/app/saa-routing/saa-routing-point/index.ts\n// module id = 1219\n// module chunks = 1","module.exports = function (namespace) {\n  return new Promise(function (resolve) {\n    require.ensure([], function (require) {\n      if (namespace) {\n        resolve(require(\"!!C:\\\\dev\\\\projects\\\\angular\\\\groupaxis\\\\01-RELEASE-v1.0\\\\node_modules\\\\awesome-typescript-loader\\\\dist.babel\\\\entry.js!C:\\\\dev\\\\projects\\\\angular\\\\groupaxis\\\\01-RELEASE-v1.0\\\\src\\\\app\\\\saa-routing\\\\saa-routing-rule\\\\index.ts\")[namespace]);\n      } else {\n        var mod = require(\"!!C:\\\\dev\\\\projects\\\\angular\\\\groupaxis\\\\01-RELEASE-v1.0\\\\node_modules\\\\awesome-typescript-loader\\\\dist.babel\\\\entry.js!C:\\\\dev\\\\projects\\\\angular\\\\groupaxis\\\\01-RELEASE-v1.0\\\\src\\\\app\\\\saa-routing\\\\saa-routing-rule\\\\index.ts\");\n        resolve(mod.__esModule ? mod.default : mod)\n      }\n    });\n  });\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/es6-promise-loader!./src/app/saa-routing/saa-routing-rule/index.ts\n// module id = 1220\n// module chunks = 1","import {Component} from 'angular2/core';\r\nimport {ROUTER_DIRECTIVES, RouteConfig, RouteParams} from 'angular2/router';\r\n\r\n// console.log('`SAARouting` component loaded asynchronously');\r\n\r\n@Component({\r\n  selector: 'saa-routing',\r\n//   styles: [`\r\n//     h1 {\r\n//       font-family: Arial, Helvetica, sans-serif\r\n//     }\r\n//   `],\r\n  directives: [ROUTER_DIRECTIVES],\r\n  template: `\r\n    <router-outlet></router-outlet>\r\n  `\r\n})\r\n@RouteConfig([\r\n  { path: '/', name: 'SAARoutingHome', loader: () => require('es6-promise!./saa-routing-home')('SAARoutingHome'), useAsDefault: true },\r\n  { path: '/routing-overview', name: 'PointsOverview', loader: () => require('es6-promise!./saa-points-overview')('SAAPointsOverviewComponent') },\r\n  { path: '/routing-point/create', name: 'PointCreate', loader: () => require('es6-promise!./saa-routing-point')('SAARoutingPoint') },\r\n  { path: '/routing-point/:id/edit', name: 'PointEdit', loader: () => require('es6-promise!./saa-routing-point')('SAARoutingPoint') },  \r\n  { path: '/routing-rule/create', name: 'RuleCreate', loader: () => require('es6-promise!./saa-routing-rule')('SAARoutingRule') },\r\n  { path: '/routing-rule/:pointName/:sequence/edit', name: 'RuleEdit', loader: () => require('es6-promise!./saa-routing-rule')('SAARoutingRule') },\r\n  { path: '/export', name: 'SAAExport', loader: () => require('es6-promise!./saa-export-import')('SAAExportImportComponent') },\r\n  { path: '/simulation', name: 'SAASimulation', loader: () => require('es6-promise!./saa-simulator')('SAASimulatorComponent') },\r\n  { path: '/import', name: 'SAAImport', loader: () => require('es6-promise!./saa-export-import')('SAAExportImportComponent') }\r\n])\r\nexport class SAARouting {\r\n  constructor() {\r\n\r\n  }\r\n\r\n  ngOnInit() {\r\n    // console.log('hello `SAA Routing` component');\r\n    // static data that is bundled\r\n    // var mockData = require('assets/mock-data/mock-data.json');\r\n    // console.log('mockData', mockData);\r\n    // if you're working with mock data you can also use http.get('assets/mock-data/mock-data.json')\r\n    // this.asyncDataWithWebpack();\r\n  }\r\n  asyncDataWithWebpack() {\r\n    // you can also async load mock data with 'es6-promise-loader'\r\n    // you would do this if you don't want the mock-data bundled\r\n    // remember that 'es6-promise-loader' is a promise\r\n    // var asyncMockDataPromiseFactory = require('es6-promise!assets/mock-data/mock-data.json');\r\n    // setTimeout(() => {\r\n    //\r\n    //   let asyncDataPromise = asyncMockDataPromiseFactory();\r\n    //   asyncDataPromise.then(json => {\r\n    //     console.log('async mockData', json);\r\n    //   });\r\n    //\r\n    // });\r\n  }\r\n\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/saa-routing/saa-routing.component.ts","import { Headers, RequestOptions, Http } from 'angular2/http';\r\nimport { Injectable } from 'angular2/core';\r\nimport { Observable } from 'rxjs/Observable';\r\nimport { Assignment, AssignmentRule, AssignmentList, AMHRule, Backend, BackendPK } from '../models/routing-amh';\r\nimport { Rule } from '../models/routing';\r\nimport { TreeNode } from '../common/components/ui/widgets/tree-view';\r\nimport { Config, Logger } from '../common/components/services';\r\nimport { Point, PointList } from \"../models/routing\";\r\nimport { Option } from '../models/referential/option';\r\nimport 'rxjs/add/operator/reduce';\r\n\r\n@Injectable()\r\nexport class SAARoutingService {\r\n  private schemaClause = `\r\n  {\r\n    \"match\": {\r\n        \"rules.schemas\": {\r\n        \"query\": \"##TO_REPLACE##\",\r\n        \"analyzer\": \"standard\",\r\n        \"operator\": \"and\"\r\n        }\r\n      }\r\n  }\r\n  `;\r\n  private pointsBySchemaQuery = `\r\n  { \r\n    \"query\": {\r\n    \"bool\": {\r\n      \"must\": [\r\n        {\r\n          \"nested\": {\r\n            \"path\": \"rules\",\r\n            \"query\": {\r\n              \"bool\": {\r\n                \"should\": [\r\n                  ##MATCH_CLAUSES##\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      ]\r\n    }\r\n  }\r\n    ##FILTER_RULES_CLAUSE##\r\n    ##RANGE_SORT_CLAUSE##\r\n  }`;\r\n\r\n  private filterRules : string = `\r\n  ,\r\n  \"filter\":{\r\n    ##RULE_CLAUSE##\r\n  }`;\r\n\r\n  private query: string = ` \r\n    {\r\n  \"query\": {\r\n    ##RULE_CLAUSE##\r\n  }\r\n  ##RANGE_SORT_CLAUSE##\r\n}\r\n  `;\r\n\r\n  private fromSortClauses = `\r\n  ,\r\n  \"from\": 0,\r\n  \"size\": 1000,\r\n  \"sort\": [\r\n    {\r\n      \"pointName\": {\r\n        \"order\": \"asc\"\r\n      }\r\n    },\r\n    {\r\n      \"rules.sequence\": {\r\n        \"order\": \"desc\"\r\n      }\r\n    }\r\n  ]\r\n  `;\r\n\r\n  private queryRule: string = ` \r\n    \"bool\": {\r\n      \"should\": [\r\n        {\r\n          \"match\": {\r\n            \"pointName\": {\r\n              \"query\": \"##TO_REPLACE##\",\r\n              \"analyzer\": \"standard\",\r\n              \"operator\": \"and\"\r\n            }\r\n          }\r\n        },\r\n        {\r\n          \"nested\": {\r\n            \"path\": \"rules.condition\",\r\n            \"query\": {\r\n              \"bool\": {\r\n                \"must\": [\r\n                  {\r\n                    \"match\": {\r\n                      \"rules.condition.message\": {\r\n                        \"query\": \"##TO_REPLACE##\",\r\n                        \"analyzer\": \"standard\",\r\n                        \"operator\": \"and\"\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }  \r\n        },\r\n        {\r\n          \"nested\": {\r\n            \"path\": \"rules\",\r\n            \"query\": {\r\n              \"bool\": {\r\n                \"must\": [\r\n                  {\r\n                    \"match\": {\r\n                      \"rules.description\": {\r\n                        \"query\": \"##TO_REPLACE##\",\r\n                        \"analyzer\": \"standard\",\r\n                        \"operator\": \"and\"\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      ]\r\n    }\r\n  `;\r\n  constructor(private http: Http, private config: Config, private logger: Logger) {\r\n    // this.logger.log(\" retrieving config\");\r\n    // this.logger.log(\"saaBackUrl value: \" + config.get('saaBackUrl'));\r\n  }\r\n\r\n  findAssignmentByID(productID: string): Observable<any> {\r\n    return this.http.get('/products/${productID}').map(res => res.json());\r\n  }\r\n\r\n  //TODO: \r\n  /*\r\n   *  + remove limit size=100 for all http request, use pagination instead  \r\n  */\r\n\r\n  findPoints(): Observable<any> {\r\n    return this.http.post(this.config.get(\"esBackUrl\") + \"/routing/points/_search\", '{\"sort\": [{\"pointName\": {\"order\": \"asc\"}}, {\"rules.sequence\": {\"order\": \"desc\"}}]}').map(res => res.json());\r\n  }\r\n\r\n  findPointNames(): Observable<any> {\r\n    return this.http.post(this.config.get(\"esBackUrl\") + \"/routing/points/_search?size=1000\", '{ \"fields\": [\"pointName\"], \"sort\": [{\"pointName\": {\"order\": \"asc\"}}, {\"rules.sequence\": {\"order\": \"desc\"}}]}')\r\n      .map(res => res.json())\r\n      .flatMap(dataset => Observable.from(dataset['hits'].hits))\r\n      .map(hit => {\r\n        let toReturn = {\r\n          \"pointName\": hit[\"fields\"][\"pointName\"][0]\r\n        }\r\n        // this.logger.debug(\"hit \"+JSON.stringify(hit) + \"  to return \"+ JSON.stringify(toReturn));\r\n        return toReturn;\r\n      });\r\n  }\r\n\r\n  findPointMatches(schemas : Array<string>, text?: string): Observable<Array<PointList>> {\r\n    if (text) {\r\n      return this.findPointMatchesJson(schemas,text)\r\n        .flatMap(this.toHits)\r\n        .flatMap(this.toPointList)\r\n        .reduce((acc, R) => { acc.push(R); return acc }, new Array<PointList>());\r\n      //TODO: filter with match\r\n    } else {\r\n      return this.findPointMatchesJson(schemas,text)\r\n        .flatMap(this.toHits)\r\n        .flatMap(this.toPointList)\r\n        .reduce((acc, R) => { acc.push(R); return acc }, new Array<PointList>());\r\n    }\r\n  }\r\n\r\n  private toPointList(point): Observable<PointList> {\r\n    let list: Array<PointList> = [];\r\n    if (point.rules.length > 0) {\r\n\r\n      point.rules.map(rule => {\r\n        let originalPoint = rule.action.source ? rule.action.source.actionOption : \"\";\r\n        let originalCode = rule.action.source ? rule.action.source.routingCode : \"\";\r\n        let copyPoint = rule.action.newInstance ? rule.action.newInstance.actionOption : \"\";\r\n        let copyCode = rule.action.newInstance ? rule.action.newInstance.routingCode : \"\";\r\n\r\n        list.push(new PointList(rule.routingPoint, rule.schemas, rule.sequence, rule.description, rule.condition ? rule.condition.message : \"\",\r\n          originalPoint, originalCode, copyPoint, copyCode));\r\n      });\r\n\r\n    } else {\r\n      //this.logger.debug(\"adding assign \"+assign.code+\" without rules\");\r\n      list.push(new PointList(point.pointName, \"\", undefined, \"\", \"\"));\r\n    }\r\n    // this.logger.debug(\"last flatMap with \" + list.length);\r\n    return Observable.from(list);\r\n  }\r\n\r\n\r\n\r\n  private findPointMatchesJson(schemas : Array<string>, text?: string): Observable<any> {\r\n  let payload;\r\n  let hasTextValue = text && text.length >= 1;\r\n\r\n    if (schemas && schemas.length >= 1) {\r\n      let withSchemaText = hasTextValue ? \r\n                            this.filterRules.replace(/##RULE_CLAUSE##/g, this.queryRule.replace(/##TO_REPLACE##/g, text)) \r\n                            : \"\"; \r\n\r\n      payload = this.pointsBySchemaQuery\r\n                    .replace(/##MATCH_CLAUSES##/g, this.createSchemaQueryClauses(schemas))\r\n                    .replace(/##FILTER_RULES_CLAUSE##/g, withSchemaText)\r\n                    .replace(/##RANGE_SORT_CLAUSE##/g, this.fromSortClauses);\r\n\r\n                      \r\n    } else if (hasTextValue) {\r\n      payload = this.query\r\n                      .replace(/##RULE_CLAUSE##/g, this.queryRule.replace(/##TO_REPLACE##/g, text))\r\n                      .replace(/##RANGE_SORT_CLAUSE##/g, this.fromSortClauses);\r\n    } else {\r\n      payload = '{\"sort\": [{\"pointName\": {\"order\": \"asc\"}}, {\"rules.sequence\": {\"order\": \"desc\"}}]}';\r\n      // return this.http.post(this.config.get(\"esBackUrl\") + \"/routing/points/_search?size=100\", '{\"sort\": [{\"pointName\": {\"order\": \"asc\"}}, {\"rules.sequence\": {\"order\": \"desc\"}}]}').map(res => res.json());\r\n\r\n    }\r\n      //this.logger.debug(\"findPointMatches payload \"+ payload);\r\n      return this.http.post(this.config.get(\"esBackUrl\") + \"/routing/points/_search?size=1000\", payload).map(res => res.json());\r\n  }\r\n\r\n\r\n  findPointByName(pointName: string): Observable<any> {\r\n    return this.http.get(this.config.get(\"esBackUrl\") + \"/routing/points/\" + pointName)\r\n      .map(res => res.json())\r\n      .map(res => {\r\n        // this.logger.debug(\"from 1st call \"+JSON.stringify(res));\r\n        return { \"found\": res.found, \"source\": res._source }\r\n      })\r\n  }\r\n\r\n  findRuleByPointAndSequence(pointName: string, sequence: number): Observable<any> {\r\n    return this.findPointByName(pointName)\r\n      .flatMap(\r\n      (res) => {\r\n        //this.logger.debug(\"from call \"+JSON.stringify(res));\r\n        if (res.found) {\r\n          let found = [];\r\n          let ruleBySequenceFound = res.source.rules.find(rule => rule.sequence == sequence);\r\n          if (ruleBySequenceFound) {\r\n            found.push({ \"found\": true, \"value\": ruleBySequenceFound });\r\n          }\r\n          this.logger.log(\"ruleBySequence \" + found);\r\n          return Observable.from(found);\r\n        } else {\r\n          //TODO: check how to return an error\r\n          this.logger.error(\"no point found \");\r\n          return Observable.from([{ \"found\": true, \"value\": {} }]);\r\n        }\r\n\r\n      }\r\n      );\r\n  }\r\n\r\n  private toRules(point): Observable<Rule> {\r\n    let list: Array<Rule> = [];\r\n\r\n    if (point.rules.length > 0) {\r\n\r\n      point.rules.map(rule => {\r\n        if (rule.schemas && rule.schemas.length > 0) {\r\n          //TODO change schemas from string to array\r\n        }\r\n        list.push(new Rule(rule.sequence, rule.routingPoint, rule.description, rule.schemas, undefined, undefined, rule.condition, rule.action));\r\n      });\r\n\r\n    }\r\n    // this.logger.debug(\"last flatMap with \" + list.length);\r\n    return Observable.from(list);\r\n  }\r\n\r\n  private createSchemaQueryClauses(schemas : Array<string>) : string {\r\n    if (!schemas || schemas.length <= 0) {\r\n      return \"\";\r\n    }\r\n\r\n   return schemas.map(schema => this.schemaClause.replace(/##TO_REPLACE##/g, schema)).join(\",\")\r\n  }\r\n\r\n  private findOne(source : Array<string>, target : Array<string>) : boolean {\r\n    if (!source || source.length == 0 || !target || target.length == 0) {\r\n      return false;\r\n    }\r\n\r\n    return target.some(e => source.indexOf(e) != -1);\r\n  }\r\n\r\n  findRulesBySchemas(schemas: Array<string>, filter: boolean = true): Observable<Array<Rule>> {\r\n    this.logger.log(\">> looking for rules with schemas \" + JSON.stringify(schemas));\r\n\r\n    let payload = this.pointsBySchemaQuery\r\n                    .replace(/##MATCH_CLAUSES##/g, this.createSchemaQueryClauses(schemas))\r\n                    .replace(/##FILTER_RULES_CLAUSE##/g,\"\")\r\n                    .replace(/##RANGE_SORT_CLAUSE##/g, this.fromSortClauses);\r\n\r\n    //this.logger.debug(\"findPointMatches payload \"+ payload);\r\n    let allRules = this.http.post(this.config.get(\"esBackUrl\") + \"/routing/points/_search?size=1000\", payload)\r\n      .map(res => res.json())\r\n      .flatMap(this.toHits)\r\n      .flatMap(this.toRules);\r\n\r\n    if (filter) {\r\n      allRules = allRules.filter(rule => {\r\n        let schemaFound = this.findOne(rule.schemas, schemas);\r\n        this.logger.debug(\"in filter rules: \" + rule.schemas + \" schemaFound = \" + schemaFound);\r\n        return schemaFound;\r\n      });\r\n    }\r\n\r\n    return allRules.reduce((acc, R) => { acc.push(R); return acc }, new Array<Rule>());;\r\n  }\r\n\r\n  findRuleByCode(code: string): Observable<any> {\r\n    this.logger.log(\">> looking for \" + code);\r\n    let found = new AMHRule(\"\", \"\");\r\n    return this.findRules().flatMap(\r\n      (data) => {\r\n        let rule = SAARoutingService.getFromSource(data).find(r => {\r\n          return r.code.toLowerCase() == (code ? code.toLocaleLowerCase() : '');\r\n        });\r\n        this.logger.log(\">> elastic return  \" + rule);\r\n        if (rule) {\r\n          return Observable.create(observer => {\r\n            observer.next(rule);\r\n            observer.complete();\r\n            // Any cleanup logic might go here\r\n            return () => this.logger.log('disposed found')\r\n          });\r\n        } else {\r\n          return Observable.create(observer => {\r\n            observer.next(new AMHRule(\"\", \"\"));\r\n            this.logger.log(\"returning to observer code=empty\");\r\n            observer.complete();\r\n            // Any cleanup logic might go here\r\n            return () => this.logger.log('disposed not found')\r\n          });\r\n        }\r\n      }\r\n    );\r\n    // return Observable.from(this.findAMHRuleByCode(code));\r\n  }\r\n\r\n  findRules(): Observable<any> {\r\n    return this.http.get(this.config.get(\"esBackUrl\") + \"/amhrouting/rules/_search?size=1000\").map(res => res.json());\r\n  }\r\n\r\n  findBackends(): Observable<any> {\r\n    this.logger.log(\"findBackends url = \" + this.config.get(\"esBackUrl\"));\r\n    return this.http.get(this.config.get(\"esBackUrl\") + \"/amhrouting/backends/_search?size=1000\").map(res => res.json());\r\n  }\r\n\r\n\r\n  // findAssignmentsBySequence(sequence: number): Observable<any> {\r\n  //   return this.findAssignments().flatMap(\r\n  //     (data) => {\r\n  //       let assignments = SAARoutingService.getFromSource(data);\r\n  //       let found=[];\r\n  //       let assignBySequenceFound = assignments.find(assignment => assignment.sequence == sequence);\r\n  //       if (assignBySequenceFound) {\r\n  //         found.push(assignBySequenceFound);\r\n  //       }\r\n  //       this.logger.log(\"assignmentBySequence \"+ found);\r\n  //       return Observable.from(found);\r\n  //     }\r\n  //   );\r\n\r\n  // }\r\n\r\n  // findAssignmentsByCode(code: string): Observable<any> {\r\n  //   return this.findAssignments().flatMap(\r\n  //     (data) => {\r\n  //       let assignments = SAARoutingService.getFromSource(data);\r\n  //       let found=[];\r\n  //       let assignByCodeFound = assignments.find(assignment => assignment.code == code);\r\n  //       if (assignByCodeFound) {\r\n  //         found.push(assignByCodeFound);\r\n  //       }\r\n  //       this.logger.log(\"assignmentByCode \"+ found);\r\n  //       return Observable.from(found);\r\n  //     }\r\n  //   );\r\n\r\n  // }\r\n\r\n  // findAssignmentsByBackendPK(pk: BackendPK): Observable<any> {\r\n  //   return this.findAssignments().flatMap(\r\n  //     (data) => {\r\n  //       let assignments = SAARoutingService.getFromSource(data);\r\n  //       let found=[];\r\n  //       for (var i = 0; i < assignments.length; i++) {\r\n  //         var existingBackend = assignments[i];\r\n  //         if (existingBackend.backendPrimaryKey.code === pk.code && existingBackend.backendPrimaryKey.direction === pk.direction) {\r\n  //           found.push(existingBackend);\r\n  //           break;\r\n  //         }\r\n  //       }\r\n  //       this.logger.log(\"[flatMap] returning \"+ found);\r\n  //       return Observable.from(found);\r\n  //     }\r\n  //   );\r\n\r\n  // }\r\n\r\n  saveRule(env: string, version: string, rule: Rule): Observable<any> {\r\n    let headers = new Headers({ 'Content-Type': 'application/json' });\r\n    let options = new RequestOptions({ headers: headers });\r\n\r\n    let payload: string = JSON.stringify(rule.toWriteModel(env, version));\r\n    this.logger.log(\" save rule sent: \" + payload);\r\n    return this.http.put(this.config.get(\"saaBackUrl\") + \"/points/\" + rule.routingPoint + \"/rules/\" + rule.sequence, payload, options).map(res => { this.logger.log(\" from save \" + res.json()); res.json(); })\r\n  }\r\n\r\n  createRule(env: string, version: string, rule: Rule): Observable<any> {\r\n    let headers = new Headers({ 'Content-Type': 'application/json' });\r\n    let options = new RequestOptions({ headers: headers });\r\n\r\n    let payload: string = JSON.stringify(rule.toWriteModel(env, version));\r\n    this.logger.log(\" create rule sent: \" + payload);\r\n    return this.http.post(this.config.get(\"saaBackUrl\") + \"/points/\" + rule.routingPoint + \"/rules/\" + rule.sequence, payload, options).map(res => { this.logger.log(\" from create \" + res.json()); res.json(); })\r\n  }\r\n\r\n  saveAssignment(assignment: Assignment): Observable<any> {\r\n    let headers = new Headers({ 'Content-Type': 'application/json' });\r\n    let options = new RequestOptions({ headers: headers });\r\n\r\n    let payload: string = this.assignToWriteModel(assignment);\r\n    this.logger.log(\" save assignment sent: \" + payload);\r\n    return this.http.put(this.config.get(\"saaBackUrl\") + \"/amhrouting/assignments/\" + assignment.code, payload, options).map(res => { this.logger.log(\" from save \" + res.json()); res.json(); })\r\n  }\r\n\r\n  createAssignment(assignment: Assignment): Observable<any> {\r\n    let headers = new Headers({ 'Content-Type': 'application/json' });\r\n    let options = new RequestOptions({ headers: headers });\r\n\r\n    let payload: string = this.assignToWriteModel(assignment);\r\n    this.logger.log(\" create assignment sent: \" + payload);\r\n    return this.http.post(this.config.get(\"saaBackUrl\") + \"/amhrouting/assignments/\" + assignment.code, payload, options).map(res => { this.logger.log(\" from create \" + res.json()); return res.json(); })\r\n  }\r\n\r\n  export(env: string, version: string, fileName: string): Observable<any> {\r\n    let headers = new Headers({ 'Content-Type': 'application/json' });\r\n    let options = new RequestOptions({ headers: headers });\r\n\r\n    let payload: string = JSON.stringify({\r\n      filePath: \"useless\",\r\n      fileName: fileName,\r\n      env: env,\r\n      version: version\r\n    });\r\n    this.logger.log(\" export sent to SAA: \" + payload);\r\n    return this.http.post(this.config.get(\"saaBackUrl\") + \"/routing/export\", payload, options)\r\n      .map(res => {\r\n        this.logger.log(\" from export \" + res.json().response);\r\n        return res.json();\r\n      });\r\n\r\n  }\r\n\r\n  getExportedFile(fileName: string): Observable<any> {\r\n    return this.http.get(this.config.get(\"saaBackUrl\") + \"/routing/export/\" + fileName).map(res => res.json());\r\n  }\r\n\r\n  import(filePath: string): Observable<any> {\r\n    let headers = new Headers({ 'Content-Type': 'application/json' });\r\n    let options = new RequestOptions({ headers: headers });\r\n\r\n    let payload: string = JSON.stringify({\r\n      filePath: filePath\r\n    });\r\n    this.logger.log(\" import sent: \" + payload);\r\n    return this.http.post(this.config.get(\"saaBackUrl\") + \"/routing/import\", payload, options).map(res => { this.logger.log(\" from import \" + res.json()); return res.json(); })\r\n  }\r\n\r\n  private assignToWriteModel(assignment: Assignment): string {\r\n\r\n    let writeModelObj = {\r\n      sequence: assignment.sequence,\r\n      backCode: assignment.backendPrimaryKey.code,\r\n      backDirection: assignment.backendPrimaryKey.direction,\r\n      active: String(assignment.active),\r\n      dataOwner: assignment.dataOwner,\r\n      lockCode: assignment.lockCode,\r\n      description: assignment.description,\r\n      rules: []\r\n    };\r\n\r\n    let rules = assignment.rules || [];\r\n    rules.forEach(rule => {\r\n      let ruleWriteModel = this.assigRuleToModel(assignment.code, rule);\r\n      writeModelObj.rules.push(ruleWriteModel);\r\n    });\r\n\r\n    return JSON.stringify(writeModelObj);\r\n  }\r\n\r\n  //  code: String, sequence: Long, ruleCode: String,\r\n  //                                    dataOwner: Option[String], lockCode: Option[String],\r\n  //                                    environment: Option[String] = None, //lastModification: Option[Date] = None, creationDate: Option[Date] = None,\r\n  //                                    createdBy: Option[String] = None, lastModifiedBy: Option[String] = None, version: Option[Long] = None\r\n\r\n\r\n  //  public code: string;\r\n  //   public dataOwner: string;\r\n  //   public lockCode: string;\r\n  //   public sequence: number;\r\n  //   public expression:string;\r\n\r\n  private assigRuleToModel(backendCode: string, assignmentRule: AssignmentRule): any {\r\n    this.logger.log(\"assigRuleToModel with code \" + backendCode + \" assignmentRule.sequence \" + assignmentRule.sequence\r\n      + \" assignmentRule.code \" + assignmentRule.code + \" assignmentRule.dataOwner \" + assignmentRule.dataOwner + \" assignmentRule.lockCode \" + assignmentRule.lockCode);\r\n    return {\r\n      code: backendCode,\r\n      sequence: assignmentRule.sequence,\r\n      ruleCode: assignmentRule.code,\r\n      dataOwner: assignmentRule.dataOwner,\r\n      lockCode: assignmentRule.lockCode\r\n    };\r\n  }\r\n\r\n  static getFromSource(data: any): (Array<any>) {\r\n    let hitArray = data['hits'].hits;\r\n    let resp = hitArray.map(s => s._source)\r\n    return resp;\r\n  }\r\n\r\n  private toHits(match): Observable<any> {\r\n    return Observable.from(match['hits'].hits)\r\n      .map(hit => hit[\"_source\"])\r\n  }\r\n\r\n  //TODO: check how to pass 'this' in the context to user this.logger instead of console\r\n  private toFoundHits(match): Observable<any> {\r\n    let totalHits = match.hits.total;\r\n    //console.debug(\"totalHits : \"+totalHits);\r\n    if (totalHits > 0) {\r\n      let hits = match['hits'].hits.map(hit => hit[\"_source\"]);\r\n      //console.debug(\"from  \"+ JSON.stringify(hits));\r\n      return Observable.from([{ \"found\": true, \"hits\": hits }]);\r\n    } else {\r\n      //console.debug(\"returning empty hits[] \");\r\n      return Observable.from([{ \"found\": false, \"hits\": [] }]);\r\n    }\r\n  }\r\n\r\n  findSchemas(): Observable<Array<Option>> {\r\n    this.logger.log(\"findSchemas url = \" + this.config.get(\"esBackUrl\"));\r\n    return this.http.get(this.config.get(\"esBackUrl\") + \"/routing/schemas/_search?size=1000\")\r\n      .map(res => res.json())\r\n      .flatMap(this.toFoundHits)\r\n      .map(resp => { return resp.hits.map(hit => { return new Option(1, hit['name'], hit['name']); }); });\r\n  }\r\n\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/app/saa-routing/saa-routing.service.ts","module.exports = function (namespace) {\n  return new Promise(function (resolve) {\n    require.ensure([], function (require) {\n      if (namespace) {\n        resolve(require(\"!!C:\\\\dev\\\\projects\\\\angular\\\\groupaxis\\\\01-RELEASE-v1.0\\\\node_modules\\\\awesome-typescript-loader\\\\dist.babel\\\\entry.js!C:\\\\dev\\\\projects\\\\angular\\\\groupaxis\\\\01-RELEASE-v1.0\\\\src\\\\app\\\\saa-routing\\\\saa-simulator\\\\index.ts\")[namespace]);\n      } else {\n        var mod = require(\"!!C:\\\\dev\\\\projects\\\\angular\\\\groupaxis\\\\01-RELEASE-v1.0\\\\node_modules\\\\awesome-typescript-loader\\\\dist.babel\\\\entry.js!C:\\\\dev\\\\projects\\\\angular\\\\groupaxis\\\\01-RELEASE-v1.0\\\\src\\\\app\\\\saa-routing\\\\saa-simulator\\\\index.ts\");\n        resolve(mod.__esModule ? mod.default : mod)\n      }\n    });\n  });\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/es6-promise-loader!./src/app/saa-routing/saa-simulator/index.ts\n// module id = 1259\n// module chunks = 1"],"sourceRoot":""}