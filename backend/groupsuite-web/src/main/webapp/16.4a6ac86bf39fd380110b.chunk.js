webpackJsonp([16],{900:function(e,t,n){var s=n(878),i=n(1129),o=n(899),a=n(1128);t.DataTable=s.DataTable,t.DataEvent=s.DataEvent,t.PageEvent=s.PageEvent,t.SortEvent=s.SortEvent,t.DefaultSorter=i.DefaultSorter,t.Paginator=o.Paginator,t.BootstrapPaginator=a.BootstrapPaginator,t.DataTableDirectives=[s.DataTable,i.DefaultSorter,o.Paginator,a.BootstrapPaginator]},1128:function(e,t,n){"use strict";var s=this&&this.__decorate||function(e,t,n,s){var i,o=arguments.length,a=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,n):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,s);else for(var r=e.length-1;r>=0;r--)(i=e[r])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=n(1),a=n(878),r=n(899),c=n(528),l=function(){function BootstrapPaginator(){this.rowsOnPageSet=[],this.minRowsOnPage=0}return BootstrapPaginator.prototype.ngOnChanges=function(e){e.rowsOnPageSet&&(this.minRowsOnPage=c.min(this.rowsOnPageSet))},s([o.Input("rowsOnPageSet"),i("design:type",Object)],BootstrapPaginator.prototype,"rowsOnPageSet",void 0),s([o.Input("mfTable"),i("design:type",a.DataTable)],BootstrapPaginator.prototype,"mfTable",void 0),BootstrapPaginator=s([o.Component({selector:"mfBootstrapPaginator",template:'\n    <mfPaginator #p [mfTable]="mfTable">\n        <nav class="pagination" *ngIf="p.dataLength > p.rowsOnPage">\n            <li [class.disabled]="p.activePage <= 1" (click)="p.setPage(1)">\n                <a style="cursor: pointer">&laquo;</a>\n            </li>\n            <li *ngIf="p.activePage > 4 && p.activePage + 1 > p.lastPage" (click)="p.setPage(p.activePage - 4)">\n                <a style="cursor: pointer">{{p.activePage-4}}</a>\n            </li>\n            <li *ngIf="p.activePage > 3 && p.activePage + 2 > p.lastPage" (click)="p.setPage(p.activePage - 3)">\n                <a style="cursor: pointer">{{p.activePage-3}}</a>\n            </li>\n            <li *ngIf="p.activePage > 2" (click)="p.setPage(p.activePage - 2)">\n                <a style="cursor: pointer">{{p.activePage-2}}</a>\n            </li>\n            <li *ngIf="p.activePage > 1" (click)="p.setPage(p.activePage - 1)">\n                <a style="cursor: pointer">{{p.activePage-1}}</a>\n            </li>\n            <li class="active">\n                <a style="cursor: pointer">{{p.activePage}}</a>\n            </li>\n            <li *ngIf="p.activePage + 1 <= p.lastPage" (click)="p.setPage(p.activePage + 1)">\n                <a style="cursor: pointer">{{p.activePage+1}}</a>\n            </li>\n            <li *ngIf="p.activePage + 2 <= p.lastPage" (click)="p.setPage(p.activePage + 2)">\n                <a style="cursor: pointer">{{p.activePage+2}}</a>\n            </li>\n            <li *ngIf="p.activePage + 3 <= p.lastPage && p.activePage < 3" (click)="p.setPage(p.activePage + 3)">\n                <a style="cursor: pointer">{{p.activePage+3}}</a>\n            </li>\n            <li *ngIf="p.activePage + 4 <= p.lastPage && p.activePage < 2" (click)="p.setPage(p.activePage + 4)">\n                <a style="cursor: pointer">{{p.activePage+4}}</a>\n            </li>\n            <li [class.disabled]="p.activePage >= p.lastPage" (click)="p.setPage(p.lastPage)">\n                <a style="cursor: pointer">&raquo;</a>\n            </li>\n        </nav>\n        <nav class="pagination pull-right" *ngIf="p.dataLength > minRowsOnPage">\n            <li *ngFor="let rows of rowsOnPageSet" [class.active]="p.rowsOnPage===rows" (click)="p.setRowsOnPage(rows)">\n                <a style="cursor: pointer">{{rows}}</a>\n            </li>\n        </nav>\n    </mfPaginator>\n    ',directives:[r.Paginator]}),i("design:paramtypes",[])],BootstrapPaginator)}();t.BootstrapPaginator=l},878:function(e,t,n){"use strict";var s=this&&this.__decorate||function(e,t,n,s){var i,o=arguments.length,a=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,n):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,s);else for(var r=e.length-1;r>=0;r--)(i=e[r])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=n(1),a=n(528),r=function(){function DataTable(){this.inputData=[],this.sortBy="",this.sortOrder="asc",this.rowsOnPage=1e3,this.activePage=1,this.mustRecalculateData=!1,this.onDataChange=new o.EventEmitter,this.onSortChange=new o.EventEmitter,this.onPageChange=new o.EventEmitter}return DataTable.prototype.getSort=function(){return{sortBy:this.sortBy,sortOrder:this.sortOrder}},DataTable.prototype.setSort=function(e,t){this.sortBy===e&&this.sortOrder===t||(this.sortBy=e,this.sortOrder=t,this.mustRecalculateData=!0,this.onSortChange.emit({sortBy:e,sortOrder:t}))},DataTable.prototype.getPage=function(){return{activePage:this.activePage,rowsOnPage:this.rowsOnPage,dataLength:this.inputData.length}},DataTable.prototype.setPage=function(e,t){this.rowsOnPage===t&&this.activePage===e||(this.activePage=this.activePage!==e?e:this.calculateNewActivePage(this.rowsOnPage,t),this.rowsOnPage=t,this.mustRecalculateData=!0,this.onPageChange.emit({activePage:this.activePage,rowsOnPage:this.rowsOnPage,dataLength:this.inputData.length}))},DataTable.prototype.calculateNewActivePage=function(e,t){var n=(this.activePage-1)*e+1,s=Math.ceil(n/t);return s},DataTable.prototype.ngOnChanges=function(e){e.inputData&&(this.inputData=this.inputData||[],this.onPageChange.emit({activePage:this.activePage,rowsOnPage:this.rowsOnPage,dataLength:this.inputData.length}),this.mustRecalculateData=!0)},DataTable.prototype.ngDoCheck=function(){this.mustRecalculateData&&(this.fillData(),this.mustRecalculateData=!1)},DataTable.prototype.fillData=function(){this.activePage=this.activePage,this.rowsOnPage=this.rowsOnPage;var e=(this.activePage-1)*this.rowsOnPage,t=this.inputData;t=a.orderBy(t,[this.sortBy],[this.sortOrder]),t=a.slice(t,e,e+this.rowsOnPage),this.data=t},s([o.Input("mfData"),i("design:type",Array)],DataTable.prototype,"inputData",void 0),s([o.Input("mfRowsOnPage"),i("design:type",Object)],DataTable.prototype,"rowsOnPage",void 0),s([o.Input("mfActivePage"),i("design:type",Object)],DataTable.prototype,"activePage",void 0),DataTable=s([o.Directive({selector:"table[mfData]",exportAs:"mfDataTable"}),i("design:paramtypes",[])],DataTable)}();t.DataTable=r},1129:function(e,t,n){"use strict";var s=this&&this.__decorate||function(e,t,n,s){var i,o=arguments.length,a=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,n):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,s);else for(var r=e.length-1;r>=0;r--)(i=e[r])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=n(1),a=n(878),r=function(){function DefaultSorter(e){var t=this;this.mfTable=e,this.isSortedByMeAsc=!1,this.isSortedByMeDesc=!1,e.onSortChange.subscribe(function(e){t.isSortedByMeAsc=e.sortBy===t.sortBy&&"asc"===e.sortOrder,t.isSortedByMeDesc=e.sortBy===t.sortBy&&"desc"===e.sortOrder})}return DefaultSorter.prototype.sort=function(){this.isSortedByMeAsc?this.mfTable.setSort(this.sortBy,"desc"):this.mfTable.setSort(this.sortBy,"asc")},s([o.Input("by"),i("design:type",String)],DefaultSorter.prototype,"sortBy",void 0),DefaultSorter=s([o.Component({selector:"mfDefaultSorter",template:'\n        <a style="cursor: pointer" (click)="sort()" class="text-nowrap">\n            <ng-content></ng-content>\n            <span *ngIf="isSortedByMeAsc" class="glyphicon glyphicon-triangle-top" aria-hidden="true"></span>\n            <span *ngIf="isSortedByMeDesc" class="glyphicon glyphicon-triangle-bottom" aria-hidden="true"></span>\n        </a>'}),i("design:paramtypes",[a.DataTable])],DefaultSorter)}();t.DefaultSorter=r},899:function(e,t,n){"use strict";var s=this&&this.__decorate||function(e,t,n,s){var i,o=arguments.length,a=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,n):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,s);else for(var r=e.length-1;r>=0;r--)(i=e[r])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,s){t(n,s,e)}},a=n(1),r=n(878),c=function(){function Paginator(e){var t=this;this.injectMfTable=e,this.dataLength=0,this.onPageChangeSubscriber=function(e){t.activePage=e.activePage,t.rowsOnPage=e.rowsOnPage,t.dataLength=e.dataLength,t.lastPage=Math.ceil(t.dataLength/t.rowsOnPage)}}return Paginator.prototype.ngOnChanges=function(e){this.mfTable=this.inputMfTable||this.injectMfTable,this.onPageChangeSubscriber(this.mfTable.getPage()),this.mfTable.onPageChange.subscribe(this.onPageChangeSubscriber)},Paginator.prototype.setPage=function(e){this.mfTable.setPage(e,this.rowsOnPage)},Paginator.prototype.setRowsOnPage=function(e){this.mfTable.setPage(this.activePage,e)},s([a.Input("mfTable"),i("design:type",r.DataTable)],Paginator.prototype,"inputMfTable",void 0),Paginator=s([a.Component({selector:"mfPaginator",template:"<ng-content></ng-content>"}),o(0,a.Optional()),i("design:paramtypes",[r.DataTable])],Paginator)}();t.Paginator=c},904:function(e,t,n){"use strict";var s=n(14),i=n(922);s.Observable.prototype.reduce=i.reduce},922:function(e,t,n){"use strict";function reduce(e,t){return this.lift(new o(e,t))}var s=this&&this.__extends||function(e,t){function __(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)},i=n(70);t.reduce=reduce;var o=function(){function ReduceOperator(e,t){this.project=e,this.seed=t}return ReduceOperator.prototype.call=function(e,t){return t._subscribe(new a(e,this.project,this.seed))},ReduceOperator}();t.ReduceOperator=o;var a=function(e){function ReduceSubscriber(t,n,s){e.call(this,t),this.hasValue=!1,this.acc=s,this.project=n,this.hasSeed="undefined"!=typeof s}return s(ReduceSubscriber,e),ReduceSubscriber.prototype._next=function(e){this.hasValue||(this.hasValue=this.hasSeed)?this._tryReduce(e):(this.acc=e,this.hasValue=!0)},ReduceSubscriber.prototype._tryReduce=function(e){var t;try{t=this.project(this.acc,e)}catch(e){return void this.destination.error(e)}this.acc=t},ReduceSubscriber.prototype._complete=function(){(this.hasValue||this.hasSeed)&&this.destination.next(this.acc),this.destination.complete()},ReduceSubscriber}(i.Subscriber);t.ReduceSubscriber=a},1180:function(e,t,n){"use strict";var s=n(30),i=n(1164),o=n(900),a=n(880),r=n(38),c=function(){function AMHAssignmentSearchComponent(e,t,n){this.amhAssignmentService=e,this.myElement=t,this.logger=n,this.assignmentType=a.AssignType.BK_CHANNEL,this.assignmentSelected=new s.EventEmitter,this.assignments=[],this.originalAssignments=[],this.bodyMargin=0,this.selectedAssignment=new a.AssignmentUnique,this.selectedPkDirection=""}return AMHAssignmentSearchComponent.prototype.ngOnChanges=function(e){this.logger.debug("changes : "+JSON.stringify(e)),this.oldAssignmentType!=this.typeAsString(this.assignmentType)?(this.defaultCode=e.defaultCode?e.defaultCode.currentValue:void 0,this.loadAssignments(void 0!=e.defaultCode),this.oldAssignmentType=this.typeAsString(this.assignmentType),this.selectedAssignment=new a.AssignmentUnique):e.defaultCode&&(this.updateAssignments(this.defaultCode),1==this.assignments.length&&this.selectAssignment(this.assignments[0]))},AMHAssignmentSearchComponent.prototype.ngOnInit=function(){this.loadAssignments(),this.oldAssignmentType=this.typeAsString(this.assignmentType)},AMHAssignmentSearchComponent.prototype.typeAsString=function(e){return a.AssignType[e]},AMHAssignmentSearchComponent.prototype.loadAssignments=function(e){var t=this;this.originalAssignments=[],this.assignments=[],this.amhAssignmentService.findAssignments(this.assignmentType).subscribe(function(e){var n=i.AMHAssignmentService.getFromSource(e);n.forEach(function(e){t.originalAssignments.push(e)})},function(e){return t.logger.error("Can't get assignments type "+t.assignmentType+". Error code: %s, URL: %s ",e.status,e.url)},function(){t.updateAssignments(t.defaultCode),e&&1==t.assignments.length&&t.selectAssignment(t.assignments[0])})},AMHAssignmentSearchComponent.prototype.handleClick=function(e){var t=e.target,n=!1;do t===this.myElement.nativeElement&&(n=!0),t=t.parentNode;while(t);n||(this.assignments=[],this.selectedAssignment.code||(this.selectedAssignment=new a.AssignmentUnique))},AMHAssignmentSearchComponent.prototype.selectAssignment=function(e){return e?(this.assignmentSelected.emit(e.code),this.assignments=[],void(this.selectedAssignment=new a.AssignmentUnique)):void this.logger.error("assignment["+e+"] missing ")},AMHAssignmentSearchComponent.prototype.updateAssignments=function(e){if(!e)return void(this.assignments=[]);var t={},n=this.originalAssignments.filter(function(e){return!t[e.code]}),s=e.toUpperCase(),i=n.filter(function(e){return e.code.toUpperCase().match(s)}),o=i,a=[];o.forEach(function(e){var t=a.find(function(t,n,s){return e.code==t.code});t||a.push(e)}),this.assignments=a.map(function(e){return e.code=e.code,e})},__decorate([s.ViewChild(o.DataTable),__metadata("design:type",Object)],AMHAssignmentSearchComponent.prototype,"table",void 0),__decorate([s.Input("default-code"),__metadata("design:type",String)],AMHAssignmentSearchComponent.prototype,"defaultCode",void 0),__decorate([s.Input("assignment-type"),__metadata("design:type",Number)],AMHAssignmentSearchComponent.prototype,"assignmentType",void 0),__decorate([s.Output(),__metadata("design:type",s.EventEmitter)],AMHAssignmentSearchComponent.prototype,"assignmentSelected",void 0),AMHAssignmentSearchComponent=__decorate([s.Component({selector:"amh-assignment-search",template:n(1188),providers:[i.AMHAssignmentService],host:{"(document:click)":"handleClick($event)"},directives:[o.DataTableDirectives]}),__metadata("design:paramtypes",[i.AMHAssignmentService,s.ElementRef,r.Logger])],AMHAssignmentSearchComponent)}();t.AMHAssignmentSearchComponent=c},1188:function(e,t){e.exports='<!--main content start-->\r\n<input [(ngModel)]="selectedAssignment.code" \r\n    (keyup)="updateAssignments($event.target.value)" style="margin:5px 5px 10px 0px;"\r\n/> &nbsp;\r\n<i class="fa fa-search" aria-hidden="true"></i> \r\n<!---->\r\n<div style="height:200px; overflow: auto; z-index:200;" class="suggestions" *ngIf="assignments.length > 0">\r\n    <!--*ngFor="let item of assignments"-->\r\n    <!--<ul >\r\n        <li>-->\r\n            <table style="width:100%;">\r\n                <!--<thead>\r\n                    <tr>\r\n                        <th style="width:15%;"> </th>\r\n                        <th style="width:20%;"> </th>\r\n                        <th style="width:65%;"> </th>\r\n                    </tr>\r\n                </thead>-->\r\n                <tbody>\r\n                    <tr *ngFor="let item of assignments" (click)="selectAssignment(item)"> \r\n                        <td style="width:15%;">  \r\n                            <span *ngIf="item.active"  class="badge bg-primary">\r\n                                <i class="fa fa-check" aria-hidden="true"></i>\r\n                            </span>\r\n                            <span *ngIf="!item.active" >\r\n                                &nbsp;\r\n                            </span>\r\n                        </td>\r\n                        <td style="width:20%;"> <b>{{item.sequence}}</b> </td>\r\n                        <td style="width:65%;"> {{item.code.toUpperCase()}} </td>\r\n                    </tr>\r\n                </tbody>\r\n            </table>\r\n        <!--</li>\r\n    </ul>-->\r\n</div>'},1181:function(e,t,n){"use strict";function __export(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}__export(n(1180))},1225:function(e,t,n){"use strict";var s=n(30),i=n(8),o=n(1164),a=n(58),r=n(900),c=n(880),l=n(887),d=n(1234),p=n(1229),u=n(1181),g=n(258),h=n(38),m=function(){function AMHAssignmentContentComponent(e,t,n,i,o){this.router=e,this.amhAssignmentService=n,this.logger=o,this.enableSaveButtons=new s.EventEmitter,this.assignmentUpdate=new s.EventEmitter,this.saveWork=new s.EventEmitter,this.rollbackSelection=new s.EventEmitter,this.creationStatus=new s.EventEmitter,this.unconfirmedAssignmentCode=void 0,this.assignment=void 0,this.assignmentSequenceErrorMsg="",this.assignmentCopiesErrorMsg="",this.assignmentCodeErrorMsg="",this.isDirty=!1,this.disableInputs=!0,this.usedBackends=[],this.haveRulesErrors=!1,this.pendingAssignmentSave=0,this.pendingNavigationConfig={},this.selectionRollbackType=void 0,this.receivedAssignmentCode=t.params.code,this.assignmentTextFilter=this.receivedAssignmentCode||"",this.assignment=new c.AssignmentUnique(!1,new c.BackendPK("",""),"","","","",void 0,void 0,"","","",[],[]),this.isCreation=!1,this.pendingAssignmentSave=0,this.hasUserPermissions=1==i.hasPermission(["amh.modify.assignment"]),this.creationStatus.emit(this.isCreation)}return AMHAssignmentContentComponent.prototype.ngOnChanges=function(e){e.config&&(this.logger.debug("config has changed type "+this.config.type),this.selectionRollbackType!=this.config.type&&this.confirmSelectionTableChanges());var t=e.saveStatus;if(this.logger.debug(" saveStatusChange === "+t+" this.pendingAssignmentSave "+this.pendingAssignmentSave),t)switch(t.currentValue){case"OK":this.onSaveStatusOk()}if(t&&this.pendingAssignmentSave){switch(this.logger.debug("saveStatusChanged and pendingAssignmentSave == true"),t.currentValue){case"OK":this.onSaveStatusOk(),this.pendingAssignmentSave=0;break;case"Error":this.onSaveStatusFail(),this.pendingAssignmentSave=0}this.logger.debug("after switch pendingAsignmentSave")}},AMHAssignmentContentComponent.prototype.onSaveStatusFail=function(){switch(this.pendingAssignmentSave){case 2:this.rollbackSelection.emit(!0)}},AMHAssignmentContentComponent.prototype.onSaveStatusOk=function(){switch(this.pendingAssignmentSave){case 1:this.logger.debug(" save was OK then go to Rule creation"),this.navigateTo(this.pendingNavigationConfig.composentName,this.pendingNavigationConfig.parameters);break;case 2:this.logger.debug(" save was OK then change selection table"),this.initialization();break;case 3:case 0:this.logger.debug(" save in creation was OK then call afterSaveNewAssignment"),this.afterSaveNewAssignment()}},AMHAssignmentContentComponent.prototype.ngOnInit=function(){this.selectionRollbackType=this.config.type,this.amhAssignmentService.updateDirtyStatus(this.isDirty),this.loadAssignment(this.receivedAssignmentCode)},AMHAssignmentContentComponent.prototype.actionChangeRuleStatus=function(e){this.haveRulesErrors=e,this.isDirty=!0,this.amhAssignmentService.updateDirtyStatus(this.isDirty),this.emitDisableEnableSaveButtons()},AMHAssignmentContentComponent.prototype.addRule=function(e){this.assignment.rules=[e].concat(this.assignment.rules),this.assignmentUpdate.emit(this.assignment),this.isDirty=!0,this.amhAssignmentService.updateDirtyStatus(this.isDirty)},AMHAssignmentContentComponent.prototype.deleteRule=function(e){this.assignment.rules=this.assignment.rules.filter(function(t){return t.code!==e}),this.assignmentUpdate.emit(this.assignment)},AMHAssignmentContentComponent.prototype.addToBackendChannel=function(e){this.assignment.backendPrimaryKey=new c.BackendPK(e.pkCode,e.pkDirection),this.assignmentUpdate.emit(this.assignment),this.isDirty=!0,this.amhAssignmentService.updateDirtyStatus(this.isDirty)},AMHAssignmentContentComponent.prototype.addToMultiBackend=function(e){var t=new c.AssignmentUniqueBackend(e.pkCode,e.pkDirection,e.dataOwner,e.lockCode);this.assignment.backends=[t].concat(this.assignment.backends),this.assignmentUpdate.emit(this.assignment),this.isDirty=!0,this.amhAssignmentService.updateDirtyStatus(this.isDirty)},AMHAssignmentContentComponent.prototype.addBackend=function(e){switch(this.config.type){case c.AssignType.BK_CHANNEL:this.addToBackendChannel(e);break;case c.AssignType.DTN_COPY:case c.AssignType.FEED_DTN_COPY:this.addToMultiBackend(e)}this.fillBackends(),this.emitDisableEnableSaveButtons()},AMHAssignmentContentComponent.prototype.deleteToBackendChannel=function(e){this.logger.debug(" from deleteToBackendChannel  "+e),this.assignment.backendPrimaryKey&&this.assignment.backendPrimaryKey.code==e&&(this.assignment.backendPrimaryKey=void 0,this.assignmentUpdate.emit(this.assignment),this.isDirty=!0,this.amhAssignmentService.updateDirtyStatus(this.isDirty))},AMHAssignmentContentComponent.prototype.deleteToMultiBackend=function(e){this.assignment.backends=this.assignment.backends.filter(function(t){return t.code!==e}),this.assignmentUpdate.emit(this.assignment),this.isDirty=!0,this.amhAssignmentService.updateDirtyStatus(this.isDirty)},AMHAssignmentContentComponent.prototype.deleteBackend=function(e){switch(this.config.type){case c.AssignType.BK_CHANNEL:this.deleteToBackendChannel(e);break;case c.AssignType.DTN_COPY:case c.AssignType.FEED_DTN_COPY:this.deleteToMultiBackend(e)}this.fillBackends(),this.emitDisableEnableSaveButtons()},AMHAssignmentContentComponent.prototype.fillBackends=function(){var e=[];switch(this.config.type){case c.AssignType.BK_CHANNEL:this.assignment.backendPrimaryKey&&this.assignment.backendPrimaryKey.code&&e.push(new c.Backend(this.assignment.backendPrimaryKey.code,this.assignment.backendPrimaryKey.direction));break;case c.AssignType.DTN_COPY:case c.AssignType.FEED_DTN_COPY:this.assignment.backends&&this.assignment.backends.forEach(function(t){e.push(new c.Backend(t.code,t.direction))})}this.usedBackends=e},AMHAssignmentContentComponent.prototype.selectAssignment=function(e){return e?(this.unconfirmedAssignmentCode=e,void this.confirmAssignmentChange()):void this.logger.error("code["+e+"] missing ")},AMHAssignmentContentComponent.prototype.hasThisAssignmentErrors=function(){var e=this.assignmentSequenceErrorMsg.length>0;return e=e||this.assignmentCodeErrorMsg.length>0,e=e||this.haveRulesErrors,e=e||!this.usedBackends||this.usedBackends.length<1,this.isCreation&&(e=e||!this.assignment.code||0==this.assignment.code.length,e=e||!this.assignment.sequence||0==this.assignment.sequence),e},AMHAssignmentContentComponent.prototype.emitDisableEnableSaveButtons=function(){this.enableSaveButtons.emit(this.hasThisAssignmentErrors())},AMHAssignmentContentComponent.prototype.doDisableInputs=function(){this.logger.debug(" doDisable "+this.hasUserPermissions),this.disableInputs=!0},AMHAssignmentContentComponent.prototype.doEnableInputs=function(){return this.logger.debug(" doEnable "+this.hasUserPermissions),this.hasUserPermissions?void(this.disableInputs=!1):void(this.disableInputs=!0)},AMHAssignmentContentComponent.prototype.loadAssignment=function(e){var t=this;return e&&0!=e.length?void this.amhAssignmentService.findAssignmentByCode(this.config.type,e).subscribe(function(e){t.assignment=c.AssignmentUnique.fromJson(e),t.assignment.rules=t.assignment.rules.sort(function(e,t){return e.sequence-t.sequence}),t.isCreation=!1,t.creationStatus.emit(t.isCreation),t.doEnableInputs(),t.haveRulesErrors=!1,t.isDirty=!1,t.amhAssignmentService.updateDirtyStatus(t.isDirty),t.assignmentUpdate.emit(t.assignment),t.fillBackends()},function(e){t.logger.warn("[loadAssignment] Can't get assignment. Error code: %s, URL: %s ",e.status,e.url),t.createNewAssignment(),t.emitDisableEnableSaveButtons()},function(){t.assignment||t.createNewAssignment(),t.emitDisableEnableSaveButtons()}):void this.createNewAssignment()},AMHAssignmentContentComponent.prototype.actionCreateNewAssignment=function(){this.doEnableInputs(),this.unconfirmedAssignmentCode="";var e=this.hasThisAssignmentErrors();return this.isDirty&&e?void this.alertPreventLostChanges(400,401):!this.isDirty||e?void this.loadAssignment(this.unconfirmedAssignmentCode):void this.confirmAssignmentChange()},AMHAssignmentContentComponent.prototype.disableRuleCreation=function(){return this.disableInputs||this.hasThisAssignmentErrors()},AMHAssignmentContentComponent.prototype.createNewAssignment=function(){this.assignment=new c.AssignmentUnique(!1,new c.BackendPK("",""),"","","","",void 0,void 0,"","","",[],[]),this.fillBackends(),this.isCreation=!0,this.creationStatus.emit(this.isCreation),this.assignmentUpdate.emit(this.assignment),this.assignmentSequenceErrorMsg="",this.assignmentCopiesErrorMsg="",this.isDirty=!1,this.amhAssignmentService.updateDirtyStatus(this.isDirty),this.haveRulesErrors=!1,this.emitDisableEnableSaveButtons()},AMHAssignmentContentComponent.prototype.isInteger=function(e){return e%1===0},AMHAssignmentContentComponent.prototype.updateAssignmentUniquenessErrorMsg=function(e){var t=this;this.assignmentSequenceErrorMsg="",this.logger.debug("[assingmentWithSequence] calling findAssignmentsBySequence(%s,%s)",this.config.type,e),this.amhAssignmentService.findAssignmentsBySequence(this.config.type,e).subscribe(function(n){t.assignment.code!==n.code&&(t.assignmentSequenceErrorMsg="The sequence "+e+" is already used by the assignment "+n.code)},function(e){t.logger.error("[assingmentWithSequence] Can't get assignments. Error code: %s, URL: %s ",e.status,e.url)},function(){t.emitDisableEnableSaveButtons()})},AMHAssignmentContentComponent.prototype.updateAssignmentCodeUniquenessErrorMsg=function(e){var t=this;this.assignmentCodeErrorMsg="",this.amhAssignmentService.findAssignmentsByCode(this.config.type,e).subscribe(function(n){t.assignmentCodeErrorMsg="The code "+e+" already exists "},function(e){t.logger.error("[assingmentWithCode] Can't get assignments. Error code: %s, URL: %s ",e.status,e.url)},function(){t.emitDisableEnableSaveButtons()})},AMHAssignmentContentComponent.prototype.getRulesUniquenessErrorMsgs=function(){if(!this.assignment||!this.assignment.rules)return[];var e={},t=this.assignment.rules.filter(function(t){return!!e[t.sequence]||(e[t.sequence]=t,!1)}).map(function(e){return e.sequence+" is used by "+e.code.toUpperCase()});return t},AMHAssignmentContentComponent.prototype.assignmentSequenceUpdate=function(e){var t=+e.value;this.assignment.sequence;return this.assignmentUpdate.emit(this.assignment),this.isDirty=!0,this.amhAssignmentService.updateDirtyStatus(this.isDirty),!t||!this.isInteger(t)||t<0?(this.assignmentSequenceErrorMsg="Assignment sequence is incorrect",void this.emitDisableEnableSaveButtons()):(this.assignment.sequence=t,void this.updateAssignmentUniquenessErrorMsg(t))},AMHAssignmentContentComponent.prototype.assignmentCopiesUpdate=function(e){var t=+e.value;this.assignment.copies;return this.assignmentUpdate.emit(this.assignment),this.assignmentCopiesErrorMsg="",!t||!this.isInteger(t)||t<0?(this.assignmentCopiesErrorMsg="Assignment copies is incorrect",void this.emitDisableEnableSaveButtons()):(this.assignment.copies=t,this.isDirty=!0,void this.amhAssignmentService.updateDirtyStatus(this.isDirty))},AMHAssignmentContentComponent.prototype.isValidCode=function(e){var t=new RegExp("^[A-Za-z0-9_.-]*$");return t.test(e)},AMHAssignmentContentComponent.prototype.assignmentCodeUpdate=function(e){return this.isDirty=!0,this.amhAssignmentService.updateDirtyStatus(this.isDirty),this.assignment.code=e.value,this.isValidCode(e.value)?void this.updateAssignmentCodeUniquenessErrorMsg(e.value):void(this.assignmentCodeErrorMsg="Valid characters are A-Z a-z 0-9 . - _")},AMHAssignmentContentComponent.prototype.confirmAssignmentChange=function(){return this.isDirty?void this.alertLostChanges():void this.loadAssignment(this.unconfirmedAssignmentCode)},AMHAssignmentContentComponent.prototype.initialization=function(){this.assignmentTextFilter="",this.assignmentCodeErrorMsg="",this.createNewAssignment(),this.doDisableInputs(),this.isDirty=!1,this.amhAssignmentService.updateDirtyStatus(this.isDirty)},AMHAssignmentContentComponent.prototype.afterSaveNewAssignment=function(){this.assignmentTextFilter="",this.assignmentCodeErrorMsg="",this.assignmentSequenceErrorMsg="",this.assignmentCopiesErrorMsg="",this.isCreation=!1,this.creationStatus.emit(this.isCreation),this.isDirty=!1,this.amhAssignmentService.updateDirtyStatus(this.isDirty),this.haveRulesErrors=!1,this.emitDisableEnableSaveButtons()},AMHAssignmentContentComponent.prototype.confirmSelectionTableChanges=function(){var e=this.hasThisAssignmentErrors();return this.isDirty&&e?void this.alertPreventLostChanges():!this.isDirty||e?(this.selectionRollbackType=this.config.type,void this.initialization()):void this.alertLostChanges(100,101,102)},AMHAssignmentContentComponent.prototype.alertPreventLostChanges=function(e,t){void 0===e&&(e=300),void 0===t&&(t=301),this.alert.waitIcon=!1,this.alert.alertFooter=!0,this.alert.cancelButton=!0,this.alert.cancelButtonText="Cancel",this.alert.cancelButtonResponse=e,this.alert.yesButton=!0,this.alert.yesButtonText="Yes",this.alert.yesButtonResponse=t,this.alert.okButton=!1,this.alert.alertHeader=!0,this.alert.alertTitle=" Alert ",this.alert.message="All changes will be lost, Do you want to continue?",this.alert.open()},AMHAssignmentContentComponent.prototype.alertLostChanges=function(e,t,n){void 0===e&&(e=0),void 0===t&&(t=1),void 0===n&&(n=2),this.alert.waitIcon=!1,this.alert.alertFooter=!0,this.alert.cancelButton=!0,this.alert.cancelButtonText="Cancel",this.alert.cancelButtonResponse=e,this.alert.yesButton=!0,this.alert.yesButtonText="Yes",this.alert.yesButtonResponse=t,this.alert.okButton=!0,this.alert.okButtonText="No",this.alert.okButtonResponse=n,this.alert.alertHeader=!0,this.alert.alertTitle=" Alert ",this.alert.message="Do you want to save the changes done?",this.alert.open()},AMHAssignmentContentComponent.prototype.confirmClose=function(e){switch(e){case 0:case 400:break;case 1:this.isCreation&&(this.pendingAssignmentSave=3),this.saveWork.emit({withRollbackType:!1,saveAndContinue:!0});break;case 2:this.loadAssignment(this.unconfirmedAssignmentCode);break;case 100:case 300:this.rollbackSelection.emit(!0);break;case 101:this.saveWork.emit({withRollbackType:!0,saveAndContinue:!0}),this.pendingAssignmentSave=2,this.selectionRollbackType=this.config.type;break;case 102:case 301:this.initialization(),this.selectionRollbackType=this.config.type;break;case 201:this.saveWork.emit({withRollbackType:!1,saveAndContinue:!0}),this.pendingAssignmentSave=1;break;case 202:this.navigateTo(this.pendingNavigationConfig.composentName,this.pendingNavigationConfig.parameters);break;case 401:this.loadAssignment(this.unconfirmedAssignmentCode);break;default:return}},AMHAssignmentContentComponent.prototype.actionRuleNavigation=function(e){var t={code:e,return_to:"AMHAssignmentEdit",params:"code="+this.assignment.code+"&st="+this.config.type};if(!this.hasThisAssignmentErrors()){if(!this.isDirty)return void this.navigateTo("AMHRuleCreate",t);this.pendingNavigationConfig={composentName:"AMHRuleCreate",parameters:t},this.alertLostChanges(0,201,202)}},AMHAssignmentContentComponent.prototype.navigateTo=function(e,t){this.router.parent.navigate([e,t])},AMHAssignmentContentComponent.prototype.actionSetDirtyTrue=function(){this.isDirty=!0,this.amhAssignmentService.updateDirtyStatus(this.isDirty)},__decorate([s.ViewChild(l.Alert),__metadata("design:type",Object)],AMHAssignmentContentComponent.prototype,"alert",void 0),__decorate([s.Input("selection-config"),__metadata("design:type",c.AssignmentConfig)],AMHAssignmentContentComponent.prototype,"config",void 0),__decorate([s.Input("save-status"),__metadata("design:type",String)],AMHAssignmentContentComponent.prototype,"saveStatus",void 0),__decorate([s.Output(),__metadata("design:type",s.EventEmitter)],AMHAssignmentContentComponent.prototype,"enableSaveButtons",void 0),__decorate([s.Output(),__metadata("design:type",s.EventEmitter)],AMHAssignmentContentComponent.prototype,"assignmentUpdate",void 0),
__decorate([s.Output(),__metadata("design:type",s.EventEmitter)],AMHAssignmentContentComponent.prototype,"saveWork",void 0),__decorate([s.Output(),__metadata("design:type",s.EventEmitter)],AMHAssignmentContentComponent.prototype,"rollbackSelection",void 0),__decorate([s.Output(),__metadata("design:type",s.EventEmitter)],AMHAssignmentContentComponent.prototype,"creationStatus",void 0),AMHAssignmentContentComponent=__decorate([s.Component({selector:"amh-assignment-content",template:n(1262),providers:[o.AMHAssignmentService,h.Auth],directives:[i.NgClass,r.DataTableDirectives,l.Alert,d.AMHRuleSelectionComponent,p.AMHBackendSelectionComponent,u.AMHAssignmentSearchComponent,g.Permissions,g.NotPermissions,g.DisablePermissions]}),__metadata("design:paramtypes",[a.Router,a.RouteParams,o.AMHAssignmentService,h.Auth,h.Logger])],AMHAssignmentContentComponent)}();t.AMHAssignmentContentComponent=m},1262:function(e,t){e.exports='<!--main content start-->\r\n<div class="row">\r\n    <div class="col-sm-12 col-md-12 col-lg-12">\r\n\r\n        <div class="row">\r\n            <!--style="padding-right: 0px;"-->\r\n            <div class="col-sm-12 col-md-6 col-lg-6" > \r\n                <div class="panel-heading" style="border-top:solid #ccc 1px;">\r\n                    <span class="panel-title word-break" style="font-weight: 300;font-family: Lato;">Assignment Details [<b>{{assignment.code}}</b>]</span>\r\n                    <i [routerLink]=" [\'AMHSimulation\', { \'st\': config.type, \'code\': assignment.code }, \'AMHSimulatorComponent\'] " class="fa fa-play-circle-o pull-right margin-right image-pointer" aria-hidden="true" style="font-size:2em;margin-top: 7px;"></i>\r\n                    <button [gpEnabled]="[\'amh.modify.assignment\']" class="btn btn-default btn-sm" style="float: right; margin-top:5px;" (click)="actionCreateNewAssignment()"> Create Assignment </button>\r\n                    <!--<i class="fa fa-plus-square-o" [ngClass]="{ \'image-pointer\' : disableInputs }" style="float: right; padding-top:10px; font-size:1.5em; border-right:0px;" aria-hidden="true" ></i>-->\r\n                    <!--<h3 class="panel-title">Assignment Details</h3>-->\r\n                </div>\r\n                <div class="panel-body" style="border:solid #ccc 1px; padding:0px 0px 15px 15px;">\r\n                    <div class="col-sm-12 col-md-12 col-lg-12" style="padding: 5px 10px 0px 0px;">\r\n                        <div class="row">\r\n                            <div class="col-sm-12 col-md-6 col-lg-6">\r\n                            <amh-assignment-search [default-code]="assignmentTextFilter" [assignment-type]="config.type" (assignmentSelected)="selectAssignment($event)"> </amh-assignment-search>\r\n                        </div>\r\n                        <div class="col-sm-12 col-md-6 col-lg-6"> \r\n                            &nbsp;\r\n                        </div>\r\n                        </div>\r\n                        <div class="form-group form-group-sm col-lg-6" style="padding-left: 0px;">\r\n                            <span class="col-sm-12 col-md-3 col-lg-3 control-label" style="font-weight:300; padding-left: 0px;">Code&nbsp;*</span>\r\n                            <div class="col-sm-12 col-md-9 col-lg-9" style="padding:0px;">\r\n                                <input [disabled]="disableInputs || !isCreation" type="text" size="20" [value]="assignment.code" (change)="assignmentCodeUpdate($event.target)" />\r\n                            </div>\r\n                            <span *ngIf="assignmentCodeErrorMsg">\r\n                                <div class="text-danger">{{assignmentCodeErrorMsg}}</div>\r\n                            </span>\r\n                        </div>\r\n                        \r\n                        <div class="form-group form-group-sm col-lg-6" style="padding-left:0px;">\r\n                            <span class="col-sm-12 col-md-4 col-lg-4 control-label" style="font-weight:300;  padding-left: 0px;">Sequence&nbsp;*</span>\r\n                            <div class="col-sm-12 col-md-7 col-lg-7" style="padding:0px;">\r\n                                <input [disabled]="disableInputs" type="number" min="1" max="1000" size="6" style="width:13em" [value]="assignment.sequence" (change)="assignmentSequenceUpdate($event.target)"/>\r\n                            </div>\r\n                            <div *ngIf="assignmentSequenceErrorMsg" class="text-danger">{{assignmentSequenceErrorMsg}}</div>\r\n                        </div>\r\n                        <div class="form-group form-group-sm col-lg-6" style="padding-left: 0px;">\r\n                            <span class="col-sm-12 col-md-3 col-lg-3 control-label" style="font-weight:300;  padding-left: 0px;">Active</span>\r\n                            <div class="col-sm-12 col-md-9 col-lg-9" style="padding:0px 5px 5px 1px;">\r\n                                <input (change)="actionSetDirtyTrue()" [disabled]="disableInputs" type="checkbox" [(ngModel)]="assignment.active">\r\n                            </div>\r\n                        </div>\r\n                        <div class="form-group form-group-sm col-lg-6" style="padding-left:0px;  margin:0px 0px 10px 0px;">\r\n                            <span class="col-sm-12 col-md-4 col-lg-4 control-label" style="font-weight:300;  padding-left: 0px;">Description</span>\r\n                            <div class="col-sm-12 col-md-7 col-lg-7" style="padding:5px 0px;">\r\n                                <input (change)="actionSetDirtyTrue()" [disabled]="disableInputs" type="text" size="20" [(ngModel)]="assignment.description" />\r\n                            </div>\r\n                        </div>\r\n                        \r\n                        <div *ngIf="config.showExtraFields()" class="form-group form-group-sm col-lg-6" style="padding-left: 0px;">\r\n                            <span class="col-sm-12 col-md-3 col-lg-3 control-label" style="font-weight:300;  padding-left: 0px;">Name</span>\r\n                            <div class="col-sm-12 col-md-9 col-lg-9" style="padding:5px 5px;">\r\n                                <input (change)="actionSetDirtyTrue()" [disabled]="disableInputs" type="text" size="20" [(ngModel)]="assignment.name" />\r\n                            </div>\r\n                        </div>\r\n\r\n                        <div *ngIf="config.showExtraFields()" class="form-group form-group-sm col-lg-6" style="padding-left:0px;">\r\n                            <span class="col-sm-12 col-md-4 col-lg-4 control-label" style="font-weight:300;  padding-left: 0px;">Num Copies</span>\r\n                            <div class="col-sm-12 col-md-7 col-lg-7" style="padding:0px;">\r\n                                <input (change)="actionSetDirtyTrue()" [disabled]="disableInputs" type="number" min="1" max="1000" size="6" style="width:13em" [value]="assignment.copies" (change)="assignmentCopiesUpdate($event.target)"/>\r\n                            </div>\r\n                            <div *ngIf="assignmentCopiesErrorMsg" class="text-danger">{{assignmentCopiesErrorMsg}}</div>\r\n                        </div>\r\n                        <div *ngIf="!config.showExtraFields() && !assignmentSequenceErrorMsg && !assignmentCopiesErrorMsg && !assignmentCodeErrorMsg" style="margin-bottom:70px;">&nbsp;</div>\r\n                        <div *ngIf="config.showExtraFields() && !assignmentSequenceErrorMsg && !assignmentCopiesErrorMsg && !assignmentCodeErrorMsg" style="margin-bottom:30px;">&nbsp;</div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div class="col-sm-12 col-md-6 col-lg-6">\r\n                <div class="row col-sm-12 col-md-12 col-lg-12">\r\n                <div class="panel-heading" style="border-top:solid #ccc 1px;">\r\n                    <h3 class="panel-title">Backend Selection</h3>\r\n                </div>\r\n                <!--padding:10px 15px;-->\r\n                <div class="panel-body" style="border:solid #ccc 1px; ">\r\n                    <amh-backend-selection *gpIf="[\'amh.modify.assignment\']" [disabled]="disableInputs" [max-backends]="config.maxBackendsAllowed" [existing-backends]="usedBackends" (backendAdded)="addBackend($event)"\r\n                        (backendDeleted)="deleteBackend($event)"></amh-backend-selection>\r\n                    <amh-backend-selection *gpNotIf="[\'amh.modify.assignment\']" disabled=true [max-backends]="config.maxBackendsAllowed" [existing-backends]="usedBackends"></amh-backend-selection>\r\n                </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <!-- ./row -->\r\n        <div class="row col-sm-12 col-md-12 col-lg-12" style="margin-top:10px;">\r\n            <!--<div class="col-sm-12 col-md-12 col-lg-12">-->\r\n                <div class="panel-heading" style="border-top:solid #ccc 1px;">\r\n\r\n                    <!--<h3 class="panel-title">Rule Selection</h3>-->\r\n                    <span class="panel-title word-break" style="font-weight: 300;font-family: Lato;">Rule Selection</span>\r\n                    <button *gpIf="[\'amh.modify.rule\']" [disabled]="disableRuleCreation()" class="btn btn-default btn-sm" style="float: right; margin-top:5px;" (click)="actionRuleNavigation()"> Create Rule </button>\r\n                    <button *gpNotIf="[\'amh.modify.rule\']" disabled=true class="btn btn-default btn-sm" style="float: right; margin-top:5px;"> Create Rule </button>\r\n                </div>\r\n                <div class="panel-body" style="border:solid #ccc 1px; padding: 0px 15px 0px 15px;">\r\n                    <amh-rule-selection *gpIf="[\'amh.modify.assignment\']" [disabled]="disableInputs" [assignment-type]="config.type" [assignment-code]="assignment.code" [existing-rules]="assignment.rules" (statusChanged)="actionChangeRuleStatus($event)"\r\n                        (ruleAdded)="addRule($event)" (ruleDeleted)="deleteRule($event)" (ruleNavigate)="actionRuleNavigation($event)"></amh-rule-selection>\r\n                    <amh-rule-selection *gpNotIf="[\'amh.modify.assignment\']" disabled=true [assignment-type]="config.type" [assignment-code]="assignment.code" [existing-rules]="assignment.rules"\r\n                         (ruleNavigate)="actionRuleNavigation($event)"></amh-rule-selection>\r\n                </div>\r\n            <!--</div>-->\r\n        </div>\r\n        <!-- ./row -->\r\n    </div>\r\n</div>\r\n<!--/.row -->\r\n\r\n\r\n<alert (alertOutput)="confirmClose($event)"></alert>'},1226:function(e,t,n){"use strict";function __export(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}__export(n(1225))},1227:function(e,t,n){"use strict";var s=n(30),i=n(1164),o=n(58),a=n(880),r=n(926),c=n(887),l=n(531),d=n(530),p=n(1226),u=n(1166),g=n(258),h=n(38),m=function(){function AMHAssignmentComponent(e,t,n,s,i){this.router=e,this.amhAssignmentService=n,this.auth=s,this.logger=i,this.disabledSaveButtons=!1,this.assignment=void 0,this.returnParameters={},this.saveStatus="",this.confirmation=void 0,this.menuConfig=[new l.MenuConfig("fa fa-home","Home","Home"),new l.MenuConfig("fa fa-sitemap","AMHHome","AMH Routing"),new l.MenuConfig("fa fa-cloud-download","","Back End Assignment Rule Criteria")],this.selectionTables=[new r.Option(1,"BK_CH","Backend Channel"),new r.Option(2,"DTN_CPY","Distribution Copy"),new r.Option(4,"FEED_DTN_CPY","Feedback Distribution Copy")],this.setReturnTo(t.params.return_to),this.addReturnParamter("st",t.params.st),this.updateSelectionTable(this.selectedAssignmentType(+t.params.st))}return AMHAssignmentComponent.prototype.ngOnInit=function(){},AMHAssignmentComponent.prototype.selectedAssignmentType=function(e){var t=this.selectionTables.find(function(t){return t.id===e});return t?t:this.selectionTables[0]},AMHAssignmentComponent.prototype.addReturnParamter=function(e,t){t&&(this.returnParameters[e]=t)},AMHAssignmentComponent.prototype.setReturnTo=function(e){if(this.returnToString="AMHHome",e&&0!=e.length){var t=e.split("&");this.returnToString=t[0]||"AMHHome"}},AMHAssignmentComponent.prototype.alertOpen=function(){this.alert.alertFooter=!1,this.alert.cancelButton=!1,this.alert.okButton=!1,this.alert.alertHeader=!0,this.alert.alertTitle="Alert",this.alert.message="Save in progress...",this.alert.cancelButtonText="Ok",this.alert.cancelButtonResponse=0,this.alert.open()},AMHAssignmentComponent.prototype.closeAlert=function(e,t){var n=this;this.alert.cancel(),e||t||setTimeout(function(){return n.router.parent.navigate([n.returnToString,n.returnParameters])},1200)},AMHAssignmentComponent.prototype.isValidAssigment=function(){if(!this.assignment)return{isValid:!1,errorMsgs:["No assignment defined"]};var e="";return{isValid:!e||0==e.length,errorMsgs:e}},AMHAssignmentComponent.prototype.msgEmptyRules=function(){this.alert.waitIcon=!1,this.alert.alertFooter=!0,this.alert.okButton=!1,this.alert.alertHeader=!0,this.alert.alertTitle="Alert",this.alert.message="No rules assigned. Every message will be send to the assigned backend(s).",this.alert.cancelButton=!0,this.alert.cancelButtonText="Cancel",this.alert.cancelButtonResponse=0,this.alert.yesButton=!0,this.alert.yesButtonText="OK",this.alert.yesButtonResponse=1,this.alert.open()},AMHAssignmentComponent.prototype.alertResponse=function(e){switch(e){case 0:this.saveStatus="Cancel";break;case 1:this.saveStatus="",this.doSave(this.saveAndContinue,this.withRollbackType);break;case 300:break;case 301:this.router.parent.navigate([this.navigateUrl,this.returnParameters])}},AMHAssignmentComponent.prototype.save=function(e,t){return 0==this.assignment.rules.length?(this.msgEmptyRules(),this.saveAndContinue=e,void(this.withRollbackType=t)):void this.doSave(e,t)},AMHAssignmentComponent.prototype.doSave=function(e,t){var n=this,s=this.isValidAssigment();s.isValid||s.errorMsgs.forEach(function(e){return n.logger.error(e)});var i=t?this.optionRollback.id:this.defaultOption.id;this.alertOpen();var o;o=this.isCreation?this.amhAssignmentService.createAssignment(i,this.assignment,this.auth.getUser()):this.amhAssignmentService.saveAssignment(i,this.assignment,this.auth.getUser()),o.subscribe(function(e){},function(t){n.logger.error("[saveRule] Can't get assignments. Error code: %s, URL: %s ",t.status,t.url),n.alert.message="An error has occurred, the backend cannot be assigned !!",n.closeAlert(e,!0),n.saveStatus="Error",e&&(n.confirmation={msg:"An error has occurred, while saving this assignment !!",type:"danger",closable:!0})},function(){n.alert.message="Assignment done sucessfuly !!",n.closeAlert(e),e&&(n.confirmation={msg:"Assignment saved",type:"success",closable:!0}),n.saveStatus="OK",n.isCreation=!1})},AMHAssignmentComponent.prototype.actionCancel=function(){this.verifyAndNavigate(this.returnToString,300,301)},AMHAssignmentComponent.prototype.updateDisabledButtons=function(e){this.disabledSaveButtons=e},AMHAssignmentComponent.prototype.saveWork=function(e){this.save(e.saveAndContinue,e.withRollbackType)},AMHAssignmentComponent.prototype.updateAssignment=function(e){this.assignment=e},AMHAssignmentComponent.prototype.updateSelectionTable=function(e){var t=this.defaultOption?this.defaultOption.code:e.code;this.optionRollback=this.selectionTables.find(function(e){return e.code===t}),this.defaultOption=e,this.assignmentConfig=new a.AssignmentConfig(e.id)},AMHAssignmentComponent.prototype.rollbackSelectionTable=function(e){return this.assignmentConfig.type==this.optionRollback.id?void this.logger.debug("No changes to rollback"):(this.defaultOption=this.optionRollback,void(this.assignmentConfig=new a.AssignmentConfig(this.defaultOption.id)))},AMHAssignmentComponent.prototype.actionUpdateCreationStatus=function(e){this.isCreation=e},AMHAssignmentComponent.prototype.alertPreventLostChanges=function(e,t){this.alert.waitIcon=!1,this.alert.alertFooter=!0,this.alert.cancelButton=!0,this.alert.cancelButtonText="Cancel",this.alert.cancelButtonResponse=e,this.alert.yesButton=!0,this.alert.yesButtonText="Yes",this.alert.yesButtonResponse=t,this.alert.okButton=!1,this.alert.alertHeader=!0,this.alert.alertTitle=" Alert ",this.alert.message="All changes will be lost, Do you want to continue?",this.alert.open()},AMHAssignmentComponent.prototype.actionNavigate=function(e){this.verifyAndNavigate(e,300,301)},AMHAssignmentComponent.prototype.verifyAndNavigate=function(e,t,n){var s=this.amhAssignmentService.isAssignmentStatusDirty();return s?(this.logger.debug("inside if "+s),this.navigateUrl=e,void this.alertPreventLostChanges(t,n)):(this.logger.debug("it was not dirty going to "+e),void this.router.parent.navigate([e,this.returnParameters]))},__decorate([s.ViewChild(c.Alert),__metadata("design:type",Object)],AMHAssignmentComponent.prototype,"alert",void 0),AMHAssignmentComponent=__decorate([s.Component({selector:"amh-assignment",template:n(1263),providers:[i.AMHAssignmentService,h.Auth],directives:[u.AMHSelectionTableComponent,p.AMHAssignmentContentComponent,c.Alert,d.HeaderSecondary,g.Permissions,g.NotPermissions]}),__metadata("design:paramtypes",[o.Router,o.RouteParams,i.AMHAssignmentService,h.Auth,h.Logger])],AMHAssignmentComponent)}();t.AMHAssignmentComponent=m},1263:function(e,t){e.exports='<section id="main-content">\r\n    <section class="wrapper">\r\n        <menu-header [header-alert]="confirmation" [header-navigate]="false" [header-menu]="menuConfig" (navigate)="actionNavigate($event)"></menu-header>\r\n\r\n        <div class="row">\r\n            <div class="col-sm-12 col-md-12 col-lg-12">\r\n                <div class="panel panel-default">\r\n                    <div class="panel-heading">\r\n                    <div class="row col-sm-12 col-md-12 col-lg-12">\r\n                        <amh-selection-table style="padding:0px;" class="col-sm-4 col-md-4 col-lg-4" [default-option]="defaultOption" [options]="selectionTables" (tableSelected)="updateSelectionTable($event)">\r\n                        </amh-selection-table>\r\n                        <div class="col-sm-8 col-md-8 col-lg-8">&nbsp;</div>\r\n                    </div>\r\n                    </div>\r\n                    <div class="panel-body" style="padding-top:8px;">\r\n                        <amh-assignment-content [save-status]="saveStatus" [selection-config]="assignmentConfig" (rollbackSelection)="rollbackSelectionTable($event)" (enableSaveButtons)="updateDisabledButtons($event)" (saveWork)="saveWork($event)"\r\n                             (creationStatus)="actionUpdateCreationStatus($event)" (assignmentUpdate)="updateAssignment($event)">\r\n                        </amh-assignment-content>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <!--/.row-->\r\n    </section>\r\n</section>\r\n\r\n<alert (alertOutput)="alertResponse($event)"></alert>\r\n\r\n<footer class="footer dark-bg">\r\n    <div class="row">\r\n        <div class="col-sm-12 col-md-12 col-lg-12">\r\n            <div class="top-nav notification-row pull-right">\r\n                <button *gpIf="[\'amh.modify.assignment\']" [disabled]="disabledSaveButtons" class="btn btn-primary" (click)="save(true)"> Save & Continue</button>\r\n                <button *gpIf="[\'amh.modify.assignment\']" [disabled]="disabledSaveButtons" class="btn btn-primary" (click)="save(false)"> Save </button>\r\n                <button *gpNotIf="[\'amh.modify.assignment\']" disabled=true class="btn btn-primary"> Save & Continue</button>\r\n                <button *gpNotIf="[\'amh.modify.assignment\']" disabled=true class="btn btn-primary"> Save </button>\r\n                <button class="btn btn-default" (click)="actionCancel()"> Back</button>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</footer>'},1141:function(e,t,n){"use strict";function __export(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}__export(n(1227))},1228:function(e,t,n){"use strict";var s=n(30),i=n(1164),o=n(900),a=n(880),r=n(887),c=n(38),l=function(){function AMHBackendSelectionComponent(e,t,n){this.amhAssignmentService=e,this.elementRef=t,this.logger=n,this.maxBackends=1e3,this.disabledParam=!1,this.backendAdded=new s.EventEmitter,this.backendDeleted=new s.EventEmitter,this.backends=[],this.originalBackends=[],this.bodyMargin=0,this.selectedBackend=new a.Backend("",""),this.selectedPkDirection="",this.backendCodeToDelete=void 0,this.activePage=1,this.disabled=!0,this.backendDataSource=this.amhAssignmentService.findBackends()}return AMHBackendSelectionComponent.prototype.ngOnChanges=function(e){e.existingBackends&&this.dynamicUpdate()},AMHBackendSelectionComponent.prototype.ngOnInit=function(){var e=this;this.backendDataSource.subscribe(function(t){var n=i.AMHAssignmentService.getFromSource(t);n.forEach(function(t){e.originalBackends.push(t)})},function(t){return e.logger.error("Can't get backends. Error code: %s, URL: %s ",t.status,t.url)})},AMHBackendSelectionComponent.prototype.handleClick=function(e){var t=e.target,n=!1;do t===this.elementRef.nativeElement&&(n=!0),t=t.parentNode;while(t);n||(this.backends=[],this.selectedBackend.code&&this.selectedBackend.pkDirection||(this.selectedBackend=new a.Backend("","")))},AMHBackendSelectionComponent.prototype.select=function(e){this.selectedBackend=new a.Backend(e.pkCode,e.pkDirection,e.code,e.dataOwner,e.description),this.selectedPkDirection=e.pkDirection,this.backends=[]},AMHBackendSelectionComponent.prototype.dynamicUpdate=function(){this.calculeInputDisabled(),this.calculeBodyMargin()},AMHBackendSelectionComponent.prototype.calculeInputDisabled=function(){this.disabled=this.disabledParam||this.existingBackends.length>=this.maxBackends},AMHBackendSelectionComponent.prototype.calculeBodyMargin=function(){return this.existingBackends.length>=4?void(this.bodyMargin=0):0==this.existingBackends.length?void(this.bodyMargin=67):1==this.existingBackends.length?void(this.bodyMargin=39):2==this.existingBackends.length?void(this.bodyMargin=22):3==this.existingBackends.length?void(this.bodyMargin=4):void 0},AMHBackendSelectionComponent.prototype.add=function(){if(this.selectedBackend.pkCode&&this.selectedBackend.pkDirection){var e=new a.Backend(this.selectedBackend.pkCode,this.selectedBackend.pkDirection,this.selectedBackend.code,this.selectedBackend.dataOwner,this.selectedBackend.description,this.selectedBackend.lockCode);this.backendAdded.emit(e),this.existingBackends=[e].concat(this.existingBackends),this.selectedBackend=new a.Backend("",""),this.selectedPkDirection="",this.dynamicUpdate()}},AMHBackendSelectionComponent.prototype.deleteBackend=function(e){this.confirmBackendDeletion(),this.backendCodeToDelete=e.pkCode},AMHBackendSelectionComponent.prototype.confirmBackendDeletion=function(){this.alert.waitIcon=!1,this.alert.alertFooter=!0,this.alert.cancelButton=!1,this.alert.yesButton=!0,this.alert.yesButtonText="Yes",this.alert.yesButtonResponse=21,this.alert.okButton=!0,this.alert.okButtonText="No",this.alert.okButtonResponse=22,this.alert.alertHeader=!0,this.alert.alertTitle=" Alert ",this.alert.message="Are you sure you want to unassign this backend?",this.alert.open()},AMHBackendSelectionComponent.prototype.confirmClose=function(e){var t=this;0!==e&&(21==e&&(this.existingBackends=this.existingBackends.filter(function(e){return e.pkCode!==t.backendCodeToDelete}),this.backendDeleted.emit(this.backendCodeToDelete),this.backendCodeToDelete="",this.table.setPage(1,3),this.dynamicUpdate()),22==e&&(this.backendCodeToDelete=""))},AMHBackendSelectionComponent.prototype.updateBackends=function(e){if(!e)return void(this.backends=[]);var t={};this.selectedPkDirection="",this.selectedBackend.pkDirection="",this.existingBackends.forEach(function(e){return t[e.pkCode]=!0});var n=this.originalBackends.filter(function(e){return!t[e.pkCode]}),s=e.toUpperCase(),i=n.filter(function(e){return e.pkCode.toUpperCase().match(s)}),o=n.filter(function(e){return e.pkDirection.toUpperCase().match(s)}),a=i.concat(o),r=[];a.forEach(function(e){var t=r.find(function(t,n,s){return e.pkCode==t.pkCode});t||r.push(e)}),this.backends=r.map(function(e){return e.pkCode=e.pkCode.toUpperCase(),e})},__decorate([s.ViewChild(r.Alert),__metadata("design:type",Object)],AMHBackendSelectionComponent.prototype,"alert",void 0),__decorate([s.ViewChild(o.DataTable),__metadata("design:type",Object)],AMHBackendSelectionComponent.prototype,"table",void 0),__decorate([s.Input("existing-backends"),__metadata("design:type",Array)],AMHBackendSelectionComponent.prototype,"existingBackends",void 0),__decorate([s.Input("max-backends"),__metadata("design:type",Number)],AMHBackendSelectionComponent.prototype,"maxBackends",void 0),__decorate([s.Input("disabled"),__metadata("design:type",Boolean)],AMHBackendSelectionComponent.prototype,"disabledParam",void 0),__decorate([s.Output(),__metadata("design:type",s.EventEmitter)],AMHBackendSelectionComponent.prototype,"backendAdded",void 0),__decorate([s.Output(),__metadata("design:type",s.EventEmitter)],AMHBackendSelectionComponent.prototype,"backendDeleted",void 0),AMHBackendSelectionComponent=__decorate([s.Component({selector:"amh-backend-selection",template:n(1264),host:{"(document:click)":"handleClick($event)"},providers:[i.AMHAssignmentService],directives:[r.Alert,o.DataTableDirectives]}),__metadata("design:paramtypes",[i.AMHAssignmentService,s.ElementRef,c.Logger])],AMHBackendSelectionComponent)}();t.AMHBackendSelectionComponent=l},1264:function(e,t){e.exports='<!--main content start-->\r\n    <input [disabled]="disabled" [(ngModel)]="selectedBackend.pkCode" (keyup)="updateBackends($event.target.value)" style="margin:5px 5px 10px 0px;"\r\n    /> &nbsp;\r\n    <i class="fa fa-plus-square image-pointer" aria-hidden="true" (click)="add()" style="font-size:1.2em;"></i> &nbsp;\r\n    <!--<span *ngIf="selectedBackend != undefined"> {{selectedPkDirection}}</span>-->\r\n    <div style="width:60%; height:200px; overflow: auto; z-index:200;" class="suggestions" *ngIf="backends.length > 0">\r\n        <table style="width:100%;" >\r\n            <tbody>\r\n                <tr *ngFor="let item of backends" (click)="select(item)">\r\n                    <td> <b>{{item.pkCode}}</b> </td>\r\n                    <td> {{item.pkDirection}} </td>\r\n                </tr>\r\n            </tbody>\r\n        </table>\r\n    </div>\r\n        <p *ngIf="existingBackends.length == 0"> <b>No backend associated to assignment (mandatory) </b> </p>\r\n        <table *ngIf="existingBackends.length > 0" class="table table-striped table-bordered table-condensed table-responsive" [mfData]="existingBackends"\r\n            #assignedTable="mfDataTable" [mfRowsOnPage]="3" [mfActivePage]="activePage">\r\n            <thead>\r\n                <tr>\r\n                    <th style="width: 8%"> Action </th>\r\n                    <th style="width: 39%">Code </th>\r\n                    <th style="width: 53%"> Direction </th>\r\n                </tr>\r\n            </thead>\r\n            <tbody>\r\n                <tr *ngFor="let backend of assignedTable.data">\r\n                    <td>&nbsp; &nbsp;\r\n                        <i class="fa fa-times image-pointer" aria-hidden="true" (click)="deleteBackend(backend)" style="font-size:1.5em;"></i>                                </td>\r\n                    <td class="color-black">{{ backend.pkCode | uppercase }}</td>\r\n                    <td class="color-black">{{ backend.pkDirection }}</td>\r\n                </tr>\r\n            </tbody>\r\n            <tfoot>\r\n                <tr>\r\n                    <td colspan="3">\r\n                        <mfBootstrapPaginator [rowsOnPageSet]="[]"></mfBootstrapPaginator>\r\n                    </td>\r\n                </tr>\r\n            </tfoot>\r\n        </table>\r\n        <div *ngIf="existingBackends.length < 4" [style.margin.px]="bodyMargin">&nbsp;</div>\r\n<alert (alertOutput)="confirmClose($event)"></alert>'},1229:function(e,t,n){"use strict";function __export(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}__export(n(1228))},1233:function(e,t,n){"use strict";var s=n(30),i=n(901),o=n(880),a=n(900),r=n(887),c=n(38),l=function(){function AMHRuleSelectionComponent(e,t,n){this.amhRoutingService=e,this.elementRef=t,this.logger=n,this.assignType=o.AssignType.BK_CHANNEL,this.assignmentCode="",this.disabled=!1,this.existingRules=[],this.ruleAdded=new s.EventEmitter,this.ruleDeleted=new s.EventEmitter,this.statusChanged=new s.EventEmitter,this.ruleNavigate=new s.EventEmitter,this.rules=[],this.originalRules=[],this.selectedRule=new o.AMHRule("",""),this.selectedExpression="",this.ruleCodeToDelete="",this.ruleErrors=new Map,this.ruleDataSource=this.amhRoutingService.findRules()}return AMHRuleSelectionComponent.prototype.ngOnChanges=function(e){e.disabled&&this.logger.debug("disabled changed "+e.disabled.currentValue)},AMHRuleSelectionComponent.prototype.ngOnInit=function(){var e=this;this.logger.log("hello `AMH rule selection` component"),this.ruleDataSource.subscribe(function(t){if(Array.isArray(t))e.logger.log("Array "+t);else{var n=i.AMHRoutingService.getFromSource(t);n.forEach(function(t){t.code?e.originalRules.push(o.AMHRule.fromJson(t)):e.logger.warn("no code defined in rule  ")})}},function(t){return e.logger.log("Can't get rules. Error code: %s, URL: %s ",t.status,t.url)},function(){return e.logger.log("Rule(s) are retrieved")})},AMHRuleSelectionComponent.prototype.handleClick=function(e){var t=e.target,n=!1;do t===this.elementRef.nativeElement&&(n=!0),t=t.parentNode;while(t);n||(this.rules=[],this.selectedRule.code&&this.selectedRule.expression||(this.selectedRule=new o.AMHRule("","")))},AMHRuleSelectionComponent.prototype.select=function(e){var t=this.originalRules.find(function(t){return t.code.toUpperCase()==e.code.toUpperCase()});this.selectedRule=new o.AMHRule(t.code,t.expression,t.dataOwner,t.lockCode,t.type),this.selectedExpression=t.expression.substr(0,100)+" ...",this.logger.debug(" rule.code "+e.code+" found code "+t.code),this.rules=[]},AMHRuleSelectionComponent.prototype.add=function(){if(!this.selectedRule.code||!this.selectedRule.expression)return void this.logger.log("no rule selected");this.logger.log("selected rule "+this.selectedRule.code);var e=new o.AssignmentUniqueRule(this.selectedRule.code,this.selectedRule.dataOwner,this.selectedRule.lockCode,0);e.expression=this.selectedRule.expression,this.ruleAdded.emit(e),this.statusChanged.emit(!0),this.selectedRule=new o.AMHRule("",""),this.selectedExpression="",this.ruleErrors.set(e.code,["Rule sequence is incorrect"]),this.logger.log(" adding "+e.code)},AMHRuleSelectionComponent.prototype.updateRules=function(e){if(!e)return void(this.rules=[]);var t={};this.selectedExpression="",this.selectedRule.expression="",this.existingRules.forEach(function(e){return t[e.code]=!0});var n=this.originalRules.filter(function(e){return!t[e.code]}),s=e.toUpperCase(),i=n.filter(function(e){return e.expression&&e.expression.toUpperCase().match(s)}),o=n.filter(function(e){return e.code&&e.code.toUpperCase().match(s)}),a=i.concat(o),r=[];a.forEach(function(e){var t=r.find(function(t,n,s){return e.code==t.code});t||r.push(e)}),this.rules=r.map(function(e){return e.cloneWithUpperCaseCode()})},AMHRuleSelectionComponent.prototype.errorMsg=function(e){return this.ruleErrors.get(e)&&this.ruleErrors.get(e).length>0?this.ruleErrors.get(e)[0]:""},AMHRuleSelectionComponent.prototype.isInteger=function(e){return e%1===0},AMHRuleSelectionComponent.prototype.getRulesUniquenessErrorMsgs=function(){if(!this.existingRules)return[];var e={},t=[];this.existingRules.filter(function(n){return e[n.sequence]?(t.push({code:n.code,msg:n.sequence+" is used by "+e[n.sequence].code.toUpperCase()}),!0):(e[n.sequence]=n,!1)}).map(function(e){return{code:e.code,msg:e.sequence+" is used by "+e.code.toUpperCase()}});return t},AMHRuleSelectionComponent.prototype.ruleSequenceUpdate=function(e,t){var n=this,s=+t.value,i=this.existingRules.find(function(t){return t.code===e});if(void 0===i)return this.logger.log("rulecode "+e+" not found in assignment rule list "),
this.ruleErrors.set(i.code,["rule code"+e+" does not exist un assignment rule list"]),void this.statusChanged.emit(!0);this.logger.log("emmiting assignment from content"),this.ruleErrors.set(i.code,[]);var o=i.sequence;if(!s||!this.isInteger(s)||s<0)return this.logger.log(" not valid sequence "+s+" old value "+i.sequence),this.logger.log("++++setting is not good "+e),this.ruleErrors.set(i.code,["Rule sequence is incorrect"]),void this.statusChanged.emit(!0);i.sequence=s;var a=this.getRulesUniquenessErrorMsgs();if(a.length>0)this.logger.log("+++++has uniqueness errors returning old value of "+o),this.ruleErrors.set(i.code,a.map(function(e){return e.msg})),this.statusChanged.emit(!0);else{this.logger.log("there is no duplicates sequences on assignment rules ");var r=!1,c=!0;this.ruleErrors.forEach(function(e,t,s){if(c=!1,e&&e.length>0){c=!0;var i=e.find(function(e){return e.indexOf("is used by")>0});i&&(n.ruleErrors.set(t,[]),c=!1)}r=r||c}),this.statusChanged.emit(r)}},AMHRuleSelectionComponent.prototype.deleteRule=function(e){this.confirmRuleDeletion(),this.ruleCodeToDelete=e.code},AMHRuleSelectionComponent.prototype.actionNavigationEmit=function(e){this.logger.debug("going to rule edition"),this.ruleNavigate.emit(e.code)},AMHRuleSelectionComponent.prototype.confirmRuleDeletion=function(){this.alert.waitIcon=!1,this.alert.alertFooter=!0,this.alert.cancelButton=!1,this.alert.yesButton=!0,this.alert.yesButtonText="Yes",this.alert.yesButtonResponse=21,this.alert.okButton=!0,this.alert.okButtonText="No",this.alert.okButtonResponse=22,this.alert.alertHeader=!0,this.alert.alertTitle=" Alert ",this.alert.message="Are you sure you want to unassign this rule?",this.alert.open()},AMHRuleSelectionComponent.prototype.confirmClose=function(e){var t=this;if(this.logger.log("confirming ------------  "+e),0!==e){if(21==e){this.logger.log("deleting... "+this.ruleCodeToDelete),this.existingRules=this.existingRules.filter(function(e){return e.code!==t.ruleCodeToDelete}),this.ruleErrors.set(this.ruleCodeToDelete,[]),this.ruleDeleted.emit(this.ruleCodeToDelete),this.ruleCodeToDelete="";var n=this.getRulesUniquenessErrorMsgs();this.statusChanged.emit(n.length>0);this.ruleErrors=new Map,n.forEach(function(e){t.ruleErrors.set(e.code,[e.msg])}),this.table.setPage(1,5)}22==e&&(this.logger.log("no deletion for rule "+this.ruleCodeToDelete),this.ruleCodeToDelete="")}},__decorate([s.ViewChild(a.DataTable),__metadata("design:type",Object)],AMHRuleSelectionComponent.prototype,"table",void 0),__decorate([s.Input("assignment-type"),__metadata("design:type",Number)],AMHRuleSelectionComponent.prototype,"assignType",void 0),__decorate([s.Input("assignment-code"),__metadata("design:type",String)],AMHRuleSelectionComponent.prototype,"assignmentCode",void 0),__decorate([s.Input("disabled"),__metadata("design:type",Boolean)],AMHRuleSelectionComponent.prototype,"disabled",void 0),__decorate([s.Input("existing-rules"),__metadata("design:type",Array)],AMHRuleSelectionComponent.prototype,"existingRules",void 0),__decorate([s.Output(),__metadata("design:type",s.EventEmitter)],AMHRuleSelectionComponent.prototype,"ruleAdded",void 0),__decorate([s.Output(),__metadata("design:type",s.EventEmitter)],AMHRuleSelectionComponent.prototype,"ruleDeleted",void 0),__decorate([s.Output(),__metadata("design:type",s.EventEmitter)],AMHRuleSelectionComponent.prototype,"statusChanged",void 0),__decorate([s.Output(),__metadata("design:type",s.EventEmitter)],AMHRuleSelectionComponent.prototype,"ruleNavigate",void 0),__decorate([s.ViewChild(r.Alert),__metadata("design:type",Object)],AMHRuleSelectionComponent.prototype,"alert",void 0),AMHRuleSelectionComponent=__decorate([s.Component({selector:"amh-rule-selection",template:n(1268),host:{"(document:click)":"handleClick($event)"},providers:[i.AMHRoutingService],directives:[a.DataTableDirectives,r.Alert]}),__metadata("design:paramtypes",[i.AMHRoutingService,s.ElementRef,c.Logger])],AMHRuleSelectionComponent)}();t.AMHRuleSelectionComponent=l},1268:function(e,t){e.exports='<!--main content start-->\r\n\r\n<input [disabled]="disabled" [(ngModel)]="selectedRule.code" (keyup)="updateRules($event.target.value)" style="margin:8px 5px 10px 0px;" /> &nbsp;\r\n<i class="fa fa-plus-square image-pointer" aria-hidden="true" (click)="add()" style="font-size:1.2em;"></i> &nbsp;\r\n<span *ngIf="selectedRule != undefined"> {{selectedExpression}}</span>\r\n<div style="width:95%; height:250px; overflow: auto;" class="suggestions" *ngIf="rules.length > 0">\r\n    <table style="width:100%;">\r\n        <tbody>\r\n            <tr *ngFor="let item of rules" (click)="select(item)">\r\n                <td style="width:15%"> <b>{{item.code}}</b> </td>\r\n                <td style="width:85%"> {{item.expression}} </td>\r\n            </tr>\r\n        </tbody>\r\n    </table>\r\n</div>\r\n<p *ngIf="existingRules.length == 0"> <b>No rule criteria associated to assignment </b> </p>\r\n<table *ngIf="existingRules.length > 0" class="table table-striped table-bordered table-condensed table-responsive" \r\n    [mfData]="existingRules" #assignedTable="mfDataTable" [mfRowsOnPage]="5">\r\n    <thead>\r\n        <tr>\r\n            <th style="width: 10%"> Action </th>\r\n            <th style="width: 10%"> Sequence </th>\r\n            <th style="width: 16%">\r\n                <mfDefaultSorter by="code">Code</mfDefaultSorter>\r\n            </th>\r\n            <th style="width: 64%">\r\n                <mfDefaultSorter by="expression">Criteria</mfDefaultSorter>\r\n            </th>\r\n        </tr>\r\n    </thead>\r\n    <tbody>\r\n        <!--[routerLink]=" [\'AMHRuleCreate\', { \'code\': rule.code, \'return_to\':\'AMHAssignmentEdit\',\'params\':\'code=\'+assignmentCode+\'&st=\'+assignType }, \'AMHRuleComponent\'] "-->\r\n        <tr *ngFor="let rule of assignedTable.data">\r\n            <td>&nbsp; \r\n                <i class="fa fa-pencil-square-o image-pointer" aria-hidden="true" (click)="actionNavigationEmit(rule)" style="font-size:2em;"></i>&nbsp;&nbsp;&nbsp;\r\n                <i class="fa fa-times image-pointer" aria-hidden="true" (click)="deleteRule(rule)" style="font-size:2em;"></i>                                \r\n            </td>\r\n            <td>\r\n               <div class=""></div>\r\n               <input #ruleSequence type="number" min="1" [value]="rule.sequence" class="form-control" \r\n                 size="6" maxlength="5" (change)="ruleSequenceUpdate(rule.code, ruleSequence)"/>\r\n                <span *ngIf="errorMsg(rule.code)">\r\n                    <div class="text-danger">{{errorMsg(rule.code)}}</div>\r\n                </span>\r\n            </td>\r\n            <td class="color-black">{{ rule.code | uppercase }}</td>\r\n            <td class="color-black">{{ rule.expression }}</td>\r\n        </tr>\r\n    </tbody>\r\n    <tfoot>\r\n        <tr>\r\n            <td colspan="4">\r\n                <mfBootstrapPaginator [rowsOnPageSet]="[5, 10, 25, 50, 100]"></mfBootstrapPaginator>\r\n            </td>\r\n        </tr>\r\n    </tfoot>\r\n</table>\r\n\r\n<alert (alertOutput)="confirmClose($event)"></alert>'},1234:function(e,t,n){"use strict";function __export(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}__export(n(1233))},1165:function(e,t,n){"use strict";var s=n(30),i=n(926),o=n(38),a=function(){function AMHSelectionTableComponent(e){this.logger=e,this.tableSelected=new s.EventEmitter}return AMHSelectionTableComponent.prototype.ngOnInit=function(){this.logger.log("hello `AMH selection table` component")},AMHSelectionTableComponent.prototype.selectOption=function(e){this.logger.log("option selected "+this.options[e].description),this.tableSelected.emit(this.options[e])},__decorate([s.Input("default-option"),__metadata("design:type",i.Option)],AMHSelectionTableComponent.prototype,"optionSelected",void 0),__decorate([s.Input(),__metadata("design:type",Array)],AMHSelectionTableComponent.prototype,"options",void 0),__decorate([s.Input(),__metadata("design:type",String)],AMHSelectionTableComponent.prototype,"label",void 0),__decorate([s.Output(),__metadata("design:type",s.EventEmitter)],AMHSelectionTableComponent.prototype,"tableSelected",void 0),AMHSelectionTableComponent=__decorate([s.Component({selector:"amh-selection-table",template:n(1177)}),__metadata("design:paramtypes",[o.Logger])],AMHSelectionTableComponent)}();t.AMHSelectionTableComponent=a},1177:function(e,t){e.exports='<!--main content start-->\r\n\r\n<div class="row col-lg-12 col-sm-12 col-md-12" style="margin : 0px; padding:0px;">\r\n    <div class=\'form-group form-group-sm\' style="margin:0px;">\r\n        <!--<label class="col-lg-3 col-sm-3 text-center control-label">{{label}}</label>-->\r\n        <select style="width: 100%;" class=\'combo-select col-lg-12 col-sm-12 col-md-12\' [(ngModel)]="optionSelected" (change)="selectOption($event.target.selectedIndex)">\r\n            <option *ngFor="let option of options" [ngValue]="option">{{option.description}}</option>\r\n        </select>\r\n    </div>\r\n</div>'},1166:function(e,t,n){"use strict";function __export(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}__export(n(1165))},1148:function(e,t,n){"use strict";var s=n(257),i=n(30),o=n(14),a=n(880),r=n(38),c=function(){function AMHAssignmentService(e,t,n,s,i){this.http=e,this.config=t,this.store=n,this.fileDownloader=s,this.logger=i,this.environment="UNKNOWN",this.version="DEFAULT",this.persistence=sessionStorage}return AMHAssignmentService.prototype.getAssignmentPath=function(e){switch(e){case a.AssignType.BK_CHANNEL:return"assignments";case a.AssignType.DTN_COPY:return"distributionCopies";case a.AssignType.FEED_DTN_COPY:return"feedbackDtnCopies";default:return"assignments"}},AMHAssignmentService.prototype.findAssignmentByCode=function(e,t){return this.http.get(this.config.get("esBackUrl")+"/amhrouting/"+this.getAssignmentPath(e)+"/"+t).map(function(e){return e.json()}).map(function(e){return e.found?e._source:e})},AMHAssignmentService.prototype.findAssignments=function(e){return this.http.post(this.config.get("esBackUrl")+"/amhrouting/"+this.getAssignmentPath(e)+"/_search?size=1000",'{"sort": [{"sequence": {"order": "asc"}}]}').map(function(e){return e.json()})},AMHAssignmentService.prototype.findRuleByCode=function(e){var t=this;this.logger.log(">> looking for "+e);new a.AMHRule("","");return this.findRules().flatMap(function(n){var s=AMHAssignmentService.getFromSource(n).find(function(t){return t.code.toLowerCase()==(e?e.toLocaleLowerCase():"")});return t.logger.log(">> elastic return  "+s),s?o.Observable.create(function(e){return e.next(s),e.complete(),function(){return t.logger.log("disposed found")}}):o.Observable.create(function(e){return e.next(new a.AMHRule("","")),t.logger.log("returning to observer code=empty"),e.complete(),function(){return t.logger.log("disposed not found")}})})},AMHAssignmentService.prototype.findRules=function(){return this.http.get(this.config.get("esBackUrl")+"/amhrouting/rules/_search?size=100").map(function(e){return e.json()})},AMHAssignmentService.prototype.findBackends=function(){return this.logger.log("findBackends url = "+this.config.get("esBackUrl")),this.http.get(this.config.get("esBackUrl")+"/amhrouting/backends/_search?size=100").map(function(e){return e.json()})},AMHAssignmentService.prototype.findAssignmentsBySequence=function(e,t){var n=this;return this.findAssignments(e).flatMap(function(e){var s=AMHAssignmentService.getFromSource(e),i=[],a=s.find(function(e){return e.sequence==t});return a&&i.push(a),n.logger.log("assignmentBySequence "+i),o.Observable.from(i)})},AMHAssignmentService.prototype.findAssignmentsByCode=function(e,t){var n=this;return this.findAssignments(e).flatMap(function(e){var s=AMHAssignmentService.getFromSource(e),i=[],a=s.find(function(e){return e.code==t});return a&&i.push(a),n.logger.log("assignmentByCode "+i),o.Observable.from(i)})},AMHAssignmentService.prototype.findAssignmentsByBackendPK=function(e,t){var n=this;return this.findAssignments(e).flatMap(function(e){for(var s=AMHAssignmentService.getFromSource(e),i=[],a=0;a<s.length;a++){var r=s[a];if(r.backendPrimaryKey.code===t.code&&r.backendPrimaryKey.direction===t.direction){i.push(r);break}}return n.logger.log("[flatMap] returning "+i),o.Observable.from(i)})},AMHAssignmentService.prototype.replacerFor=function(e){var t=function(t,n){return e.forEach(function(e){n&&n[e]&&n[e]instanceof Array&&(n[e]=n[e][0])}),n};return t},AMHAssignmentService.prototype.saveAssignment=function(e,t,n){var i=this,o=new s.Headers({"Content-Type":"application/json",userId:n.username,time:Date.now()}),a=new s.RequestOptions({headers:o}),r=JSON.stringify(t.toWriteModel(e,this.store.getCurrentEnv(),this.store.getCurrentVersion(),n.username,String(Date.now())),this.replacerFor(["modificationUserId","creationUserId"]));return this.logger.log(" save assignment sent: "+r),this.http.put(this.config.get("backUrl")+"/amhrouting/"+this.assignmentTypePath(e)+"/"+t.code,r,a).map(function(e){i.logger.log(" from save "+e.json()),e.json()})},AMHAssignmentService.prototype.createAssignment=function(e,t,n){var i=this,o=new s.Headers({"Content-Type":"application/json",userId:n.username,time:Date.now()}),a=new s.RequestOptions({headers:o}),r=JSON.stringify(t.toWriteModel(e,this.store.getCurrentEnv(),this.store.getCurrentVersion(),n.username,String(Date.now()),n.username,String(Date.now())),this.replacerFor(["modificationUserId","creationUserId"]));return this.logger.log(" create assignment sent: "+r),this.http.post(this.config.get("backUrl")+"/amhrouting/"+this.assignmentTypePath(e)+"/"+t.code,r,a).map(function(e){return i.logger.log(" from create "+e.json()),e.json()})},AMHAssignmentService.prototype.assignmentTypePath=function(e){switch(e){case a.AssignType.BK_CHANNEL:return"assignments";case a.AssignType.DTN_COPY:return"distributions";case a.AssignType.FEED_DTN_COPY:return"feedbacks"}},AMHAssignmentService.getFromSource=function(e){var t=e.hits.hits,n=t.map(function(e){return e._source});return n},AMHAssignmentService.prototype.updateDirtyStatus=function(e){this.persistence.setItem("amh_assignment_isDirty",e)},AMHAssignmentService.prototype.isAssignmentStatusDirty=function(){var e=this.persistence.getItem("amh_assignment_isDirty");return"true"===e},AMHAssignmentService.prototype.exportOverview=function(e,t){var n=new s.Headers({"Content-Type":"application/json",userId:t.username,time:Date.now()}),i=new s.RequestOptions({headers:n}),o=JSON.stringify({});return this.http.post(this.config.get("backUrl")+"/amhrouting/csv/export/assignments/"+e,o,i).map(function(e){return e.json()})},AMHAssignmentService.prototype.downloadFile=function(e,t){this.fileDownloader.download(this.config.get("backUrl")+e,t)},AMHAssignmentService=__decorate([i.Injectable(),__metadata("design:paramtypes",[s.Http,r.Config,r.Store,r.FileDownloader,r.Logger])],AMHAssignmentService)}();t.AMHAssignmentService=c},1178:function(e,t,n){"use strict";var s=n(257),i=n(30),o=n(14),a=n(880),r=n(38);n(904);var c=function(){function AMHRuleService(e,t,n,s,i){this.http=e,this.config=t,this.store=n,this.fileDownloader=s,this.logger=i,this.codeExpressionQuery='\n  "bool": {\n      "should": [\n        {\n          "match": {\n            "code": {\n              "query": "##TO_REPLACE##",\n              "analyzer": "standard",\n              "operator": "and"\n            }\n          }\n        },\n        {\n          "match": {\n            "expression": {\n              "query": "##TO_REPLACE##",\n              "analyzer": "standard",\n              "operator": "and"\n            }\n          }\n        }\n      ]\n    }\n  ',this.matchQuery=' \n  "query": {\n    ###CODE_EXPR_FILTER_TO_REPLACE###\n    ###ASSIGN_FILTER_TO_REPLACE###\n  }\n  ',this.ruleQuery='\n  "query": {\n    "bool": {\n      "should": [\n        {\n          "match": {\n            "assigned": {\n              "query": "##TO_REPLACE##",\n              "analyzer": "standard",\n              "operator": "and"\n            }\n          }\n        }\n      ]\n    }\n  }\n  ',this.ruleAssignTypeQuery='\n{ \n    "match": {\n    "assigned": {\n    "query": "##TO_REPLACE##",\n    "analyzer": "standard",\n    "operator": "and"\n    }\n  }\n}\n',this.querySize='\n  "from": 0,\n  "size": 1000,\n  "sort": [\n    {\n      "code": {\n        "order": "asc"\n      }\n    }\n  ]\n  ',this.persistence=sessionStorage}return AMHRuleService.prototype.nested=function(e,t){return' "nested": {\n     "path": "##path##",\n     ##query##\n   }\n   '.replace(/##path##/g,e).replace(/##query##/g,t)},AMHRuleService.prototype.query=function(e){return' "query" : {\n       ###content###\n    }\n    '.replace(/###content###/g,e)},AMHRuleService.prototype.match=function(e,t){return' "match": {\n       "##field##": {\n         "query": "##value##",\n         "analyzer": "standard",\n         "operator": "and"\n       }\n    }\n    '.replace(/##field##/g,e).replace(/##value##/g,t)},AMHRuleService.prototype.bool=function(e){return' "bool": { \n        ###content###\n      }'.replace(/###content###/g,e.join(" , "))},AMHRuleService.prototype.must=function(e){return this.filter("must",e)},AMHRuleService.prototype.should=function(e){return this.filter("should",e)},AMHRuleService.prototype.notMust=function(e){return this.filter("not_must",e)},AMHRuleService.prototype.filter=function(e,t){return' "##type##": [ \n        ###content###\n      ]'.replace(/##type##/g,e).replace(/###content###/g,t.map(function(e){return"{ "+e+" }"}).join(" , "))},AMHRuleService.prototype.assignedQuery=function(e){if(e==a.RuleAssignType.ALL)return this.querySize;var t=""+(e==a.RuleAssignType.ASSIGNED);return this.ruleQuery.replace(/##TO_REPLACE##/g,t)+" , "+this.querySize},AMHRuleService.prototype.getRuleAssignTypeQuery=function(e){if(e==a.RuleAssignType.ALL)return"";var t=""+(e==a.RuleAssignType.ASSIGNED);return" , "+this.ruleAssignTypeQuery.replace(/##TO_REPLACE##/g,t)},AMHRuleService.prototype.getMatchQuery=function(e,t){var n=e==a.RuleAssignType.ALL;if(n&&(!t||0==t.length))return this.querySize;if(!t||0==t.length&&!n)return this.assignedQuery(e)+" , "+this.querySize;var s=String(e==a.RuleAssignType.ASSIGNED),i=n?this.query(this.bool([this.should([this.match("code",t),this.match("expression",t)])])):this.query(this.bool([this.must([this.match("assigned",s),this.bool([this.should([this.match("code",t),this.match("expression",t)])])])]));return i+" , "+this.querySize},AMHRuleService.prototype.findRules=function(){return this.findRulesByAssignType(a.RuleAssignType.ALL)},AMHRuleService.prototype.findRulesByAssignType=function(e){var t=new s.Headers({"Content-Type":"application/json"}),n=new s.RequestOptions({headers:t}),i="{"+this.assignedQuery(e)+"}";return this.http.post(this.config.get("esBackUrl")+"/amhrouting/rules/_search",i,n).map(function(e){return e.json()}).flatMap(this.toHits).reduce(function(e,t){return e.push(t),e},new Array)},AMHRuleService.prototype.findRuleByCode=function(e){return this.http.get(this.config.get("esBackUrl")+"/amhrouting/rules/"+e).map(function(e){return e.json()}).map(function(e){return e.found?{found:!0,value:e._source}:{found:!1,value:{}}})},AMHRuleService.prototype.toHits=function(e){return o.Observable.from(e.hits.hits).map(function(e){return e._source})},AMHRuleService.prototype.findRuleMatches=function(e,t){var n="{"+this.getMatchQuery(e,t)+"}";return this.http.post(this.config.get("esBackUrl")+"/amhrouting/rules/_search?size=1000",n).map(function(e){return e.json()}).flatMap(this.toHits).reduce(function(e,t){return e.push(t),e},new Array)},AMHRuleService.prototype.toAssignment=function(e){return o.Observable.from(e.hits.hits).map(function(e){return{type:e._type,source:e._source}})},AMHRuleService.prototype.findAssignmmentsByRuleCode=function(e){var t="{"+this.query(this.bool([this.should([this.nested("rules",this.query(this.bool([this.must([this.match("rules.code",e)])])))])]))+"}";return this.http.post(this.config.get("esBackUrl")+"/amhrouting/assignments,distributionCopies,feedbackDtnCopies/_search?size=1000",t).map(function(e){return e.json()}).flatMap(this.toAssignment).reduce(function(e,t){return e.push({type:t.type,code:t.source.code,sequence:t.source.sequence}),e},new Array)},AMHRuleService.prototype.deleteRule=function(e,t){var n=this,i=new s.Headers({"Content-Type":"application/json",userId:t.username,time:Date.now()}),o=new s.RequestOptions({headers:i});return this.http.delete(this.config.get("backUrl")+"/amhrouting/rules/"+e,o).map(function(e){n.logger.log(" from rule deleted "+e.json()),e.json()})},AMHRuleService.prototype.exportRuleOverview=function(e,t){var n=new s.Headers({"Content-Type":"application/json",userId:t.username,time:Date.now()}),i=new s.RequestOptions({headers:n}),o=JSON.stringify({});return this.http.post(this.config.get("backUrl")+"/amhrouting/csv/export/rules/"+e,o,i).map(function(e){return e.json()})},AMHRuleService.prototype.downloadFile=function(e,t){this.fileDownloader.download(this.config.get("backUrl")+e,t)},AMHRuleService=__decorate([i.Injectable(),__metadata("design:paramtypes",[s.Http,r.Config,r.Store,r.FileDownloader,r.Logger])],AMHRuleService)}();t.AMHRuleService=c},1164:function(e,t,n){"use strict";function __export(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}__export(n(1148)),__export(n(1178))},907:function(e,t,n){"use strict";function createComponentFactoryOriginal(e,t){var n=function(){function DynamicComponent(){}return DynamicComponent}(),i=s.Component(t)(n);return e.resolveComponent(i)}function createComponentFactory(e,t,n){var i=s.Component(n)(e);return t.resolveComponent(i)}var s=n(30),i=n(38);t.createComponentFactoryOriginal=createComponentFactoryOriginal,t.createComponentFactory=createComponentFactory;var o=function(){function DynamicHTMLOutlet(e,t,n){this.vcRef=e,this.resolver=t,this.logger=n,this.componentCreation=new s.EventEmitter}return DynamicHTMLOutlet.prototype.ngOnChanges=function(){var e=this;this.comp&&this.meta&&(this.logger.log("passing to createComponent "),createComponentFactory(this.comp,this.resolver,this.meta).then(function(t){var n=s.ReflectiveInjector.fromResolvedProviders([],e.vcRef.parentInjector),i=e.vcRef.createComponent(t,0,n,[]);e.componentCreation.emit(i)}))},__decorate([s.Input(),__metadata("design:type",s.ComponentMetadata)],DynamicHTMLOutlet.prototype,"meta",void 0),__decorate([s.Input("childComponent"),__metadata("design:type",s.Type)],DynamicHTMLOutlet.prototype,"comp",void 0),__decorate([s.Output(),__metadata("design:type",s.EventEmitter)],DynamicHTMLOutlet.prototype,"componentCreation",void 0),DynamicHTMLOutlet=__decorate([s.Directive({selector:"dynamic-html-outlet"}),__metadata("design:paramtypes",[s.ViewContainerRef,s.ComponentResolver,i.Logger])],DynamicHTMLOutlet)}();t.DynamicHTMLOutlet=o},908:function(e,t,n){"use strict";function __export(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}__export(n(907))},909:function(e,t,n){"use strict";var s=n(30),i=n(873),o=n(38),a=function(){function Alert(e,t,n){this.dcl=e,this._elementRef=t,this.logger=n,this.okButton=!0,this.waitIcon=!0,this.okButtonText="Ok",this.okButtonResponse=2,this.cancelButton=!0,this.cancelButtonText="Cancel",this.cancelButtonResponse=0,this.yesButton=!1,this.yesButtonText="Yes",this.yesButtonResponse=1,this.alertMessage=!0,this.alertFooter=!0,this.alertHeader=!0,this.isOpen=!1,this.alertOutput=new s.EventEmitter}return Alert.prototype.open=function(){this.isOpen=!0},Alert.prototype.yes=function(){this.isOpen=!1,this.alertOutput.emit(this.yesButtonResponse)},Alert.prototype.ok=function(){this.isOpen=!1,this.alertOutput.emit(this.okButtonResponse)},Alert.prototype.cancel=function(){this.isOpen=!1,this.alertOutput.emit(this.cancelButtonResponse)},__decorate([s.Output(),__metadata("design:type",s.EventEmitter)],Alert.prototype,"alertOutput",void 0),Alert=__decorate([s.Component({selector:"alert",template:'\n  <div class="modal fade" [open]="!isOpen" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">\n    <div class="modal-dialog" role="document">\n      <div class="modal-content">\n        <div class="modal-header" [hidden]=!alertHeader>\n          <button type="button" class="close" data-dismiss="modal" (click)=\'cancel()\' aria-label="Close"><span aria-hidden="true">&times;</span></button>\n          <h4 class="modal-title text-center" id="myModalLabel">{{alertTitle}}</h4>\n        </div>\n        <div class="modal-body">\n          <div [hidden]=!alertMessage>\n            <i *ngIf="waitIcon" class="fa fa-spinner" aria-hidden="true" style="font-size:2.1em;"></i>\n            &nbsp;&nbsp;{{message}}\n          </div>\n        </div>\n        <div class="modal-footer" [hidden]=!alertFooter>\n          <span [hidden]=!yesButton >\n            <button class="btn btn-primary" (click)="yes()">{{yesButtonText}}</button>\n          </span>\n          <span [hidden]=!okButton >\n            <button class="btn btn-primary" (click)="ok()">{{okButtonText}}</button>\n          </span>\n          <span [hidden]=!cancelButton>\n            <button class="btn btn-primary" (click)="cancel()">{{cancelButtonText}}</button>\n          </span>\n        </div>\n      </div>\n    </div>\n  </div>\n  ',providers:[],directives:[i.Open],encapsulation:s.ViewEncapsulation.None,pipes:[]}),__metadata("design:paramtypes",[s.DynamicComponentLoader,s.ElementRef,o.Logger])],Alert)}();t.Alert=a},887:function(e,t,n){"use strict";function __export(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}__export(n(909)),__export(n(910)),__export(n(873))},910:function(e,t,n){"use strict";var s=n(30),i=n(873),o=n(908),a=n(38),r=function(){function Modal(e,t,n){this.dcl=e,this._elementRef=t,this.logger=n,this.doneSender=new s.EventEmitter,this.okButton=!0,this.okButtonText="Ok",this.cancelButton=!0,this.cancelButtonText="Cancel",this.modalMessage=!0,this.modalFooter=!0,this.modalHeader=!0,this.isOpen=!1,this.modalOutput=new s.EventEmitter}return Modal.prototype.saveComponent=function(e){var t=this;this.logger.debug("component recevied in Modal "+e),this.logger.debug(" parameters => "+this.parameters.get("messageId")),this.componentCreated=e,this.componentCreated._hostElement.component.doneSender=this.doneSender,this.componentCreated._hostElement.component.initialize(this.parameters),this.subscription=this.doneSender.subscribe(function(e){"done"==e?t.submit():t.close()})},Modal.prototype.childComponentListener=function(e){"done"==e?this.submit():this.close()},Modal.prototype.createMetadata=function(e){this.meta=new s.ComponentMetadata(e)},Modal.prototype.open=function(e){this.isOpen=!0,this.modalChildComponent=e},Modal.prototype.close=function(e){this.dispose(),e&&this.modalOutput.emit(e)},Modal.prototype.submit=function(){this.modalOutput.emit(this.componentCreated._hostElement.component),this.dispose()},Modal.prototype.dispose=function(){this.isOpen=!1,void 0!=this.componentCreated&&(this.logger.debug("...from modal : destroying child component"),this.componentCreated.destroy(),this.logger.debug("...from modal : unsubscribing child component"),this.subscription.unsubscribe())},__decorate([s.Output(),__metadata("design:type",s.EventEmitter)],Modal.prototype,"modalOutput",void 0),Modal=__decorate([s.Component({selector:"modal",template:'\n  <div class="modal fade" [open]="!isOpen" id="myModal" [attr.data-keyboard]="true" [attr.data-backdrop]="false" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">\n    <div class="modal-dialog" role="document" style="width:80%;">\n      <div class="modal-content">\n        <div class="modal-header" [hidden]=!modalHeader>\n          <button type="button" class="close" data-dismiss="modal" (click)=\'close()\' aria-label="Close"><span aria-hidden="true">&times;</span></button>\n          <h4 class="modal-title text-center" id="myModalLabel">{{modalTitle}}</h4>\n        </div>\n        <dynamic-html-outlet (componentCreation)="saveComponent($event)" [meta]="meta" [childComponent]="modalChildComponent"></dynamic-html-outlet>\n      </div>\n    </div>\n  </div>\n',providers:[],directives:[i.Open,o.DynamicHTMLOutlet],encapsulation:s.ViewEncapsulation.None,pipes:[]}),__metadata("design:paramtypes",[s.DynamicComponentLoader,s.ElementRef,a.Logger])],Modal)}();t.Modal=r},873:function(e,t,n){"use strict";var s=n(30),i=n(38),o=function(){function Open(e){this.logger=e,this.isExpanded=!0}return Object.defineProperty(Open.prototype,"open",{get:function(){return this.isExpanded},set:function(e){this.isExpanded=e,this.toggle()},enumerable:!0,configurable:!0}),Open.prototype.toggle=function(){this.isExpanded?this.hide():this.show()},Open.prototype.hide=function(){this.isExpanded=!1,this.display="none";var e=document.getElementsByClassName("modal-backdrop");e.length>0&&document.body.removeChild(e[0])},Open.prototype.show=function(){var e=document.createElement("div");e.className="modal-backdrop fade in",document.body.appendChild(e),this.isExpanded=!0,this.display="block"},__decorate([s.HostBinding("style.display"),__metadata("design:type",String)],Open.prototype,"display",void 0),__decorate([s.HostBinding("class.in"),s.HostBinding("attr.aria-expanded"),__metadata("design:type",Boolean)],Open.prototype,"isExpanded",void 0),__decorate([s.Input(),__metadata("design:type",Boolean),__metadata("design:paramtypes",[Boolean])],Open.prototype,"open",null),Open=__decorate([s.Directive({selector:"[open]"}),__metadata("design:paramtypes",[i.Logger])],Open)}();t.Open=o},926:function(e,t,n){"use strict";function __export(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}__export(n(1167))},1167:function(e,t){"use strict";var n=function(){function Option(e,t,n,s){void 0===s&&(s=!1),this.code=t,this.id=e,this.description=n,this.selected=s}return Object.defineProperty(Option.prototype,"htmlText",{get:function(){return this.description},enumerable:!0,configurable:!0}),Option.fromJson=function(e){var t=JSON.parse(e);return new Option(t.id,t.code,t.description)},Option.mapToProperty=function(e){return e.id},Option}();t.Option=n}});
//# sourceMappingURL=16.4a6ac86bf39fd380110b.bundle.map